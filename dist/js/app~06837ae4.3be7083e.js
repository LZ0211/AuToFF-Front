(window.webpackJsonp=window.webpackJsonp||[]).push([["app~06837ae4"],{"03a9":function(e,t,a){"use strict";a("ceb5")},"069f":function(e,t,a){},"06b4":function(e,t,a){"use strict";a("2387")},"12f4":function(e,t,a){"use strict";a("b0df")},"14aa":function(e,t,a){e.exports=a.p+"img/nav-8.c6b7175a.png"},1888:function(e,t,a){"use strict";a("5874")},"1ada":function(e,t,a){e.exports=a.p+"img/dir.60945fb0.svg"},"1c68":function(e,t,a){"use strict";a("235f")},"1ec0":function(e,t,a){},"1f08":function(e,t,a){},"221e":function(e,t,a){"use strict";a("5a10")},"235f":function(e,t,a){},2387:function(e,t,a){},"246f":function(e,t,a){},"248e":function(e,t,a){"use strict";a("beba")},2499:function(e,t,a){"use strict";a("1f08")},"24df":function(e,t,a){},"2be1":function(e,t,a){"use strict";a("b68d")},"2ec9":function(e,t,a){"use strict";a("f3a8")},"3fc1":function(e,t,a){"use strict";a("9db5")},"44a7":function(e,t,a){},"465a":function(e,t,a){},"4c57":function(e,t,a){"use strict";a("069f")},"4e04":function(e,t,a){},"547e":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t),a("6dca"),a("450d");t=a("2cf9"),t=a.n(t);var l=(a("10cb"),a("f3ad")),s=(l=a.n(l),a("3c52"),a("0d7b")),o=(s=a.n(s),a("fe07"),a("6ac5")),i=(o=a.n(o),a("b5d8"),a("f494")),r=(i=a.n(i),a("5e32"),a("6721")),n=(r=a.n(r),a("9d4c"),a("e450")),c=(n=a.n(n),a("eca7"),a("3787")),d=(c=a.n(c),a("425f"),a("4105")),m=(d=a.n(d),a("016f"),a("486c")),u=(m=a.n(m),a("6611"),a("e772")),p=(u=a.n(u),a("e960"),a("b35b")),h=(p=a.n(p),a("1f1a"),a("4e4b")),v=(h=a.n(h),a("1951"),a("eedf")),b=(v=a.n(v),a("2b0e")),f=(a("221e"),a("2877")),g=Object(f.a)({},(function(){return(0,this._self._c)("router-view")}),[],!1,null,null,null).exports,y=a("8c4f"),x=(a("14d9"),{name:"Index",data:()=>({list:[{chi:"全原子力场",eng:"all-atom force field",path:"/all-atom",color:"#E57506",isDev:!1},{chi:"联合原子力场",eng:"united-atom force field",path:"/united-atom",color:"#BFBFBF",isDev:!1},{chi:"离子液体",eng:"ionic liquid",path:"/ion-liquid",color:"#99C5C6",isDev:!1},{chi:"生物大分子",eng:"biomacromolecule",color:"#88573C",isDev:!0},{chi:"碳材料",eng:"carbon materials",color:"#97896E",path:"/carbon-material",isDev:!1},{chi:"金属/共轭有机框架",eng:"MOFs/COFs",color:"#201EEA",path:"/mof-cof",isDev:!1},{chi:"晶体材料",eng:"crystal",color:"#DB8B46",path:"/inorganic-crystals",isDev:!1},{chi:"聚合物建模",eng:"polymers",color:"#696BCC",isDev:!0},{chi:"多体势",eng:"multi-body potential",color:"#9AADBF",isDev:!0},{chi:"反应力场",eng:"reactive force field",color:"#6D98BA",isDev:!0},{chi:"粗粒化",eng:"coarse-graining",color:"#C17767",isDev:!0},{chi:"QM/MM建模",eng:"QM/MM modeling",color:"#210203",isDev:!0}]}),computed:{},components:{},created(){},mounted(){this.$store.commit("reset",{originFileName:"",originFileContent:"",activeIndex:1,fileList:[],originMol2:"",originMol:"",mol2:"",moleculeJson:"",atoms:null,force:"GAFF",backForce:"OPLS-AA/L",waterModel:"SPCE",waterModelForces:[],charge:0,chargeOptions:[],chargeType:null,chargeTypeOptions:[],chargeResult:[],switchValue:"fuzzy",atomtypeOriginData:[],atomtypeTableData:null,forceParams:null})},methods:{goToModule(e){e.path?this.$router.push(e.path):this.$message.warning("功能开发中")}}}),w=(x=(a("7ee9"),Object(f.a)(x,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page"},[e._m(0),t("div",{staticClass:"middle"},[t("div",{staticClass:"nav"},e._l(e.list,(function(l,s){return t("div",{key:s,staticClass:"nav-item",style:{opacity:l.isDev?".5":"1"},on:{click:function(t){return e.goToModule(l)}}},[t("div",{staticClass:"nav-item-img"},[t("img",{staticStyle:{width:"178px",height:"178px"},attrs:{src:a("d40d")(`./nav-${s+1}.png`),alt:"",srcset:""}})]),t("div",[t("div",{staticClass:"nav-item-chi",style:{color:l.color}},[e._v(" "+e._s(l.chi)+" ")]),t("div",{staticClass:"nav-item-eng"},[e._v(e._s(l.eng))])])])})),0)])])}),[function(){var e=this._self._c;return e("div",{staticClass:"top"},[e("div",{staticClass:"top-content"},[e("div",{staticClass:"top-text",staticStyle:{display:"flex",width:"100%","font-size":"30px","font-weight":"bold",color:"#222222"}},[this._v(" 分子力场辅助工具 ")]),e("div",{staticClass:"top-tip",staticStyle:{display:"flex",width:"100%",color:"#999999","font-size":"20px"}},[this._v(" Auxiliary Tools of Force Field ")])])])}],!1,null,"56fbee8a",null).exports),a("2f62")),C=a("19de"),S=a.n(C),k={toMol2:"/api/obabel/convert",convertFormat:"/api/obabel/convert",supportedForce:"/api/forcefield/supported",aaForce:"/api/forcefield/aa",uaForce:"/api/forcefield/ua",ilForce:"/api/forcefield/il",supportedWatermodels:"/api/forcefield/watermodels",atomType:"/api/forcefield/atomtype",atomParam:"/api/forcefield/param",am1bcc:"/api/charge/am1bcc",mmff94:"/api/charge/mmff94",cm1a:"/api/charge/cm1a",cm1a_2:"/api/charge/1.14xcm1a",resp:"/api/charge/resp",cm5:"/api/charge/cm5",cm5_2:"/api/charge/1.2xcm5",qeq:"/api/charge/qeq",oplsaa:"/api/charge/oplsaa",atom:"/api/forcefield/atom",lj:"/api/forcefield/lj",tip4pwatermodels:"/api/forcefield/tip4pwatermodels",gromacs:"/api/topfile/gromacs",lammps:"/api/topfile/lammps",amber:"/api/topfile/amber",moltemplate:"/api/topfile/moltemplate",openmm:"/api/topfile/openmm",tinker:"/api/topfile/tinker",charmm:"/api/topfile/charmm",tip4p:"/api/model/tip4p",reduct:"/api/model/reduct",fullerene:"/api/model/fullerene",graphene_square:"/api/model/graphene_square",armchair_nanocube_single_wall:"/api/model/armchair_nanocube_single_wall",armchair_nanocube_multi_walls:"/api/model/armchair_nanocube_multi_walls",zigzag_nanocube_single_wall:"/api/model/zigzag_nanocube_single_wall",zigzag_nanocube_multi_walls:"/api/model/zigzag_nanocube_multi_walls",carbon_atomtype:"/api/forcefield/carbon_atomtype",cif2mol2:"/api/cell/cif2mol2",mineralsDatabase:"/api/model/database/minerals",mofsDatabase:"/api/model/database/MOFs+COFs",mofForcefield:"/api/forcefield/mof",inorganicForcefield:"/api/forcefield/inorganic",monomer:"/api/polymer/monomer",endgroup:"/api/polymer/endgroup"},D=a("8592");let I=null;function _(){var e;return I||(e=(I=new b.default({data:{show:!1},methods:{loading(){this.show=!0},close(){this.show=!1}},render(e,t){return this.show?e("div",{style:{position:"fixed",left:0,top:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#eeeeee",opacity:".7"}},[e(D.a)]):""}})).$mount(),document.body.appendChild(e.$el)),I}D.a.show=function(){_().loading()},D.a.hide=function(){_().close()};var A=D.a,F=((C=a("cee4").a.create({baseURL:"https://api-autoff-dev.mp.iresearch.net.cn",headers:{"Content-Type":"application/json;charset=UTF-8"},timeout:6e4})).interceptors.request.use(e=>("offline"==window.sessionStorage.getItem("IsOnline")&&b.default.$message.error("网络已断开连接！"),e)),C.interceptors.response.use(e=>{if(200===e.status||201===e.status)return window.sessionStorage.setItem("IsOnline","online"),e.data&&e.data.error&&b.default.$message.error(e.data.error),e.data},e=>(401!==e.response.status&&418!==e.response.status&&(400===e.response.status?b.default.$message.error(e.response.data):e.response.status),Promise.reject(e))),C);function T(e,t,a={loading:!0,mock:!1,error:!0},l){return a.loading&&A.show(),new Promise((a,s)=>{let o={};switch(l){case"get":o={params:t},F({url:e,method:l,...o}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"post":o={data:t},F({url:e,method:l,...o}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"postFormData":o={data:t},F({url:e,method:"post",...o,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"postJson":o={data:t},F({url:e,method:"post",...o,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"getFile":o={data:t},F({url:e,method:"get",...o,responseType:"blob"}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"postFile":o={data:t},F({url:e,method:"post",...o,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"put":o={params:t},F({url:e,method:l,...o}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{A&&A.hide()});break;case"delete":o={params:t},F({url:e,method:l,...o}).then(e=>{a(e)}).catch(e=>{s(e)}).finally(()=>{loadingInstance&&loadingInstance.close()})}})}var M=function(e,t,a){return T(e,t,a,"get")},N=function(e,t,a){return T(e,t,{loading:!0,mock:!1,error:!0},"postJson")},R=function(e,t,a){return T(e,t,a,"postFile")};function O(e){return 0!==e.length}function L(e,t,a,l){this.label=e?e.trim():"C",this.x=t||0,this.y=a||0,this.z=l||0}a("907a"),a("986a"),a("1d02"),a("3c5d"),a("1b3b"),a("3d71"),a("c6e3"),a("2ef0");let $=/\s+/g,E=/\(|\)|\s+/g,P=/\'|\s+/g,z=/,|\'|\s+/g,B=/^\s+/,U=/[0-9]/g,j=/[0-9]|\+|\-/g,G={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]};function V(){var e=[];function t(e,t,a,l,s,o,i,r,n,c,d,m){this.symbol=e,this.name=t,this.atomicNumber=a,this.addH=l,this.jmolColor=this.pymolColor=s,this.covalentRadius=o,this.vdWRadius=i,this.valency=r,this.mass=n,this.atomicRadius=c,this.ionicRadius=d,this.vestaVdwRadius=m}return e.H=new t("H","Hydrogen",1,!1,"#D3D3D3",.31,1.1,1,1,.46,1.2,.2),e.He=new t("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4,1.22,1.4,1.22),e.Li=new t("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7,1.57,1.4,.59),e.Be=new t("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9,1.12,1.4,.27),e.B=new t("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11,.81,1.4,.11),e.C=new t("C","Carbon",6,!0,"#909090",.76,1.7,4,12,.77,1.7,.15),e.N=new t("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14,.74,1.55,1.46),e.O=new t("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16,.74,1.52,1.4),e.F=new t("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19,.72,1.47,1.33),e.Ne=new t("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20,1.6,1.54,1.6),e.Na=new t("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23,1.91,1.54,1.02),e.Mg=new t("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24,1.6,1.54,.72),e.Al=new t("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27,1.43,1.54,.39),e.Si=new t("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28,1.18,2.1,.26),e.P=new t("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31,1.1,1.8,.17),e.S=new t("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32,1.04,1.8,1.84),e.Cl=new t("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35,.99,1.75,1.81),e.Ar=new t("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40,1.92,1.88,1.92),e.K=new t("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39,2.35,1.88,1.51),e.Ca=new t("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40,1.97,1.88,1.12),e.Sc=new t("Sc","Scandium",21,!1,"#E6E6E6",1.7,2.01,0,45,1.64,1.88,.745),e.Ti=new t("Ti","Titanium",22,!1,"#BFC2C7",1.6,1.79,1,48,1.47,1.88,.605),e.V=new t("V","Vanadium",23,!1,"#A6A6AB",1.53,1.69,1,51,1.35,1.88,.58),e.Cr=new t("Cr","Chromium",24,!1,"#8A99C7",1.39,1.65,2,52,1.29,1.88,.615),e.Mn=new t("Mn","Manganese",25,!1,"#9C7AC7",1.39,1.64,3,55,1.37,1.88,.83),e.Fe=new t("Fe","Iron",26,!1,"#E06633",1.32,1.63,2,56,1.26,1.88,.78),e.Co=new t("Co","Cobalt",27,!1,"#F090A0",1.26,1.63,1,59,1.25,1.88,.745),e.Ni=new t("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58,1.25,1.88,.69),e.Cu=new t("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63,1.28,1.88,.73),e.Zn=new t("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64,1.37,1.88,.74),e.Ga=new t("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69,1.53,1.88,.62),e.Ge=new t("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74,1.22,1.88,.53),e.As=new t("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75,1.21,1.85,.335),e.Se=new t("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80,1.04,1.9,1.98),e.Br=new t("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79,1.14,1.85,1.96),e.Kr=new t("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84,1.98,2.02,1.98),e.Rb=new t("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85,2.5,2.02,1.61),e.Sr=new t("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88,2.15,2.02,1.26),e.Y=new t("Y","Yttrium",39,!1,"#94FFFF",1.9,2.2,0,89,1.82,2.02,1.019),e.Zr=new t("Zr","Zirconium",40,!1,"#94E0E0",1.75,2.05,0,90,1.6,2.02,.72),e.Nb=new t("Nb","Niobium",41,!1,"#73C2C9",1.64,2.1,1,93,1.47,2.02,.64),e.Mo=new t("Mo","Molybdenum",42,!1,"#54B5B5",1.54,2.08,2,98,1.4,2.02,.59),e.Tc=new t("Tc","Technetium",43,!1,"#3B9E9E",1.47,2,3,0,1.35,2.02,.56),e.Ru=new t("Ru","Ruthenium",44,!1,"#248F8F",1.46,2,2,102,1.34,2.02,.62),e.Rh=new t("Rh","Rhodium",45,!1,"#0A7D8C",1.42,2,1,103,1.34,2.02,.665),e.Pd=new t("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106,1.37,2.02,.86),e.Ag=new t("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107,1.44,2.02,1.15),e.Cd=new t("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114,1.52,2.02,.95),e.In=new t("In","Indium",49,!1,"#A67573",1.42,1.93,0,115,1.67,2.02,.8),e.Sn=new t("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120,1.58,2.02,.69),e.Sb=new t("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121,1.41,2,.76),e.Te=new t("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130,1.37,2.06,2.21),e.I=new t("I","Iodine",53,!0,"#940094",1.39,1.98,1,127,1.33,1.98,2.2),e.Xe=new t("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132,2.18,2.16,.48),e.Cs=new t("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133,2.72,2.16,1.74),e.Ba=new t("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138,2.24,2.16,1.42),e.La=new t("La","Lanthanum",57,!1,"#70D4FF",2.07,2,0,139,1.88,2.16,1.16),e.Ce=new t("Ce","Cerium",58,!1,"#FFFFC7",2.04,2,0,140,1.82,2.16,.97),e.Pr=new t("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,2,0,141,1.82,2.16,1.126),e.Nd=new t("Nd","Neodymium",60,!1,"#C7FFC7",2.01,2,0,142,1.82,2.16,1.109),e.Pm=new t("Pm","Promethium",61,!1,"#A3FFC7",1.99,2,0,0,1.81,2.16,1.093),e.Sm=new t("Sm","Samarium",62,!1,"#8FFFC7",1.98,2,0,152,1.81,2.16,1.27),e.Eu=new t("Eu","Europium",63,!1,"#61FFC7",1.98,2,0,153,2.06,2.16,1.066),e.Gd=new t("Gd","Gadolinium",64,!1,"#45FFC7",1.96,2,0,158,1.79,2.16,1.053),e.Tb=new t("Tb","Terbium",65,!1,"#30FFC7",1.94,2,0,159,1.77,2.16,1.04),e.Dy=new t("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,2,0,164,1.77,2.16,1.027),e.Ho=new t("Ho","Holmium",67,!1,"#00FF9C",1.92,2,0,165,1.76,2.16,1.015),e.Er=new t("Er","Erbium",68,!1,"#00E675",1.89,2,0,166,1.75,2.16,1.004),e.Tm=new t("Tm","Thulium",69,!1,"#00D452",1.9,2,0,169,1,2.16,.994),e.Yb=new t("Yb","Ytterbium",70,!1,"#00BF38",1.87,2,0,174,1.94,2.16,.985),e.Lu=new t("Lu","Lutetium",71,!1,"#00AB24",1.87,2,0,175,1.72,2.16,.977),e.Hf=new t("Hf","Hafnium",72,!1,"#4DC2FF",1.75,2,0,180,1.59,2.16,.71),e.Ta=new t("Ta","Tantalum",73,!1,"#4DA6FF",1.7,2,1,181,1.47,2.16,.64),e.W=new t("W","Tungsten",74,!1,"#2194D6",1.62,2,2,184,1.41,2.16,.6),e.Re=new t("Re","Rhenium",75,!1,"#267DAB",1.51,2,3,187,1.37,2.16,.53),e.Os=new t("Os","Osmium",76,!1,"#266696",1.44,2,2,192,1.35,2.16,.63),e.Ir=new t("Ir","Iridium",77,!1,"#175487",1.41,2,3,193,1.36,2.16,.625),e.Pt=new t("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195,1.39,2.16,.625),e.Au=new t("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197,1.44,2.16,1.37),e.Hg=new t("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202,1.55,2.16,1.02),e.Tl=new t("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205,1.71,2.16,.885),e.Pb=new t("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208,1.75,2.16,1.19),e.Bi=new t("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209,1.82,2.16,1.03),e.Po=new t("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0,1.77,2.16,.94),e.At=new t("At","Astatine",85,!0,"#754F45",1.5,2.02,1,0,.62,2.16,.62),e.Rn=new t("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0,.8,2.16,.8),e.Fr=new t("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0,1,2.16,1.8),e.Ra=new t("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0,2.35,2.16,1.48),e.Ac=new t("Ac","Actinium",89,!1,"#70ABFA",2.15,2,0,0,2.03,2.16,1.12),e.Th=new t("Th","Thorium",90,!1,"#00BAFF",2.06,2,0,232,1.8,2.16,1.05),e.Pa=new t("Pa","Protactinium",91,!1,"#00A1FF",2,2,0,231,1.63,2.16,.78),e.U=new t("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238,1.56,2.16,.73),e.Np=new t("Np","Neptunium",93,!1,"#0080FF",1.9,2,0,0,1.56,2.16,.75),e.Pu=new t("Pu","Plutonium",94,!1,"#006BFF",1.87,2,0,0,1.64,2.16,.86),e.Am=new t("Am","Americium",95,!1,"#545CF2",1.8,2,0,0,1.73,2.16,.975),e.Cm=new t("Cm","Curium",96,!1,"#785CE3",1.69,2,0,0,.8,1,.8),e.Bk=new t("Bk","Berkelium",97,!1,"#8A4FE3",0,2,0,0,0,0,0),e.Cf=new t("Cf","Californium",98,!1,"#A136D4",0,2,0,0,0,0,0),e.Es=new t("Es","Einsteinium",99,!1,"#B31FD4",0,2,0,0,0,0,0),e.Fm=new t("Fm","Fermium",100,!1,"#B31FBA",0,2,0,0,0,0,0),e.Md=new t("Md","Mendelevium",101,!1,"#B30DA6",0,2,0,0,0,0,0),e.No=new t("No","Nobelium",102,!1,"#BD0D87",0,2,0,0,0,0,0),e.Lr=new t("Lr","Lawrencium",103,!1,"#C70066",0,2,0,0,0,0,0),e.Rf=new t("Rf","Rutherfordium",104,!1,"#CC0059",0,2,0,0,0,0,0),e.Db=new t("Db","Dubnium",105,!1,"#D1004F",0,2,0,0,0,0,0),e.Sg=new t("Sg","Seaborgium",106,!1,"#D90045",0,2,0,0,0,0,0),e.Bh=new t("Bh","Bohrium",107,!1,"#E00038",0,2,0,0,0,0,0),e.Hs=new t("Hs","Hassium",108,!1,"#E6002E",0,2,0,0,0,0,0),e.Mt=new t("Mt","Meitnerium",109,!1,"#EB0026",0,2,0,0,0,0,0),e.Ds=new t("Ds","Darmstadtium",110,!1,"#000000",0,2,0,0,0,0,0),e.Rg=new t("Rg","Roentgenium",111,!1,"#000000",0,2,0,0,0,0,0),e.Cn=new t("Cn","Copernicium",112,!1,"#000000",0,2,0,0,0,0,0),e.Nh=new t("Nh","Nihonium",113,!1,"#000000",0,2,0,0,0,0,0),e.Fl=new t("Fl","Flerovium",114,!1,"#000000",0,2,0,0,0,0,0),e.Mc=new t("Mc","Moscovium",115,!1,"#000000",0,2,0,0,0,0,0),e.Lv=new t("Lv","Livermorium",116,!1,"#000000",0,2,0,0,0,0,0),e.Ts=new t("Ts","Tennessine",117,!1,"#000000",0,2,0,0,0,0,0),e.Og=new t("Og","Oganesson",118,!1,"#000000",0,2,0,0,0,0,0),e.LP=new t("LP","LP",119,!1,"#24DBFA",.155,.82,.5,.5,.23,.6,.1),e.H.pymolColor="#E6E6E6",e.C.pymolColor="#33FF33",e.N.pymolColor="#3333FF",e.O.pymolColor="#FF4D4D",e.F.pymolColor="#B3FFFF",e.S.pymolColor="#E6C640",e}let J=function(e,t){var a=e.x-t.x,l=e.y-t.y;e=e.z-t.z;return Math.sqrt(a*a+l*l+e*e)};function q(e,t,a){this.a1=e,this.a2=t,this.bondOrder=void 0!==a?a:1}function H(e,t,a,l,s,o){return l=(Math.cos(l)-Math.cos(o)*Math.cos(s))/Math.sin(o),[e,0,0,0,t*Math.cos(o),t*Math.sin(o),0,0,a*Math.cos(s),a*l,a*Math.sqrt(1-Math.pow(Math.cos(s),2)-l*l),0,0,0,0,1]}function K(e){let t=0,a=0,l=0,s=0;var o=e.indexOf("x"),i=e.indexOf("y"),r=e.indexOf("z");if(-1!==o&&(a++,0<o)&&"+"!==e.charAt(o-1)&&(a*=-1),-1!==i&&(l++,0<i)&&"+"!==e.charAt(i-1)&&(l*=-1),-1!==r&&(s++,0<r)&&"+"!==e.charAt(r-1)&&(s*=-1),2<e.length){let a="+";for(let l=0,s=e.length;l<s;l++){var n=e.charAt(l);"-"!==n&&"/"!==n||l!==e.length-1&&!e.charAt(l+1).match(U)||(a=n),n.match(U)&&("+"===a?t+=parseInt(n):"-"===a?t-=parseInt(n):"/"===a&&(t/=parseInt(n)))}}return[t,a,l,s]}function W(e){return 0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1&&0<=e.z&&e.z<=1}function Y(e,t,a){var l=t[0],s=t[1],o=t[2];return(a=a||t)[0]=e[0]*l+e[4]*s+e[8]*o+e[12],a[1]=e[1]*l+e[5]*s+e[9]*o+e[13],a[2]=e[2]*l+e[6]*s+e[10]*o+e[14],a}function Q(e,t){var a=V();let l=1,s=(t&&(l=t),0);for(let t=0,r=e.atoms.length;t<r;t++)for(let n=t+1;n<r;n++){var o=e.atoms[t],i=e.atoms[n];X(a[o.label])&&X(a[i.label])||J(o,i)<(a[o.label].covalentRadius+a[i.label].covalentRadius)*l*1.15&&e.bonds.push(new q(o,i,s++))}}function Z(e,t,a){this.lengths=e,this.angles=t,this.offset=a;var l=H(e[0],e[1],e[2],t[0],t[1],t[2]);a||(this.offset=[0,0,0]),this.unitCellVectors={o:Y(l,this.offset,[]),x:Y(l,[this.offset[0]+1,this.offset[1],this.offset[2]]),y:Y(l,[this.offset[0],this.offset[1]+1,this.offset[2]]),z:Y(l,[this.offset[0],this.offset[1],this.offset[2]+1]),xy:Y(l,[this.offset[0]+1,this.offset[1]+1,this.offset[2]]),xz:Y(l,[this.offset[0]+1,this.offset[1],this.offset[2]+1]),yz:Y(l,[this.offset[0],this.offset[1]+1,this.offset[2]+1]),xyz:Y(l,[this.offset[0]+1,this.offset[1]+1,this.offset[2]+1])};let s=[],o=[];function i(e,t,a,l){s.push(e[0],e[1],e[2]),s.push(t[0],t[1],t[2]),s.push(a[0],a[1],a[2]),s.push(l[0],l[1],l[2]);for(let e=0;e<4;e++)o.push(0,0,0)}i(this.unitCellVectors.o,this.unitCellVectors.x,this.unitCellVectors.xy,this.unitCellVectors.y),i(this.unitCellVectors.o,this.unitCellVectors.y,this.unitCellVectors.yz,this.unitCellVectors.z),i(this.unitCellVectors.o,this.unitCellVectors.z,this.unitCellVectors.xz,this.unitCellVectors.x),i(this.unitCellVectors.yz,this.unitCellVectors.y,this.unitCellVectors.xy,this.unitCellVectors.xyz),i(this.unitCellVectors.xyz,this.unitCellVectors.xz,this.unitCellVectors.z,this.unitCellVectors.yz),i(this.unitCellVectors.xy,this.unitCellVectors.x,this.unitCellVectors.xz,this.unitCellVectors.xyz);var r=[];for(let e=0;e<6;e++){var n=4*e;r.push(n,1+n,1+n,2+n,2+n,3+n,3+n,n)}return{unitCellParameters:this.unitCellVectors,lengths:e,angles:t,positionData:s,normalData:o,indexData:r}}function X(e){return[3,4,11,12,13,19,20,21,22,23,24,25,26,27,28,29,30,31,32,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51].includes(e.atomicNumber)||[55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84].includes(e.atomicNumber)||[87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116].includes(e.atomicNumber)}function ee(e,t,a,l){function s(){this.atoms=[],this.bonds=[],this.rings=[]}t=t||1,a=a||1,l=l||1;var o=new s;if(!e)return o;var i=e.split("\n");let r,n,c,d,m=0,u=0,p=0,h=0,v=0,b=0,f="P",g=!0;for(;0<i.length;)if(g?d=i.shift():g=!0,0<d.length)if(d.startsWith("_cell_length_a"))m=parseFloat(d.split(E)[1]);else if(d.startsWith("_cell_length_b"))u=parseFloat(d.split(E)[1]);else if(d.startsWith("_cell_length_c"))p=parseFloat(d.split(E)[1]);else if(d.startsWith("_cell_angle_alpha"))h=Math.PI*parseFloat(d.split(E)[1])/180;else if(d.startsWith("_cell_angle_beta"))v=Math.PI*parseFloat(d.split(E)[1])/180;else if(d.startsWith("_cell_angle_gamma"))b=Math.PI*parseFloat(d.split(E)[1])/180;else if(d.startsWith("_symmetry_space_group_name_H-M"))f=d.split(P)[1];else if(d.startsWith("loop_")){var y={fields:[],lines:[]};let e=!1;for(;void 0!==(d=i.shift())&&!(d=d.replace(B,"")).startsWith("loop_")&&0<d.length;)if(d.startsWith("_")){if(e)break;y.fields=y.fields.concat(d.split($).filter(O))}else e=!0,y.lines.push(d);0!==i.length&&(d.startsWith("loop_")||d.startsWith("_"))&&(g=!1),-1!==y.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==y.fields.indexOf("_space_group_symop_operation_xyz")?r=y:-1!==y.fields.indexOf("_atom_site_label")?n=y:-1!==y.fields.indexOf("_geom_bond_atom_site_label_1")&&(c=y)}var x=H(m,u,p,h,v,b);if(n){let e=-1,t=-1,a=-1,l=-1,s=-1;for(let o=0,i=n.fields.length;o<i;o++){var w=n.fields[o];"_atom_site_type_symbol"===w?e=o:"_atom_site_label"===w?t=o:"_atom_site_fract_x"===w?a=o:"_atom_site_fract_y"===w?l=o:"_atom_site_fract_z"===w&&(s=o)}for(let i=0,r=n.lines.length;i<r;i++){var C=(d=n.lines[i]).split($).filter(O),S=new L(C[-1===e?t:e].split(j)[0],parseFloat(C[a]),parseFloat(C[l]),parseFloat(C[s]));o.atoms.push(S),-1!==t&&(S.cifId=C[t],S.cifPart=0)}}if(o.elements=[...new Set(o.atoms.map(e=>e.label))],r&&!c){let e=0;for(let t=0,a=r.fields.length;t<a;t++){var k=r.fields[t];"_symmetry_equiv_pos_as_xyz"!==k&&"_space_group_symop_operation_xyz"!==k||(e=t)}var D=G[f],I=[];for(let t=0,a=r.lines.length;t<a;t++){var _=r.lines[t].split(z).filter(O),A=K(_[e]),F=K(_[e+1]),T=K(_[e+2]);for(let e=0,a=o.atoms.length;e<a;e++){var M=o.atoms[e],N=M.x*A[1]+M.y*A[2]+M.z*A[3]+A[0],R=M.x*F[1]+M.y*F[2]+M.z*F[3]+F[0],U=M.x*T[1]+M.y*T[2]+M.z*T[3]+T[0],ee=new L(M.label,N,R,U);if(I.push(ee),void 0!==M.cifId&&(ee.cifId=M.cifId,ee.cifPart=t+1),D)for(let e=0,a=D.length;e<a;e++){var te=D[e];te=new L(M.label,N+te[0],R+te[1],U+te[2]);I.push(te),void 0!==M.cifId&&(te.cifId=M.cifId,te.cifPart=t+1)}}}for(let e=0,t=I.length;e<t;e++){for(var ae=I[e];1<=ae.x;)ae.x--;for(;ae.x<0;)ae.x++;for(;1<=ae.y;)ae.y--;for(;ae.y<0;)ae.y++;for(;1<=ae.z;)ae.z--;for(;ae.z<0;)ae.z++}var le=[];for(let e=0,t=I.length;e<t;e++){let t=!1;var se=I[e];for(let e=0,a=o.atoms.length;e<a;e++)if(J(se,o.atoms[e])<1e-4){t=!0;break}if(!t){for(let e=0,a=le.length;e<a;e++)if(J(se,le[e])<1e-4){t=!0;break}t||le.push(se)}}o.atoms=o.atoms.concat(le)}var oe=[];for(let e=0;e<t;e++)for(let t=0;t<a;t++)for(let a=0;a<l;a++)if(0!==e||0!==t||0!==a)for(let l=0,s=o.atoms.length;l<s;l++){var ie=o.atoms[l],re=new L(ie.label,ie.x+e,ie.y+t,ie.z+a);oe.push(re),void 0!==ie.cifId&&(re.cifId=ie.cifId,re.cifPart=ie.cifPart+(r?r.lines.length:0)+e+10*t+100*a)}var ne=new s,ce=((e=(ne.atoms=JSON.parse(JSON.stringify(o.atoms.concat(oe))),new s)).atoms=[...o.atoms],new s),de=(ce.atoms=e.atoms.filter(e=>0<(e=e).x&&e.x<1&&0<e.y&&e.y<1&&0<e.z&&e.z<1),[...o.atoms]);let me=0;for(let e=-1;e<=1;e++)for(let t=-1;t<=1;t++)for(let a=-1;a<=1;a++)if(0!==a||0!==t||0!==e)for(let l=0,s=o.atoms.length;l<s;l++){var ue=o.atoms[l];let s=new L(ue.label,ue.x+a,ue.y+t,ue.z+e);-1===de.findIndex(e=>e.x===s.x&&e.y===s.y&&e.z===s.z)&&(void 0!==ue.cifId&&(s.cifId=ue.cifId+"_"+me++,s.cifPart=ue.cifPart+(r?r.lines.length:0)+a+10*t+100*e),de.push(s))}let pe=V();var he=de.filter(e=>W(e));let ve=0;var be=o.elements.map(e=>pe[e].covalentRadius);for(let e=0;e<be.length-1;e++){var fe=be[e],ge=be[e+1];ve<=fe+ge&&(ve=fe+ge)}const ye=[0-ve/m,1+ve/m],xe=[0-ve/u,1+ve/u],we=[0-ve/p,1+ve/p];var Ce=de.filter(e=>!W(e)).filter(e=>(e=e).x>=ye[0]&&e.x<=ye[1]&&e.y>=xe[0]&&e.y<=xe[1]&&e.z>=we[0]&&e.z<=we[1]);for(let e=0,t=he.length;e<t;e++){var Se=he[e],ke=Y(x,[Se.x,Se.y,Se.z]);Se.x=ke[0],Se.y=ke[1],Se.z=ke[2]}for(let e=0;e<Ce.length;e++){var De=Ce[e],Ie=Y(x,[De.x,De.y,De.z]);De.x=Ie[0],De.y=Ie[1],De.z=Ie[2]}for(let e=0;e<ne.atoms.length;e++){var _e=ne.atoms[e],Ae=Y(x,[_e.x,_e.y,_e.z]);_e.x=Ae[0],_e.y=Ae[1],_e.z=Ae[2]}var Fe=[...he];for(let e=0;e<he.length;e++)for(let t=0;t<Ce.length;t++){var Te=he[e];let a=Ce[t];J(Te,a)<1.15*+(pe[Te.label].covalentRadius+pe[a.label].covalentRadius)&&(X(pe[Te.label])&&X(pe[a.label])||-1===Fe.findIndex(e=>e.cifId===a.cifId)&&Fe.push(a))}if(o.atoms=Fe,c){let e=-1,t=-1;for(let a=0,l=c.fields.length;a<l;a++){var Me=c.fields[a];"_geom_bond_atom_site_label_1"===Me?e=a:"_geom_bond_atom_site_label_2"===Me&&(t=a)}for(let a=0,l=c.lines.length;a<l;a++){var Ne=c.lines[a].split($).filter(O),Re=Ne[e],Oe=Ne[t];for(let e=0,t=o.atoms.length;e<t;e++)for(let a=e+1;a<t;a++){var Le=o.atoms[e],$e=o.atoms[a];if(Le.cifPart!==$e.cifPart)break;(Le.cifId===Re&&$e.cifId===Oe||Le.cifId===Oe&&$e.cifId===Re)&&o.bonds.push(new q(Le,$e))}}}else Q(o,1);return Q(ne,1),{extraMolecule:ne,cellInnerMolecule:ce,cellMolecule:e,molecule:o,unitCell:new Z([m,u,p],[h,v,b],[0,0,0])}}var te=a("90fe"),ae=a("5a89"),le=a("afeb"),se=a("920c"),oe=a("9037"),ie=a("6c18"),re=a("32d9"),ne=a("93e9"),ce=a("360d"),de=a("4e15"),me=a("aea1");const ue=new ae.C,pe=new ae.L;let he,ve,be,fe=null,ge=null,ye=null,xe=null,we=null,Ce=null,Se=[],ke=null;C={name:"Demo1",props:{width:{type:Number,default:600},height:{type:Number,default:600},needExtra:{type:Boolean,default:!0},defaultLayer:{type:Number,default:0},tips:{type:String,default:""}},data(){return{cif:this.cifContent,pause:!1,publicPath:"/",atomsChecked:!0,bondsChecked:!0,linesChecked:!0,hasBond:!1,backColorsArray:[{color:"#ffffff"},{color:"#000000"}],moleculeBackColor:"#ffffff",viewType:"2",elementsArray:[],angle:10,maxSideLength:0,unitCell:null,root:null,bondsGroup:null,linesGroup:null,atomsGroup:null,insetGroup:null,atomLabelsGroup:null,idLabelsGroup:null,chargeLabelsGroup:null,offset:null,rotateActiveId:"-1",getImageData:!0,fileInputElement:null,headers:{authorization:"authorization-text"},fileList:[],atomsInfo:[],bondsInfo:[],extraAtoms:[],extraBonds:[]}},computed:{...Object(w.b)(["mol2","chargeResult"])},components:{},watch:{},mounted(){this.mol2&&this.init(this.mol2,!0)},beforeDestroy(){this.clearAll()},methods:{handleMouseMove(e){e.preventDefault()},handleScroll(){},initGUI(){var e={edgeStrength:4,edgeGlow:0,edgeThickness:1,pulsePeriod:0,rotate:!1,usePatternTexture:!1},t=new le.a({width:280});t.add(e,"edgeStrength",.01,10).onChange((function(e){be.edgeStrength=Number(e)})),t.add(e,"edgeGlow",0,1).onChange((function(e){be.edgeGlow=Number(e)})),t.add(e,"edgeThickness",1,4).onChange((function(e){be.edgeThickness=Number(e)})),t.add(e,"pulsePeriod",0,5).onChange((function(e){be.pulsePeriod=Number(e)})),t.add(e,"rotate"),t.add(e,"usePatternTexture").onChange((function(e){be.usePatternTexture=e})),e=new function(){this.visibleEdgeColor="#ffffff",this.hiddenEdgeColor="#190a05"},t.addColor(e,"visibleEdgeColor").onChange((function(e){be.visibleEdgeColor.set(e)})),t.addColor(e,"hiddenEdgeColor").onChange((function(e){be.hiddenEdgeColor.set(e)}))},init(e,t=!1){let a,l,s;ge=document.getElementById("drawer"),xe=new ae.D,s=(t?(t=this.parseMOL2File(e),a=t.atoms,l=t.bonds,t):(a=e.atoms,l=e.bonds,e)).cell,this.$store.commit("setIsCrystalMaterial",0<s.length),this.initRoot(a,l,s),this.switchLabel(this.defaultLayer),xe.add(this.root),this.addLight(),this.addCamera(),this.initRender(this.width,this.height),this.initOutline(),this.render()},getChargeOptionsByContent(e){e=this.parseMOL2File(e);const t=V();e=[...e.atoms];let a=0;return e.forEach(e=>{a+=t[e.label].atomicNumber}),a%2==0?[-2,0,2]:[-1,1]},judgeElements(e,t){let a=0;t.forEach(t=>{a+=e[t.label].atomicNumber});const l=["H","Li","Be","C","N","O","F","Na","Mg","Al","Si","P","S","Cl","K","Ca","Zn","Ga","Ge","As","Se","Br","Rb","Sr","Mo","Cd","In","Sn","Sb","Te","I","Cs","Ba","Hg","Tl","Pb","Bi"],s=["H","C","N","O","F","Si","P","S","Cl","Br","I"];let o=["resp","cm5","1.2xcm5","qeq","--"];if(t.map(e=>e.label).every(e=>s.includes(e))?o=["am1bcc","mmff94","cm1a","1.14xcm1a"].concat(o):t.map(e=>e.label).every(e=>l.includes(e))&&(o=["am1bcc"].concat(o)),250<t.length){let e=[],t=["cm5","1.2xcm5","cm1a","1.14xcm1a","resp"];o.forEach((a,l)=>{t.includes(a)||e.push(a)}),this.$store.commit("setChargeTypeOptions",e)}else this.$store.commit("setChargeTypeOptions",o);this.$store.commit("setChargeType","--")},initRoot(e,t,a){var l=V();let s=[...e],o=[...t];this.getInnerElements(s,l),this.judgeElements(l,s),this.root=new ae.m;var i=new ae.m;i.name="atoms",this.atomLabelsGroup=new ae.m,this.atomLabelsGroup.name="atomLabels",this.idLabelsGroup=new ae.m,this.idLabelsGroup.name="idLabels",this.chargeLabelsGroup=new ae.m,this.chargeLabelsGroup.name="chargeLabels";let r=8,n=8,c=8,d=8;d=300<s.length?(r=2,n=2,c=2):200<s.length?(r=4,n=4,c=4):100<s.length?(r=6,n=6,c=6):50<s.length?(r=8,n=8,c=8):(r=16,n=16,c=16);var m=s.length;this.needExtra&&(s=s.concat(this.extraAtoms),o=[...o,...this.extraBonds]);for(let e=0;e<s.length;e++){var u=s[e],p=l[u.label].jmolColor,h=(p=new ae.w({color:p,specular:1118481,shininess:1e3,wireframe:!1}),new ae.M),v=(h.x=u.x,h.y=u.y,h.z=u.z,.2*l[u.label].vdWRadius);v=new ae.G(v,r,n);(v=new ae.u(v,p)).name=u.id,v.position.copy(h),v.updateMatrix(),i.add(v),e<m&&(this.atomsInfo.push({id:v.uuid,label:u.label}),p=this.createLabelObject(h,u.label,1),this.atomLabelsGroup.add(p),v=(e+1).toString(),u=this.createLabelObject(h,v,2),this.idLabelsGroup.add(u),p=this.chargeResult&&void 0!==this.chargeResult[e]?Number(this.chargeResult[e].charge).toFixed(2).toString():"--",v=this.createLabelObject(h,p,3),this.chargeLabelsGroup.add(v))}this.offset=new ae.M,e=(new ae.c).setFromObject(i),t=new ae.M,e.getSize(t),this.maxSideLength=Math.max(t.x,t.y,t.z),e.getCenter(this.offset).multiplyScalar(-1),i.translateX(this.offset.x),i.translateY(this.offset.y),i.translateZ(this.offset.z),this.atomLabelsGroup.translateX(this.offset.x),this.atomLabelsGroup.translateY(this.offset.y),this.atomLabelsGroup.translateZ(this.offset.z),this.idLabelsGroup.translateX(this.offset.x),this.idLabelsGroup.translateY(this.offset.y),this.idLabelsGroup.translateZ(this.offset.z),this.chargeLabelsGroup.translateX(this.offset.x),this.chargeLabelsGroup.translateY(this.offset.y),this.chargeLabelsGroup.translateZ(this.offset.z),this.atomsGroup=i,this.root.add(i),this.root.add(this.atomLabelsGroup),this.root.add(this.idLabelsGroup),this.root.add(this.chargeLabelsGroup),this.addBonds(s,o,c,d,l),this.addCell(a)},addLight(){(we=new ae.i(16777215,.3)).position.set(0,0,10),xe.add(we);var e=new ae.b(16777215,.4);xe.add(e)},addCamera(){var e=this.width/this.height,t=+this.maxSideLength;(ye=new ae.z(-t*e,t*e,t,-t,0,1e4)).position.set(0,0,1e3),ye.lookAt(xe.position)},addBonds(e,t,a,l,s){var o=new ae.m,i=(o.name="bonds",new ae.M),r=new ae.M,n=new ae.M;for(let v=0;v<t.length;v+=1){var c=Number(t[v].s),d=Number(t[v].e),m=(c=e[c-1],d=e[d-1],i.x=Number(c.x),i.y=Number(c.y),i.z=Number(c.z),r.x=Number(d.x),r.y=Number(d.y),r.z=Number(d.z),i.distanceTo(r)),u=this.calcBondProportion(c,d,.11,s,m).sBond,p=new ae.h(.11,.11,u,a,l),h=(c=new ae.w({color:s[c.label].jmolColor,specular:1118481,shininess:0,wireframe:!1}),(p=new ae.u(p,c)).position.copy(i),p.position.lerp(r,u/m/2),n.subVectors(r,i).normalize(),p.quaternion.setFromUnitVectors(new ae.M(0,1,0),n),p.updateMatrix(),new ae.h(.11,.11,m-u,a,l));d=new ae.w({color:s[d.label].jmolColor,specular:1118481,shininess:0,wireframe:!1}),u=((h=new ae.u(h,d)).position.copy(i),h.position.lerp(r,(.5*(m-u)+u)/m),n.subVectors(r,i).normalize(),h.quaternion.setFromUnitVectors(new ae.M(0,1,0),n),h.updateMatrix(),p.geometry.clone().applyMatrix4(p.matrix)),m=h.geometry.clone().applyMatrix4(h.matrix),p=Object(oe.a)([u,m],!0),h=new ae.u(p,[c,d]);this.bondsInfo.push({id:h.uuid}),o.add(h)}o.translateX(this.offset.x),o.translateY(this.offset.y),o.translateZ(this.offset.z),this.bondsGroup=o,this.root.add(o)},addCell(e){if(e&&0<e.length){var t=new ae.m,a=(t.name="lines",new ae.q({color:2899028,linewidth:5,linecap:"round",linejoin:"round"})),{positionData:e,indexData:l,unitCellParameters:s}=Object(te.convertUnitcell)(e),o=(this.unitCell={...s},new Float32Array(e)),i=[];for(let e=0;e<l.length;e+=2){var r=[l[e],l[e+1]];i.push(r)}var n=[];for(let e=0;e<o.length;e+=3)n.push(new ae.M(o[e],o[e+1],o[e+2]));a.setValues({color:16777215});for(let e=0;e<i.length;e++){var c=(new ae.e).setFromPoints([n[i[e][0]],n[i[e][1]]]);c=new ae.p(c,a);t.add(c)}t.translateX(this.offset.x),t.translateY(this.offset.y),t.translateZ(this.offset.z),this.root.add(t)}},createLabelObject(e,t,a){var l=document.createElement("div");return(t=(l.className="label",l.style.color="rgb(255,255,255)",l.textContent=t,new me.a(l))).layers.set(a),t.position.copy(e),t},initRender(e,t){(fe=fe||new ae.O({antialias:!0})).setPixelRatio(window.devicePixelRatio),fe.setSize(e,t),fe.setClearColor(0,1),ge.appendChild(fe.domElement),fe.domElement.addEventListener("pointerdown",this.onPointerDown),(ke=new me.b).setSize(e,t),ke.domElement.style.position="absolute",ke.domElement.style.top="0px",ke.domElement.style.pointerEvents="none",ge.appendChild(ke.domElement),(Ce=new se.a(ye,fe.domElement)).minDistance=100,Ce.maxDistance=200,Ce.rotateSpeed=5,Ce.zoomSpeed=1,Ce.noPan=!0,Ce.addEventListener("change",this.changeControls,!1)},render(){this.pause||(requestAnimationFrame(this.render),fe.render(xe,ye),ke.render(xe,ye),Ce.update(),he.render(),8<=ye.zoom&&(ye.zoom=8),ye.zoom<=.125&&(ye.zoom=.125))},switchLabel(e){this.atomLabelsGroup.children.forEach(e=>e.layers.set(1)),this.idLabelsGroup.children.forEach(e=>e.layers.set(2)),this.chargeLabelsGroup.children.forEach(e=>e.layers.set(3)),1===e?this.atomLabelsGroup.children.forEach(e=>e.layers.set(0)):2===e?this.idLabelsGroup.children.forEach(e=>e.layers.set(0)):3===e&&this.chargeLabelsGroup.children.forEach(e=>e.layers.set(0))},getBoundingLength(e,t,a){e=e.map(e=>new ae.M(e.x,e.y,e.z));let l=-1/0;this.elementsArray.forEach(e=>{e=e.val,l=t[e].atomicRadius>l?t[e].atomicRadius:l});var s=new ae.F;return a=((e=(s.setFromPoints(e),new ae.F)).setFromPoints(a),Math.max(s.radius+l,e.radius))},changeControls(){we.position.copy(ye.position)},getInnerElements(e,t){return e=(e=Object(te.classify)(e,"label").kind).map(e=>({val:e,color:t[e].jmolColor})),this.elementsArray=e},onPointerDown(e){var t=fe.domElement.getBoundingClientRect();if(0<(e=(pe.x=2*(e.clientX-t.left)/t.width-1,pe.y=1-2*(e.clientY-t.top)/t.height,ue.setFromCamera(pe,ye),ue.intersectObjects(xe.children,!0))).length){const a=e.filter((function(e){return e&&e.object}))[0];"Mesh"===a.object.type&&this.atomsInfo.map(e=>e.id).includes(a.object.uuid)&&(t=Se.map(e=>e.id),Se=t.includes(a.object.id)?Se.filter(e=>e.id!==a.object.id):[a.object],be.selectedObjects=Se,this.$emit("updateSelectedAtom",Se))}},outlineObjects(e){he=new re.a(fe);var t=new ne.a(xe,ye);he.addPass(t),(be=new de.a(new ae.L(window.innerWidth,window.innerHeight),xe,ye)).selectedObjects=e,be.edgeStrength=5,be.edgeGlow=1,be.usePatternTexture=!1,be.edgeThickness=5,be.downSampleRatio=.1,be.pulsePeriod=5,be.visibleEdgeColor.set(16711680),be.hiddenEdgeColor.set(16777215),be.clear=!0,he.addPass(be)},initOutline(){he=new re.a(fe);var e=new ne.a(xe,ye);he.addPass(e),(be=new de.a(new ae.L(ge.innerWidth,ge.innerHeight),xe,ye)).visibleEdgeColor.set("#8ce605"),be.edgeStrength=6,be.edgeThickness=1.5,he.addPass(be),(ve=new ce.a(ie.a)).uniforms.resolution.value.set(1/ge.innerWidth,1/ge.innerHeight),he.addPass(ve)},clearSelectedObjects(){Se=[],be.selectedObjects=[]},calcBondProportion:(e,t,a,l,s)=>(e=.3*l[e.label].vdWRadius,e=Math.sqrt(e*e-a*a),l=.3*l[t.label].vdWRadius,{sBond:e+(l=(s-e-(t=Math.sqrt(l*l-a*a)))/2),eBond:l+t}),resetRoot(){this.fileList=[],this.elementsArray=[],this.root&&(this.root.removeFromParent(),this.disposeGroup(this.root))},clearAll(){this.pause=!0,this.root&&(this.root.removeFromParent(),this.disposeGroup(this.root));try{this.disposeGroup(this.atomsGroup),this.disposeGroup(this.bondsGroup),this.disposeGroup(this.linesGroup),this.light1=null,this.light=null,this.camera=null,this.controls=null,this.scene=null,this.container=null,this.renderer&&this.renderer.forceContextLoss(),this.renderer=null}catch(e){}},disposeGroup(e){e&&e.traverse((function(e){if(e instanceof ae.u)try{e.geometry.dispose(),e.material.dispose()}catch(e){}}))},parseAtomLine(e){let t=(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[5].split(".")[0];return"CL"===t&&(t="Cl"),{x:e[2],y:e[3],z:e[4],label:t,id:e[0],charge:e[8]}},parseBondLine:e=>({s:(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[1],e:e[2],type:e[3]}),parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i];r.push(this.parseAtomLine(n)),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d];m.push(this.parseBondLine(u)),d++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>CRYSTAL"););var p=[];if(0<a.length){var h=a.slice(0,3);let e=0;for(;e<3;){var v=h[e].split(t).map(e=>e.trim()).filter(e=>0!==e.length);p.push([Number(v[0]),Number(v[1]),Number(v[2])]),e++}}for(;0<a.length&&!a.shift().includes("@<TRIPOS>IMG-ATOM"););let b=[],f=[],g=[],y=[];for(;0<a.length;){var x=a.shift();if(x.includes("@<TRIPOS>IMG-BOND"))break;b.push(x)}for(;0<a.length;){var w=a.shift();if(w.includes("@<TRIPOS>CROSS-BOND"))break;g.push(w)}return b.forEach(e=>{f.push(this.parseAtomLine(e))}),g.forEach(e=>{y.push(this.parseBondLine(e))}),this.extraAtoms=[...f],this.extraBonds=[...y],this.$store.commit("setAtoms",r),{atoms:r,bonds:m,cell:p}},parseXYZFile(e){for(var t,a=/\s+/g,l=e.split("\n"),s=(Number(l[0].trim()),l.shift(),l.shift(),[]);0<l.length;)0<(t=l.shift()).length&&(t=t.split(a).map(e=>e.trim()).filter(e=>0!==e.length),s.push({label:t[0],x:Number(t[1]),y:Number(t[2]),z:Number(t[3])}));return s},downloadImage(){var e=(new Date).getTime(),t=(this.getImageData=!0,this.render(),document.createElement("a"));t.setAttribute("href",this.imgData),t.setAttribute("target","_blank"),t.setAttribute("download",e+".jpg"),t.click()}}},a("1c68"),C=Object(f.a)(C,(function(){var e=this,t=e._self._c;return t("div",{style:{width:e.width+"px",height:e.height+"px",position:"relative"}},[t("div",{style:{width:e.width+"px",height:e.height+"px",background:"#000000"},attrs:{id:"drawer"},on:{mousewheel:function(t){return t.preventDefault(),e.handleScroll.apply(null,arguments)}}}),e.tips?t("div",{staticStyle:{position:"absolute",left:"14px",top:"14px",color:"#ffffff"}},[e._v(" TIPS："+e._s(e.tips)+" ")]):e._e(),e._m(0),e.elementsArray&&0<e.elementsArray.length?t("div",{staticStyle:{position:"absolute",right:"5px",bottom:"5px","background-color":"#ffffff","border-radius":"3px",padding:"0 8px",height:"36px",display:"inline-flex","align-items":"center"}},[t("span",{staticStyle:{color:"#222222"}},[e._v(" 包含元素 ")]),e._l(e.elementsArray,(function(a,l){return t("span",{key:l,style:{"border-radius":"6px",opacity:1,background:a.color,"box-shadow":"0px 1px 3px 0px rgba(0, 0, 0, 0.1)",padding:"3px 10px",color:"#ffffff","margin-left":"9px"}},[e._v(" "+e._s(a.val)+" ")])}))],2):e._e()])}),[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"absolute",right:"0",top:"0",width:"167px",height:"80px","border-radius":"6px",background:"#333333",padding:"18px"}},[t("div",{staticStyle:{height:"12px","font-size":"12px","line-height":"12px",display:"flex","justify-content":"space-between",color:"#ffffff"}},[t("div",[e._v("放大/缩小")]),t("div",{staticStyle:{opacity:"0.5"}},[e._v("滑动滚轮")])]),t("div",{staticStyle:{height:"12px","font-size":"12px","line-height":"12px",display:"flex","justify-content":"space-between",color:"#ffffff","margin-top":"18px"}},[t("div",[e._v("沿中心轴旋转")]),t("div",{staticStyle:{opacity:"0.5"}},[e._v("拖动光标")])])])}],!1,null,null,null).exports;var De={props:{showUpload:{type:Boolean,default:!0},title:{type:String,default:""}},data:()=>({}),computed:{...Object(w.b)(["originFileName","originFileContent","activeIndex","originMol","originMol2","mol2","moleculeJson","force","backForce","backForces","waterModel","waterModelForces","charge","chargeOptions"])},methods:{parseAtomLine(e){let t=(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[5].split(".")[0];return"CL"===t&&(t="Cl"),{x:e[2],y:e[3],z:e[4],label:t,id:e[0],charge:e[8]}},parseBondLine:e=>({s:(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[1],e:e[2],type:e[3]}),parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i];r.push(this.parseAtomLine(n)),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d];m.push(this.parseBondLine(u)),d++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>CRYSTAL"););var p=[];if(0<a.length){var h=a.slice(0,3);let e=0;for(;e<3;){var v=h[e].split(t).map(e=>e.trim()).filter(e=>0!==e.length);p.push([Number(v[0]),Number(v[1]),Number(v[2])]),e++}}for(;0<a.length&&!a.shift().includes("@<TRIPOS>IMG-ATOM"););let b=[],f=[],g=[],y=[];for(;0<a.length;){var x=a.shift();if(x.includes("@<TRIPOS>IMG-BOND"))break;b.push(x)}for(;0<a.length;){var w=a.shift();if(w.includes("@<TRIPOS>CROSS-BOND"))break;g.push(w)}return b.forEach(e=>{f.push(this.parseAtomLine(e))}),g.forEach(e=>{y.push(this.parseBondLine(e))}),this.extraAtoms=[...f],this.extraBonds=[...y],this.$store.commit("setAtoms",r),{atoms:r,bonds:m,cell:p}},beforeUpload(e){var t=e.name.split(".");const a=t[t.length-1];if("mol"!==a&&"pdb"!==a&&"xyz"!==a&&"mol2"!==a&&"cif"!==a)this.$message.error("目前只支持.mol、.pdb、.xyz、.mol2、.cif文件上传");else if(1048576<e.size)this.$message.error("文件大小超出1M限制");else{let l=k.toMol2;(t=new FileReader).onload=t=>{var s,o=t.target.result,i=(this.$store.commit("setOriginFileContent",o),this.$store.commit("setOriginFileName",e.name),o.split("\n"));let r=0;if("mol"===a?(s=i[3],r=Number(s.slice(0,3).trim())):"pdb"===a?i.forEach(e=>{"HETATM"!==e.slice(0,6)&&"ATOM"!==e.slice(0,4)||r++}):"xyz"===a?(s=i[0].split(/\s+/g).map(e=>e.trim()),r=Number(s[0])):"mol2"===a?(i=this.parseMOL2File(o),r=i.atoms.length):"cif"===a&&(s=ee(o),r=s.molecule.atoms.length),1e3<r)return this.$message.error("原子个数不能超过1000个"),!1;"cif"===a?N(k.cif2mol2,{data:t.target.result}).then(t=>{this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.data),this.$store.commit("setOriginMol2",t.data),this.$emit("update",t.data)}).catch(e=>{}):"mol2"===a?(this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.target.result),this.$store.commit("setOriginMol2",t.target.result),this.$emit("update",t.target.result)):N(l,{data:t.target.result,inp:a,out:"mol2"}).then(t=>{this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.data),this.$store.commit("setOriginMol2",t.data),this.$emit("update",t.data)}).catch(e=>{})},t.readAsText(e)}},downloadOriginFile(){S()(this.originFileContent,this.originFileName)}}},Ie=(De=(a("8fb2"),Object(f.a)(De,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol-top"},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{attrs:{width:"24px",height:"24px",src:a("644b"),alt:""}}),t("div",{staticStyle:{height:"18px",opacity:"1","font-size":"18px","font-weight":"bold","line-height":"18px","letter-spacing":"0em","margin-left":"14px",color:"#222222"}},[e._v(" "+e._s(e.title)+" ")])]),e.showUpload?t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("div",{staticStyle:{"margin-right":"18px","font-size":"12px",color:"#999999"}},[e._v(".mol、.pdb、.xyz、.mol2、.cif文件上传文件大小1M以内且原子数小于1000 ")]),t("div",{staticStyle:{width:"101px",height:"36px","line-height":"36px",padding:"0px 6px 0px 6px","border-radius":"6px",opacity:"1",background:"#ffffff","box-sizing":"border-box",border:"1px solid #0a55ff",color:"#0a55ff"}},[t("a-upload",{attrs:{name:"file",accept:".mol,.pdb,.mol2,.xyz,.cif",multiple:!1,showUploadList:!1,beforeUpload:e.beforeUpload}},[t("div",{staticStyle:{height:"36px","line-height":"36px",display:"inline-flex","align-items":"center",padding:"0 5px",cursor:"pointer"}},[t("span",{staticStyle:{"margin-right":"2px",color:"#0A55FF"}},[e._v(" 本地上传 ")]),t("img",{attrs:{src:a("c730"),alt:"本地上传"}})])])],1),e.originFileName&&e.originFileContent?t("div",{staticStyle:{"font-size":"12px",margin:"0 10px"}},[e._v(" "+e._s(20<e.originFileName.length?e.originFileName.slice(0,20)+"...":e.originFileName)+" ")]):e._e(),e.originFileName&&e.originFileContent?t("a-button",{staticStyle:{height:"36px","margin-left":"10px"},attrs:{icon:"download"},on:{click:e.downloadOriginFile}},[e._v(" 源文件下载 ")]):e._e()],1):e._e()])}),[],!1,null,"1c943b05",null).exports),[function(){var e=this._self._c;return e("div",{staticClass:"page_mol_top_btns",staticStyle:{width:"40px",display:"inline-flex","align-items":"center","flex-flow":"column","justify-content":"center"}},[e("img",{attrs:{src:a("a104"),alt:""}}),e("img",{staticStyle:{"margin-top":"6px"},attrs:{src:a("6184"),alt:""}})])},function(){var e=this._self._c;return e("div",{staticStyle:{"border-radius":"6px",opacity:"1",background:"#ffffff","box-sizing":"border-box",border:"1px solid #aaaaaa"}},[e("div",{staticStyle:{height:"36px","line-height":"36px","text-align":"center",color:"#3d3d3d","font-size":"14px","font-weight":"bold"}},[this._v(" 已选项（可拖拽排序） ")]),e("ul",{staticStyle:{width:"280px",height:"232px","overflow-y":"auto","overflow-x":"hidden","list-style":"none",padding:"0",color:"#222222"},attrs:{id:"dropList"}})])}]),_e=a("aa47"),Ae={props:{url:{type:String,default:k.aaForce}},data:()=>({forces:[]}),mounted(){this.getForcesOptions().then(()=>{var e=document.getElementById("dragList"),t=document.getElementById("dropList");e&&t&&(_e.a.create(e,{group:{name:"dragList",put:"dropList",pull:function(e,t){return 2<t.el.children.length||"clone"}},animation:100}),_e.a.create(t,{group:{name:"dropList",put:e=>!0},animation:100}))})},methods:{getForcesOptions(){return new Promise((e,t)=>{M(this.url,{}).then(t=>{this.forces=t.data,e(t)}).catch(e=>{t(e)})})}}},Fe=(Ae=(a("601c"),Object(f.a)(Ae,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol-content-left-drag",staticStyle:{height:"270px","border-radius":"6px",opacity:"1",background:"#ffffff","box-sizing":"border-box"}},[t("div",{staticStyle:{display:"inline-flex","padding-top":"13px"}},[t("div",{staticStyle:{"border-radius":"6px",opacity:"1",background:"#ffffff","box-sizing":"border-box",border:"1px solid #f3f3f3"}},[t("div",{staticStyle:{height:"36px","line-height":"36px","text-align":"center",color:"#3d3d3d","font-size":"14px","font-weight":"bold"}},[e._v(" 待选项（拖拽至右边） ")]),t("ul",{staticStyle:{width:"280px",height:"232px","overflow-y":"auto","overflow-x":"hidden","list-style":"none",padding:"0",cursor:"grab"},attrs:{id:"dragList"}},e._l(e.forces,(function(a,l){return t("li",{key:l,staticStyle:{"margin-bottom":"5px","border-radius":"3px",opacity:"1","box-sizing":"border-box",border:"1px solid #efefef",height:"36px","line-height":"36px",padding:"0 24px"}},[e._v(" "+e._s(a)+" ")])})),0)]),e._m(0),e._m(1)])])}),Ie,!1,null,"005485da",null).exports),Ie={name:"ElBacktop",props:{mol2:{type:String,default:""}},data(){return{visible:!1,formLayout:"horizontal",form:this.$form.createForm(this,{name:"coordinated"})}},computed:{styleBottom(){return this.bottom+"px"},styleRight(){return this.right+"px"}},mounted(){},methods:{showModal(){this.visible=!0},handleSubmit(e){e.preventDefault(),this.form.validateFields((e,t)=>{})},handleSelectChange(e){},handleOk(){this.mol2&&this.form.validateFields((e,t)=>{if(!e){const{filename:e,format:a}=t;"mol2"===a?(S()(this.mol2,e+"."+a),this.visible=!1):N(k.convertFormat,{data:this.mol2,inp:"mol2",out:a}).then(t=>{S()(t.data,e+"."+a),this.$message.success("下载成功")}).catch(e=>{}).finally(()=>{this.visible=!1})}})}},beforeDestroy(){}},Ie=(a("cc99"),Object(f.a)(Ie,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("a-button",{on:{click:e.showModal}},[e._v("下载文件")]),t("a-modal",{attrs:{title:"选择格式和填写文件名以下载文件，文件名不用带后缀"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}},on:{submit:e.handleSubmit}},[t("a-form-item",{attrs:{label:"文件名"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["filename",{initialValue:"示例文件名",rules:[{required:!0,message:"请输入文件名!"}]}],expression:"[\n            'filename',\n            {\n              initialValue: '示例文件名',\n              rules: [{ required: true, message: '请输入文件名!' }],\n            },\n          ]"}]})],1),t("a-form-item",{attrs:{label:"文件格式"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["format",{initialValue:"mol2",rules:[{required:!0,message:"请选择文件格式!"}]}],expression:"[\n            'format',\n            {\n              initialValue: 'mol2',\n              rules: [{ required: true, message: '请选择文件格式!' }],\n            },\n          ]"}],attrs:{placeholder:"选择一种文件格式进行下载"},on:{change:e.handleSelectChange}},[t("a-select-option",{attrs:{value:"pdb"}},[e._v(" pdb ")]),t("a-select-option",{attrs:{value:"mol"}},[e._v(" mol ")]),t("a-select-option",{attrs:{value:"mol2"}},[e._v(" mol2 ")]),t("a-select-option",{attrs:{value:"xyz"}},[e._v(" xyz ")])],1)],1)],1)],1)],1)}),[],!1,null,"7b1d1661",null).exports),{name:"ElBacktop",props:{title:{type:String,default:""},btnText:{type:String,default:""},data:{type:Array,default:()=>[]}},data:()=>({visible:!1,lang:"中文",selectedId:"",selectedImg:""}),computed:{},mounted(){},methods:{showModal(){this.visible=!0,this.selectedId="",this.selectedImg=""},handleOk(){var e;this.selectedId&&(e=this.data.find((e,t)=>e.id===this.selectedId),e={value:"中文"===this.lang?e.zh:e.en,id:e.id},this.$emit("select-end",e),this.$message.success("已选择端基")),this.visible=!1},handleLangChange(e){this.selectedId="",this.selectedImg=""},handleEndChange(e){var t=this.data.find((t,a)=>t.id===e);this.selectedImg=t["2d-structure"]}},beforeDestroy(){}}),Te=(Fe=(a("d73c"),Object(f.a)(Fe,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("a-button",{on:{click:e.showModal}},[e._v(e._s(e.btnText))]),t("a-modal",{attrs:{closable:!1,title:e.title},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-row",{staticClass:"list-row",staticStyle:{"font-size":"14px","margin-bottom":"20px"}},[t("a-col",{attrs:{span:12}},[e._v(" 端基名 ")]),t("a-col",{attrs:{span:12}},[e._v(" 结构图 ")])],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:12}},[t("a-select",{staticStyle:{width:"120px"},on:{change:e.handleEndChange},model:{value:e.selectedId,callback:function(t){e.selectedId=t},expression:"selectedId"}},e._l(e.data,(function(a,l){return t("a-select-option",{key:a.id,attrs:{value:a.id,title:"中文"===e.lang?a.zh:a.en}},[e._v(" "+e._s("中文"===e.lang?a.zh:a.en)+" ")])})),1)],1),t("a-col",{attrs:{span:12}},[e.selectedImg?t("img",{attrs:{width:"120px",height:"120px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/monomer/"+e.selectedImg,alt:""}}):t("span",[e._v(" "+e._s("--")+" ")])])],1),t("template",{slot:"footer"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("div",[t("a-select",{staticStyle:{width:"90px"},on:{change:e.handleLangChange},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}},[t("a-select-option",{attrs:{value:"中文"}},[e._v(" 中文 ")]),t("a-select-option",{attrs:{value:"English"}},[e._v(" English ")])],1)],1),t("div",[t("a-button",{on:{click:function(t){e.visible=!1}}},[e._v(" 取消 ")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定 ")])],1)])])],2)],1)}),[],!1,null,"3aeb73ce",null).exports),{name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],forces:[],waterModels:[]}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","backForce","waterModel","waterModelForces","charge","chargeOptions","isCrystalMaterial"])},components:{MoleculeUltimate:C,StepCrystalTitle:De,MyDrag:Ae,FormatDownload:Ie},mounted(){this.init(),this.getWaterModelForcesOptions()},methods:{init(){var e=new ChemDoodle.SketcherCanvas("my-sketcher",600,390,{useServices:!1,oneMolecule:!0,isMobile:!1});e.toolbarManager.buttonCalculate.disable(),e.toolbarManager.buttonSearch.disable(),e.paidToHideTrademark=!0,e.hideHelp=!0,e.styles.atoms_displayTerminalCarbonLabels_2D=!1,e.styles.atoms_useJMOLColors=!0,e.styles.bonds_clearOverlaps_2D=!0,e.styles.bonds_overlapClearWidth_2D=2,e.styles.bonds_width_2D=1.5,e.styles.scale=1,e.styles.backgroundColor="rgba(255,255,255,0)",this.mySketcher=e,this.mySketcher.repaint(),this.originMol&&(e=ChemDoodle.readMOL(this.originMol),this.mySketcher.loadMolecule(e))},getMoleculeJson(){var e=this.mySketcher.getMolecule();e=(new ChemDoodle.io.JSONInterpreter).molTo(e);(new ChemDoodle.io.JSONInterpreter).molFrom(e)},getMolFile(){var e=this.mySketcher.getMolecule();ChemDoodle.writeMOL(e)},generate3D(){var e=this.mySketcher.getMolecule();e=ChemDoodle.writeMOL(e);this.$store.commit("setOriginMol",e);var t=e.split("\n")[3];if(1e3<Number(t.slice(0,3).trim()))return this.$message.error("原子个数不能超过1000个"),!1;N(k.toMol2,{data:e,inp:"mol",out:"mol2",other:"--gen3d"}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0),e=this.$refs.moleculeUltimate.getChargeOptionsByContent(e.data),this.$store.commit("setChargeOptions",e),this.$store.commit("setCharge",e[1])}).catch(e=>{})},setMolecule(){var e=ChemDoodle.readMOL("molFile Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n  9  9  0  0  0  0            999 V2000\n   -2.1651   -1.0000    0.0000 C   0  0  0  0  0  0\n   -1.2990   -0.5000    0.0000 C   0  0  0  0  0  0\n   -0.4330   -1.0000    0.0000 C   0  0  0  0  0  0\n    0.4330   -0.5000    0.0000 C   0  0  0  0  0  0\n    0.4330    0.5000    0.0000 C   0  0  0  0  0  0\n    1.2990    1.0000    0.0000 O   0  0  0  0  0  0\n    2.1651    0.5000    0.0000 N   0  0  0  0  0  0\n    2.1651   -0.5000    0.0000 N   0  0  0  0  0  0\n    1.2990   -1.0000    0.0000 N   0  0  0  0  0  0\n  1  2  1  0  0  0  0\n  2  3  1  0  0  0  0\n  3  4  1  0  0  0  0\n  4  5  1  0  0  0  0\n  5  6  1  0  0  0  0\n  6  7  1  0  0  0  0\n  7  8  1  0  0  0  0\n  8  9  1  0  0  0  0\n  9  4  1  0  0  0  0\nM  END");this.mySketcher.loadMolecule(e)},getWaterModelForcesOptions(){return new Promise((e,t)=>{M(k.supportedWatermodels,{}).then(t=>{this.$store.commit("setWaterModelForces",t.data),this.$store.commit("setWaterModel",t.data[0]),e(t)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},onBackForceChange(e){this.$store.commit("setBackForce",e)},onWaterModelChange(e){this.$store.commit("setWaterModel",e)},onChargeChange(e){this.$store.commit("setCharge",e)},parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i].split(t).map(e=>e.trim()).filter(e=>0!==e.length);r.push({x:n[2],y:n[3],z:n[4],label:"CL"===n[1]?"Cl":n[1],id:n[0]}),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d].split(t).map(e=>e.trim()).filter(e=>0!==e.length);m.push({s:u[1],e:u[2],type:u[3]}),d++}return this.$store.commit("setAtoms",r),{atoms:r,bonds:m}},goSecond(){var e=document.getElementById("dropList");0===(e=Array.from(e.children).map(e=>e.innerText)).length?this.$message.error("请至少选择一个力场"):(this.$store.commit("setForces",e),M(k.tip4pwatermodels,{}).then(e=>{(e.data||[]).includes(this.waterModel)?N(k.tip4p,{data:this.mol2}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{}):this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{}))},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")},updateUploadedMol2(e){this.$refs.moleculeUltimate.init(e,!0),e=this.$refs.moleculeUltimate.getChargeOptionsByContent(e),this.$store.commit("setChargeOptions",e),this.$store.commit("setCharge",e[1])},gofu1(){this.$router.go(-1)}}}),Me=(Te=(a("03a9"),Object(f.a)(Te,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol"},[t("step-crystal-title",{attrs:{title:"创建分子结构",showUpload:!0},on:{update:e.updateUploadedMol2}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[e._m(0),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.generate3D}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v("生成3d结构视图")]),t("img",{attrs:{src:a("6a60"),alt:""}})]),t("my-drag")],1),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:900,height:670,needExtra:!0,tips:"该工具不会进行相关结构的优化，如上传请上传优化后的结构"}})],1),e.mol2?t("div",{staticClass:"page_mol-content-right-btns"},[t("div",{staticClass:"page_mol_middle_btns"},[0<e.waterModelForces.length?t("div",[t("span",{staticStyle:{color:"#222222","font-size":"14px"}},[e._v("选择水模型力场：")]),t("el-select",{attrs:{size:"small",value:e.waterModel,placeholder:"请选择"},on:{change:e.onWaterModelChange}},e._l(e.waterModelForces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"20px"}},[t("span",{staticStyle:{color:"#222222","font-size":"14px"}},[e._v("选择CHARGE：")]),t("el-select",{attrs:{size:"small",value:e.charge,placeholder:"请选择"},on:{change:e.onChargeChange}},e._l(e.chargeOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()])])],1)}),[function(){var e=this._self._c;return e("div",{staticStyle:{display:"inline-block","text-align":"center"}},[e("canvas",{staticStyle:{width:"600px",height:"390px"},attrs:{id:"my-sketcher"}})])}],!1,null,"78f2ff46",null).exports),[]);for(let e=0;e<100;e++)Me.push({key:e.toString(),name:"Edrward "+e,age:32,address:"London Park no. "+e});var Ne={props:["columns","originData","selectedAtoms"],data(){return this.cacheData=this.originData.map(e=>({...e})),{data:this.originData,cacheData:this.originData,editingKey:""}},watch:{originData(e,t){e&&(this.data=e,this.cacheData=e.map(e=>({...e})))}},mounted(){this.cacheData=this.originData.map(e=>({...e})),this.data=this.originData.slice()},methods:{handleChange(e,t,a){var l=[...this.data],s=l.find(e=>t===e.key);s&&(s[a]=e,this.data=l)},edit(e){var t=[...this.data],a=t.find(t=>e===t.key);this.editingKey=e,a&&(a.editable=!0,this.data=t)},save(e){var t=[...this.data],a=[...this.cacheData],l=t.find(t=>e===t.key),s=a.find(t=>e===t.key);l&&s&&(delete l.editable,this.data=t,Object.assign(s,l),this.cacheData=a),this.editingKey=""},cancel(e){var t=[...this.data],a=t.find(t=>e===t.key);this.editingKey="",a&&(Object.assign(a,this.cacheData.find(t=>e===t.key)),delete a.editable,this.data=t)},getDataIndex(){var e=this.columns.map(e=>e.dataIndex);return e.pop(),e},rowClassName(e,t){return this.selectedAtoms.includes(e.atom1)||this.selectedAtoms.includes(e.atom2)?"highlight":""}}},Re=(Ne=(a("06b4"),Object(f.a)(Ne,(function(){var e=this,t=e._self._c;return t("a-table",{attrs:{columns:e.columns,"data-source":e.data,bordered:"",pagination:!1,rowClassName:e.rowClassName},scopedSlots:e._u([e._l(e.getDataIndex(),(function(a){return{key:a,fn:function(l,s,o){return[t("div",{key:a},[!s.editable||a.includes("id")||a.includes("atom")?[e._v(" "+e._s(l)+" ")]:t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:l},on:{change:t=>e.handleChange(t.target.value,s.key,a)}})],2)]}}})),{key:"operation",fn:function(a,l,s){return[t("div",{staticClass:"editable-row-operations"},[l.editable?t("span",[t("a",{on:{click:()=>e.save(l.key)}},[e._v("保存")]),t("a-popconfirm",{attrs:{title:"Sure to cancel?"},on:{confirm:()=>e.cancel(l.key)}},[t("a",[e._v("取消")])])],1):t("span",[t("a",{attrs:{disabled:""!==e.editingKey},on:{click:()=>e.edit(l.key)}},[e._v("编辑")])])])]}}],null,!0)})}),[],!1,null,"d70bc314",null).exports),{props:["data","columns","selectedAtoms"],data:()=>({}),methods:{rowClassName(e,t){return this.selectedAtoms.includes(e.id.toString())?"highlight":""}}}),Oe=(Re=(a("1888"),Object(f.a)(Re,(function(){var e=this,t=e._self._c;return t("a-table",{attrs:{bordered:"",pagination:!1,columns:e.columns,"data-source":e.data,rowClassName:e.rowClassName},scopedSlots:e._u([{key:"name",fn:function(a){return t("a",{},[e._v(e._s(a))])}},{key:"tags",fn:function(e){return t("span",{})}},{key:"action",fn:function(e,a){return t("span",{})}}])},[t("span",{attrs:{slot:"customTitle"},slot:"customTitle"},[t("a-icon",{attrs:{type:"smile-o"}}),e._v(" Name")],1)])}),[],!1,null,"b595a784",null).exports),{props:{showUpload:{type:Boolean,default:!0},title:{type:String,default:""}},data:()=>({}),computed:{...Object(w.b)(["originFileName","originFileContent","activeIndex","originMol","originMol2","mol2","moleculeJson","force","backForce","backForces","waterModel","waterModelForces","charge","chargeOptions"])},methods:{parseAtomLine(e){let t=(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[5].split(".")[0];return"CL"===t&&(t="Cl"),{x:e[2],y:e[3],z:e[4],label:t,id:e[0],charge:e[8]}},parseBondLine:e=>({s:(e=e.split(/\s+/g).map(e=>e.trim()).filter(e=>0!==e.length))[1],e:e[2],type:e[3]}),parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i];r.push(this.parseAtomLine(n)),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d];m.push(this.parseBondLine(u)),d++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>CRYSTAL"););var p=[];if(0<a.length){var h=a.slice(0,3);let e=0;for(;e<3;){var v=h[e].split(t).map(e=>e.trim()).filter(e=>0!==e.length);p.push([Number(v[0]),Number(v[1]),Number(v[2])]),e++}}for(;0<a.length&&!a.shift().includes("@<TRIPOS>IMG-ATOM"););let b=[],f=[],g=[],y=[];for(;0<a.length;){var x=a.shift();if(x.includes("@<TRIPOS>IMG-BOND"))break;b.push(x)}for(;0<a.length;){var w=a.shift();if(w.includes("@<TRIPOS>CROSS-BOND"))break;g.push(w)}return b.forEach(e=>{f.push(this.parseAtomLine(e))}),g.forEach(e=>{y.push(this.parseBondLine(e))}),this.extraAtoms=[...f],this.extraBonds=[...y],this.$store.commit("setAtoms",r),{atoms:r,bonds:m,cell:p}},beforeUpload(e){var t=e.name.split(".");const a=t[t.length-1];if("mol"!==a&&"pdb"!==a&&"xyz"!==a&&"mol2"!==a)this.$message.error("目前只支持.mol、.pdb、.xyz、.mol2文件上传");else if(1048576<e.size)this.$message.error("文件大小超出1M限制");else{let l=k.toMol2;(t=new FileReader).onload=t=>{var s,o=t.target.result,i=(this.$store.commit("setOriginFileContent",o),this.$store.commit("setOriginFileName",e.name),o.split("\n"));let r=0;if("mol"===a?(s=i[3],r=Number(s.slice(0,3).trim())):"pdb"===a?i.forEach(e=>{"HETATM"!==e.slice(0,6)&&"ATOM"!==e.slice(0,4)||r++}):"xyz"===a?(s=i[0].split(/\s+/g).map(e=>e.trim()),r=Number(s[0])):"mol2"===a?(i=this.parseMOL2File(o),r=i.atoms.length):"cif"===a&&(s=ee(o),r=s.molecule.atoms.length),1e3<r)return this.$message.error("原子个数不能超过1000个"),!1;"cif"===a?N(k.cif2mol2,{data:t.target.result}).then(t=>{this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.data),this.$store.commit("setOriginMol2",t.data),this.$emit("update",t.data)}).catch(e=>{}):"mol2"===a?(this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.target.result),this.$store.commit("setOriginMol2",t.target.result),this.$emit("update",t.target.result)):N(l,{data:t.target.result,inp:a,out:"mol2"}).then(t=>{this.$store.commit("setFileList",[e]),this.$store.commit("setMol2",t.data),this.$store.commit("setOriginMol2",t.data),this.$emit("update",t.data)}).catch(e=>{})},t.readAsText(e)}},downloadOriginFile(){fileDownload(this.originFileContent,this.originFileName)}}});a("ae59"),Oe=Object(f.a)(Oe,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol-top"},[t("div",{staticStyle:{display:"inline-flex","align-items":"center"}},[t("img",{attrs:{width:"24px",height:"24px",src:a("644b"),alt:""}}),t("div",{staticStyle:{height:"18px",opacity:"1","font-size":"18px","font-weight":"bold","line-height":"18px","letter-spacing":"0em","margin-left":"14px",color:"#222222"}},[e._v(" "+e._s(e.title)+" ")])]),e.showUpload?t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("div",{staticStyle:{"margin-right":"18px","font-size":"12px",color:"#999999"}},[e._v(".mol、.pdb、.xyz、.mol2文件上传文件大小1M以内且原子数小于1000")]),t("div",{staticStyle:{width:"101px",height:"36px","line-height":"36px",padding:"0px 6px 0px 6px","border-radius":"6px",opacity:"1",background:"#ffffff","box-sizing":"border-box",border:"1px solid #0a55ff",color:"#0a55ff"}},[t("a-upload",{staticStyle:{width:"101px"},attrs:{name:"file",accept:".mol,.pdb,.mol2,.xyz,.cif",multiple:!1,showUploadList:!1,beforeUpload:e.beforeUpload}},[t("div",{staticStyle:{height:"36px","line-height":"36px",display:"inline-flex","align-items":"center",padding:"0 5px",cursor:"pointer"}},[t("span",{staticStyle:{"margin-right":"2px",color:"#0A55FF"}},[e._v(" 本地上传 ")]),t("img",{attrs:{src:a("c730"),alt:"本地上传"}})])])],1),e.originFileName&&e.originFileContent?t("div",{staticStyle:{"font-size":"12px",margin:"0 10px"}},[e._v(" "+e._s(20<e.originFileName.length?e.originFileName.slice(0,20)+"...":e.originFileName)+" ")]):e._e(),e.originFileName&&e.originFileContent?t("a-button",{staticStyle:{height:"36px","margin-left":"20px"},attrs:{icon:"download"},on:{click:e.downloadOriginFile}},[e._v(" 源文件下载 ")]):e._e()],1):e._e()])}),[],!1,null,"f6b9ce26",null).exports;const Le=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],$e=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];var Ee={name:"Second",data:()=>({data:$e,columns:Le,editingKey:"",tableColumn:Le,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","forces","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e),this.allHasAtomType=e.every(e=>0<e.length&&e[0].name&&e[0].type),this.hasDU=e.some(e=>e.map(e=>e.name).includes("DU"))})},mounted(){},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){var e=0<this.forces.length?this.forces.join("+"):"";let t;return t=e?this.waterModel+"+"+e:""+this.waterModel,new Promise((e,a)=>{N(k.atomType,{data:this.mol2,forcefield:t}).then(t=>{e(t.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){if("accurate"===this.switchValue){let e=[];if(this.atomtypeTableData.forEach((t,a)=>{this.waterModelForces.includes(t.type)||e.push(t.type)}),1<(e=[...new Set(e)]).length)return void this.$message.error("精确模式下水力场外原子间请选择相同的力场")}this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},Pe=(Ee=(a("7e9d"),Object(f.a)(Ee,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div",[e._v(" 原子类型： "),t("a-radio-group",{attrs:{value:e.switchValue,"button-style":"solid"},on:{change:e.onSwitchChange}},[t("a-radio-button",{attrs:{value:"fuzzy"}},[e._v(" 模糊 ")]),t("a-radio-button",{attrs:{value:"accurate"}},[e._v(" 精确 ")])],1),t("span",{staticStyle:{"margin-left":"34px"}},[e._v("选择CHARGE类型：")]),t("el-select",{attrs:{size:"small",value:e.chargeType,placeholder:"请选择"},on:{change:e.onChargeTypeChange}},e._l(e.chargeTypeOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),e.allHasAtomType&&!e.hasDU?t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")]):e._e()],1)])])]),t("div",{staticStyle:{margin:"20px 0",display:"flex","align-items":"center"}}),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"babaf3cc",null).exports),[]);for(let e=0;e<100;e++)Pe.push({key:e.toString(),name:"Edrward "+e,age:32,address:"London Park no. "+e});var ze={props:["columns","originData","selectedAtoms"],data(){return this.cacheData=this.originData.map(e=>({...e})),{data:this.originData,cacheData:this.originData,editingKey:""}},watch:{originData(e,t){e&&(this.data=e,this.cacheData=e.map(e=>({...e})))}},mounted(){this.cacheData=this.originData.map(e=>({...e})),this.data=this.originData.slice()},methods:{handleChange(e,t,a){var l=[...this.data],s=l.find(e=>t===e.key);s&&(s[a]=e,this.data=l)},edit(e){var t=[...this.data],a=t.find(t=>e===t.key);this.editingKey=e,a&&(a.editable=!0,this.data=t)},save(e){var t=[...this.data],a=[...this.cacheData],l=t.find(t=>e===t.key),s=a.find(t=>e===t.key);l&&s&&(delete l.editable,this.data=t,Object.assign(s,l),this.cacheData=a),this.editingKey=""},cancel(e){var t=[...this.data],a=t.find(t=>e===t.key);this.editingKey="",a&&(Object.assign(a,this.cacheData.find(t=>e===t.key)),delete a.editable,this.data=t)},getDataIndex(){var e=this.columns.map(e=>e.dataIndex);return e.pop(),e},rowClassName(e,t){return this.selectedAtoms.includes(e.atom1)||this.selectedAtoms.includes(e.atom2)?"highlight":""}}};a("9df5"),ze=Object(f.a)(ze,(function(){var e=this,t=e._self._c;return t("a-table",{attrs:{columns:e.columns,"data-source":e.data,bordered:"",pagination:!1,rowClassName:e.rowClassName},scopedSlots:e._u([e._l(e.getDataIndex(),(function(a){return{key:a,fn:function(l,s,o){return[t("div",{key:a},[!s.editable||a.includes("id")||a.includes("atom")?[e._v(" "+e._s(l)+" ")]:t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{type:"number",value:l},on:{change:t=>e.handleChange(t.target.value,s.key,a)}})],2)]}}})),{key:"operation",fn:function(a,l,s){return[l.noEdit?e._e():t("div",{staticClass:"editable-row-operations"},[l.editable?t("span",[t("a",{on:{click:()=>e.save(l.key)}},[e._v("保存")]),t("a-popconfirm",{attrs:{title:"Sure to cancel?"},on:{confirm:()=>e.cancel(l.key)}},[t("a",[e._v("取消")])])],1):t("span",[t("a",{attrs:{disabled:""!==e.editingKey},on:{click:()=>e.edit(l.key)}},[e._v("编辑")])])])]}}],null,!0)})}),[],!1,null,"581b940c",null).exports;const Be=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],Ue=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],je={labelCol:{span:4},wrapperCol:{span:8}};var Ge={name:"Third",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:Ue,columns:Be,editingKey:"",isLoading:!1,data4:null,labelLayer:0,whichLable:"charge",chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:Be,typeData:Ue,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:je,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){var e=this.initChargeParams(),t=this.initParams();this.isLoading=!0,Promise.all([e,t]).then(([e,t])=>{let a;a=e?e.map((e,a)=>({key:a.toString(),id:(a+1).toString(),atom:this.atoms[a].label,mass:t.atoms[a][7],alpha:t.atoms[a][8],beta:t.atoms[a][9],charge:this.waterModelForces.includes(t.atoms[a][2])?t.atoms[a][6]:e,noEdit:this.waterModelForces.includes(t.atoms[a][2])})):t.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:e[6],noEdit:this.waterModelForces.includes(e[2])})),this.$store.commit("setChargeResult",a),t&&t.angles&&t.bonds&&t.dihedrals&&t.impropers&&t.pairs&&(this.data4=t,this.formatTableData(2,t.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,t.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,t.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,t.impropers,"impropersColumns","impropersDatas"),this.pairsData=t.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0,t.lattice)&&0<t.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{this.isLoading=!1})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(){return new Promise((e,t)=>{var a=this.atomtypeOriginData.map((e,t)=>{let a=[],l=this.atomtypeTableData[t];return a.push({name:l.atomtype,type:l.type}),"fuzzy"===this.switchValue&&e.forEach((e,t)=>{l.atomtype===e.name&&l.type===e.type||a.push(e)}),a});N(k.atomParam,{data:this.mol2,atomtype:a,backup:this.backForce,watermodel:this.waterModel}).then(t=>{this.$store.commit("setForceParams",t.data),e(t.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2),l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]),n=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);return new Promise((t,a)=>{R(k[this.computer],{...this.data4,atoms:n,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e}).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),function(e){var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];let a="";for(let e=0;e<6;e++){a+=t[Math.ceil(35*Math.random())]}}(),this.computer+`_${e}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)}).catch(()=>{this.$message.error("下载错误")}).finally(()=>{this.visible=!1})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleOk(){this.form.validateFields(e=>{e||(e=this.form.getFieldsValue().resname,this.downloadFile(e))})},handleCancel(){this.visible=!1},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)}}},Ve=(Ge=(a("12f4"),Object(f.a)(Ge,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"17px",color:"#222222"}},[e._v("选择计算软件:")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px",height:"36px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px",height:"36px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"分子名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resname",{initialValue:"NUK",rules:[{required:!0,message:"此项为必填项"},{pattern:/^[0-9a-zA-Z]*$/g,message:"只支持字母或数字组合"}]}],expression:"[\n            'resname',\n            {\n              initialValue: 'NUK',\n              rules: [\n                {\n                  required: true,\n                  message: '此项为必填项',\n                },\n                {\n                  pattern: /^[0-9a-zA-Z]*$/g,\n                  message: '只支持字母或数字组合',\n                },\n              ],\n            },\n          ]"}],attrs:{maxLength:4,placeholder:"请输入resname"},on:{change:e.handleInputChange}})],1)],1)],1)],1)}),[],!1,null,"91ee5a68",null).exports),{name:"ElBacktop",props:{right:{type:Number,default:40},bottom:{type:Number,default:40}},data:()=>({el:null,container:null,visible:!1}),computed:{styleBottom(){return this.bottom+"px"},styleRight(){return this.right+"px"}},mounted(){},methods:{init(){},handleClick(e){this.$router.push({path:"/"})}},beforeDestroy(){}});a("6893"),Ve=Object(f.a)(Ve,(function(){var e=this;return(0,e._self._c)("div",{staticClass:"self_backtop",style:{right:e.styleRight,bottom:e.styleBottom},on:{click:function(t){return t.stopPropagation(),e.handleClick.apply(null,arguments)}}},[e._t("default",(function(){return[e._v(" "+e._s("回到菜单")+" ")]}))],2)}),[],!1,null,"cadb5c0a",null).exports;const Je=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:Ee,Third:Ge,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return Je[this.activeIndex-1]}},methods:{}},a("3fc1"),Ee=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"f9fe6454",null).exports,Ge={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],forces:[],backForces:[],waterModels:[]}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","backForce","waterModel","waterModelForces","charge","chargeOptions","isCrystalMaterial"])},components:{MoleculeUltimate:C,StepCrystalTitle:De,MyDrag:Ae,FormatDownload:Ie},mounted(){this.init();var e=this.getForcesOptions(),t=this.getBackForcesOptions();Promise.all([e,t]).then(([])=>{this.$store.commit("setForce",this.forces[0]),this.$store.commit("setBackForce",this.backForces[0]);var e=document.getElementById("dragList"),t=document.getElementById("dropList");e&&t&&(_e.a.create(e,{group:{name:"dragList",put:"dropList",pull:function(e,t){return 2<t.el.children.length||"clone"}},animation:100}),_e.a.create(t,{group:{name:"dropList",put:function(e){return e.el.children.length<4}},animation:100}))}),this.getWaterModelForcesOptions()},methods:{originInit(){var e=new ChemDoodle.SketcherCanvas("my-sketcher",600,608,{useServices:!1,oneMolecule:!0,isMobile:!1});e.toolbarManager.buttonCalculate.disable(),e.toolbarManager.buttonSearch.disable(),e.paidToHideTrademark=!0,e.hideHelp=!0,e.styles.atoms_displayTerminalCarbonLabels_2D=!1,e.styles.atoms_useJMOLColors=!0,e.styles.bonds_clearOverlaps_2D=!0,e.styles.bonds_overlapClearWidth_2D=2,e.styles.bonds_width_2D=1.5,e.styles.scale=1,e.styles.backgroundColor="rgba(255,255,255,0)",e.repaint()},init(){var e=new ChemDoodle.SketcherCanvas("my-sketcher",600,608,{useServices:!1,oneMolecule:!0,isMobile:!1});e.toolbarManager.buttonCalculate.disable(),e.toolbarManager.buttonSearch.disable(),e.paidToHideTrademark=!0,e.hideHelp=!0,e.styles.atoms_displayTerminalCarbonLabels_2D=!1,e.styles.atoms_useJMOLColors=!0,e.styles.bonds_clearOverlaps_2D=!0,e.styles.bonds_overlapClearWidth_2D=2,e.styles.bonds_width_2D=1.5,e.styles.scale=1,e.styles.backgroundColor="rgba(255,255,255,0)",this.mySketcher=e,this.mySketcher.repaint(),this.originMol&&(e=ChemDoodle.readMOL(this.originMol),this.mySketcher.loadMolecule(e))},getMoleculeJson(){var e=this.mySketcher.getMolecule();e=(new ChemDoodle.io.JSONInterpreter).molTo(e);(new ChemDoodle.io.JSONInterpreter).molFrom(e)},getMolFile(){var e=this.mySketcher.getMolecule();ChemDoodle.writeMOL(e)},generate3D(){var e=this.mySketcher.getMolecule();e=ChemDoodle.writeMOL(e);this.$store.commit("setOriginMol",e);var t=e.split("\n")[3];if(1e3<Number(t.slice(0,3).trim()))return this.$message.error("原子个数不能超过1000个"),!1;N(k.toMol2,{data:e,inp:"mol",out:"mol2",other:"--gen3d"}).then(e=>{var{}=this.parseMOL2File(e.data);this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0)}).catch(e=>{})},update3D(e){this.$refs.moleculeUltimate.init(e,!0)},setMolecule(){var e=ChemDoodle.readMOL("molFile Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n  9  9  0  0  0  0            999 V2000\n   -2.1651   -1.0000    0.0000 C   0  0  0  0  0  0\n   -1.2990   -0.5000    0.0000 C   0  0  0  0  0  0\n   -0.4330   -1.0000    0.0000 C   0  0  0  0  0  0\n    0.4330   -0.5000    0.0000 C   0  0  0  0  0  0\n    0.4330    0.5000    0.0000 C   0  0  0  0  0  0\n    1.2990    1.0000    0.0000 O   0  0  0  0  0  0\n    2.1651    0.5000    0.0000 N   0  0  0  0  0  0\n    2.1651   -0.5000    0.0000 N   0  0  0  0  0  0\n    1.2990   -1.0000    0.0000 N   0  0  0  0  0  0\n  1  2  1  0  0  0  0\n  2  3  1  0  0  0  0\n  3  4  1  0  0  0  0\n  4  5  1  0  0  0  0\n  5  6  1  0  0  0  0\n  6  7  1  0  0  0  0\n  7  8  1  0  0  0  0\n  8  9  1  0  0  0  0\n  9  4  1  0  0  0  0\nM  END");this.mySketcher.loadMolecule(e)},getForcesOptions(){return new Promise((e,t)=>{M(k.uaForce,{}).then(t=>{this.forces=t.data,e(t)}).catch(e=>{t(e)})})},getBackForcesOptions(){return new Promise((e,t)=>{M(k.aaForce,{}).then(t=>{this.backForces=t.data,e(t)}).catch(e=>{t(e)})})},getWaterModelForcesOptions(){return new Promise((e,t)=>{M(k.supportedWatermodels,{}).then(t=>{this.$store.commit("setWaterModelForces",t.data),e(t)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},onBackForceChange(e){this.$store.commit("setBackForce",e)},onWaterModelChange(e){this.$store.commit("setWaterModel",e)},onChargeChange(e){this.$store.commit("setCharge",e)},parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i].split(t).map(e=>e.trim()).filter(e=>0!==e.length);r.push({x:n[2],y:n[3],z:n[4],label:"CL"===n[1]?"Cl":n[1],id:n[0]}),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d].split(t).map(e=>e.trim()).filter(e=>0!==e.length);m.push({s:u[1],e:u[2],type:u[3]}),d++}return this.$store.commit("setAtoms",r),{atoms:r,bonds:m}},goSecond(){M(k.tip4pwatermodels,{}).then(e=>{(e.data||[]).includes(this.waterModel)?N(k.tip4p,{data:this.mol2}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{}):this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{})},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")}}},a("fecf"),Te=Object(f.a)(Ge,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol"},[t("step-crystal-title",{attrs:{title:"创建分子结构",showUpload:!0},on:{update:e.update3D}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[e._m(0),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.generate3D}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v("生成3d结构视图")]),t("img",{attrs:{src:a("6a60"),alt:""}})])]),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{atoms:e.atoms,width:900,height:670,needExtra:!0,tips:"该工具不会进行相关结构的优化，如上传请上传优化后的结构"}})],1)])]),e.mol2?t("div",{staticClass:"page_mol-bottom"},[t("div",{staticClass:"page_mol_middle_btns"},[0<e.forces.length?t("div",[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择力场 ")]),t("el-select",{attrs:{size:"small",value:e.force,placeholder:"请选择"},on:{change:e.onForceChange}},e._l(e.forces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),0<e.backForces.length?t("div",{staticStyle:{"margin-left":"20px"}},[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择备选力场 ")]),t("el-select",{attrs:{size:"small",value:e.backForce,placeholder:"请选择"},on:{change:e.onBackForceChange}},e._l(e.backForces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff",color:"#ffffff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()],1)}),[function(){var e=this._self._c;return e("div",{staticStyle:{display:"inline-block","text-align":"center"}},[e("canvas",{staticStyle:{width:"600px",height:"608px"},attrs:{id:"my-sketcher"}})])}],!1,null,"3a525505",null).exports;const qe=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],He=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];Ge={name:"Second",data:()=>({data:He,columns:qe,editingKey:"",tableColumn:qe,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","originMol2","mol2","atoms","force","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e),this.allHasAtomType=e.every(e=>0<e.length&&e[0].name&&e[0].type),this.hasDU=e.some(e=>e.map(e=>e.name).includes("DU"))})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){let e;return e=""+this.force,new Promise((t,a)=>{N(k.atomType,{data:this.mol2,forcefield:e}).then(e=>{t(e.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},reductMol2(){return new Promise((e,t)=>{N(k.reduct,{data:this.mol2,rule:this.atomtypeTableData.map(e=>Number("Lp"!==e.atomtype))}).then(t=>{this.$store.commit("setMol2",t.data),e(t.data)}).catch(e=>{})})},goThird(){if("accurate"===this.switchValue){let e=[];if(this.atomtypeTableData.forEach((t,a)=>{this.waterModelForces.includes(t.type)||e.push(t.type)}),1<(e=[...new Set(e)]).length)return void this.$message.error("精确模式下水力场外原子间请选择相同的力场")}this.reductMol2().then(()=>{this.$store.commit("setActiveIndex",this.activeIndex+1)})},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("d432"),Ge=Object(f.a)(Ge,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div",[e._v(" 原子类型： "),t("a-radio-group",{attrs:{value:e.switchValue,"button-style":"solid"},on:{change:e.onSwitchChange}},[t("a-radio-button",{attrs:{value:"fuzzy"}},[e._v(" 模糊 ")]),t("a-radio-button",{attrs:{value:"accurate"}},[e._v(" 精确 ")])],1)],1),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),e.allHasAtomType&&!e.hasDU?t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")]):e._e()],1)])])]),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"46a45119",null).exports;const Ke=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],We=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],Ye={labelCol:{span:4},wrapperCol:{span:8}};var Qe={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:We,columns:Ke,editingKey:"",isLoading:!1,data4:null,labelLayer:0,whichLable:"charge",chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:Ke,typeData:We,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:Ye,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","originMol2","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){this.initBackForceAtomtypes().then(e=>{e=this.initParams(e),Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:e[0],mass:e[7],alpha:e[8],beta:e[9],charge:e[6],noEdit:this.waterModelForces.includes(e[2])}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0)}).finally(()=>{})})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(e){return new Promise((t,a)=>{var l=this.atomtypeOriginData.map((t,a)=>{let l=[],s=this.atomtypeTableData[a];return l.push({name:s.atomtype,type:s.type}),l="fuzzy"===this.switchValue&&(t.forEach((e,t)=>{s.atomtype===e.name&&s.type===e.type||l.push(e)}),e[a])?l.concat(e[a]):l});N(k.atomParam,{data:this.mol2,atomtype:l.filter(e=>e[0]&&"Lp"!==e[0].name),backup:this.backForce}).then(e=>{this.$store.commit("setForceParams",e.data),t(e.data)})})},initBackForceAtomtypes(){let e;return e=""+this.backForce,new Promise((t,a)=>{N(k.atomType,{data:this.mol2,forcefield:e}).then(e=>{t(e.data)}).catch(e=>{})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},chooseWhichLabel(e){this.whichLable=e.target.value,"none"===e.target.value?this.hideAllLabels():"charge"===e.target.value?(this.hideAllLabels(),this.$refs["molecule-third"].showLabels()):"atom"===e.target.value?(this.hideAllLabels(),this.$refs["molecule-third"].showAtomLabels()):"id"===e.target.value&&(this.hideAllLabels(),this.$refs["molecule-third"].showIdLabels())},hideAllLabels(){this.$refs["molecule-third"].hideLabels(),this.$refs["molecule-third"].hideAtomLabels(),this.$refs["molecule-third"].hideIdLabels()},goBack(){this.$store.commit("setMol2",this.originMol2),this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2),l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]),n=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);return new Promise((t,a)=>{R(k[this.computer],{...this.data4,atoms:n,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e}).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),this.computer+`_${e}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleOk(){this.form.validateFields(e=>{e||(e=this.form.getFieldsValue().resname,this.downloadFile(e))})},handleCancel(){this.visible=!1},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)}}};a("d9f5"),Qe=Object(f.a)(Qe,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v("请选择计算软件")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px","/* height":"36px","*/\n              border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"分子名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resname",{initialValue:"NUK",rules:[{required:!0,message:"此项为必填项"},{pattern:/^[0-9a-zA-Z]*$/g,message:"只支持字母或数字组合"}]}],expression:"[\n            'resname',\n            {\n              initialValue: 'NUK',\n              rules: [\n                {\n                  required: true,\n                  message: '此项为必填项',\n                },\n                {\n                  pattern: /^[0-9a-zA-Z]*$/g,\n                  message: '只支持字母或数字组合',\n                },\n              ],\n            },\n          ]"}],attrs:{maxLength:4,placeholder:"请输入resname"},on:{change:e.handleInputChange}})],1)],1)],1)],1)}),[],!1,null,"322bf6b3",null).exports;const Ze=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:Ge,Third:Qe,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return Ze[this.activeIndex-1]}},methods:{}},a("875b"),Ge=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"185fa1c2",null).exports,Qe={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],forces:[],waterModels:[]}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","backForce","backForces","waterModel","waterModelForces","charge","chargeOptions","isCrystalMaterial"])},components:{MoleculeUltimate:C,StepCrystalTitle:De,MyDrag:Ae,FormatDownload:Ie},mounted(){this.init();var e=this.getForcesOptions(),t=this.getBackupOptions();Promise.all([e,t]).then(([])=>{this.$store.commit("setForce",this.forces[0]);var e=document.getElementById("dragList"),t=document.getElementById("dropList");e&&t&&(_e.a.create(e,{group:{name:"dragList",put:"dropList",pull:function(e,t){return 2<t.el.children.length||"clone"}},animation:100}),_e.a.create(t,{group:{name:"dropList",put:function(e){return e.el.children.length<4}},animation:100}))}),this.getWaterModelForcesOptions()},methods:{originInit(){var e=new ChemDoodle.SketcherCanvas("my-sketcher",600,608,{useServices:!1,oneMolecule:!0,isMobile:!1});e.toolbarManager.buttonCalculate.disable(),e.toolbarManager.buttonSearch.disable(),e.paidToHideTrademark=!0,e.hideHelp=!0,e.styles.atoms_displayTerminalCarbonLabels_2D=!1,e.styles.atoms_useJMOLColors=!0,e.styles.bonds_clearOverlaps_2D=!0,e.styles.bonds_overlapClearWidth_2D=2,e.styles.bonds_width_2D=1.5,e.styles.scale=1,e.styles.backgroundColor="rgba(255,255,255,0)",e.repaint()},init(){var e=new ChemDoodle.SketcherCanvas("my-sketcher",600,608,{useServices:!1,oneMolecule:!0,isMobile:!1});e.toolbarManager.buttonCalculate.disable(),e.toolbarManager.buttonSearch.disable(),e.paidToHideTrademark=!0,e.hideHelp=!0,e.styles.atoms_displayTerminalCarbonLabels_2D=!1,e.styles.atoms_useJMOLColors=!0,e.styles.bonds_clearOverlaps_2D=!0,e.styles.bonds_overlapClearWidth_2D=2,e.styles.bonds_width_2D=1.5,e.styles.scale=1,e.styles.backgroundColor="rgba(255,255,255,0)",this.mySketcher=e,this.mySketcher.repaint(),this.originMol&&(e=ChemDoodle.readMOL(this.originMol),this.mySketcher.loadMolecule(e))},getMoleculeJson(){var e=this.mySketcher.getMolecule();e=(new ChemDoodle.io.JSONInterpreter).molTo(e);(new ChemDoodle.io.JSONInterpreter).molFrom(e)},getMolFile(){var e=this.mySketcher.getMolecule();ChemDoodle.writeMOL(e)},generate3D(){var e=this.mySketcher.getMolecule();e=ChemDoodle.writeMOL(e);this.$store.commit("setOriginMol",e);var t=e.split("\n")[3];if(1e3<Number(t.slice(0,3).trim()))return this.$message.error("原子个数不能超过1000个"),!1;N(k.toMol2,{data:e,inp:"mol",out:"mol2",other:"--gen3d"}).then(e=>{var{}=this.parseMOL2File(e.data);this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0),e=this.$refs.moleculeUltimate.getChargeOptionsByContent(e.data);this.$store.commit("setChargeOptions",e),this.$store.commit("setCharge",e[1])}).catch(e=>{})},updateUploadedMol2(e){this.$refs.moleculeUltimate.init(e,!0),e=this.$refs.moleculeUltimate.getChargeOptionsByContent(e),this.$store.commit("setChargeOptions",e),this.$store.commit("setCharge",e[1])},setMolecule(){var e=ChemDoodle.readMOL("molFile Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n  9  9  0  0  0  0            999 V2000\n   -2.1651   -1.0000    0.0000 C   0  0  0  0  0  0\n   -1.2990   -0.5000    0.0000 C   0  0  0  0  0  0\n   -0.4330   -1.0000    0.0000 C   0  0  0  0  0  0\n    0.4330   -0.5000    0.0000 C   0  0  0  0  0  0\n    0.4330    0.5000    0.0000 C   0  0  0  0  0  0\n    1.2990    1.0000    0.0000 O   0  0  0  0  0  0\n    2.1651    0.5000    0.0000 N   0  0  0  0  0  0\n    2.1651   -0.5000    0.0000 N   0  0  0  0  0  0\n    1.2990   -1.0000    0.0000 N   0  0  0  0  0  0\n  1  2  1  0  0  0  0\n  2  3  1  0  0  0  0\n  3  4  1  0  0  0  0\n  4  5  1  0  0  0  0\n  5  6  1  0  0  0  0\n  6  7  1  0  0  0  0\n  7  8  1  0  0  0  0\n  8  9  1  0  0  0  0\n  9  4  1  0  0  0  0\nM  END");this.mySketcher.loadMolecule(e)},getForcesOptions(){return new Promise((e,t)=>{M(k.ilForce,{}).then(t=>{this.forces=t.data,e(t)}).catch(e=>{t(e)})})},getBackupOptions(){return new Promise((e,t)=>{M(k.aaForce,{}).then(t=>{this.$store.commit("setBackForces",t.data),e(t)}).catch(e=>{t(e)})})},getWaterModelForcesOptions(){return new Promise((e,t)=>{M(k.supportedWatermodels,{}).then(t=>{this.$store.commit("setWaterModelForces",t.data),e(t)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},onBackForceChange(e){this.$store.commit("setBackForce",e)},onWaterModelChange(e){this.$store.commit("setWaterModel",e)},onChargeChange(e){this.$store.commit("setCharge",e)},parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i].split(t).map(e=>e.trim()).filter(e=>0!==e.length);r.push({x:n[2],y:n[3],z:n[4],label:"CL"===n[1]?"Cl":n[1],id:n[0]}),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d].split(t).map(e=>e.trim()).filter(e=>0!==e.length);m.push({s:u[1],e:u[2],type:u[3]}),d++}return this.$store.commit("setAtoms",r),{atoms:r,bonds:m}},goSecond(){M(k.tip4pwatermodels,{}).then(e=>{(e.data||[]).includes(this.waterModel)?N(k.tip4p,{data:this.mol2}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{}):this.$store.commit("setActiveIndex",this.activeIndex+1)}).catch(e=>{})},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")}}},a("d955"),Te=Object(f.a)(Qe,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol"},[t("step-crystal-title",{attrs:{title:"创建分子结构",showUpload:!0},on:{update:e.updateUploadedMol2}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[e._m(0),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.generate3D}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v("生成3d结构视图")]),t("img",{attrs:{src:a("6a60"),alt:""}})])]),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:900,height:670,needExtra:!0,tips:"该工具不会进行相关结构的优化，如上传请上传优化后的结构"}})],1)])]),e.mol2?t("div",{staticClass:"page_mol-bottom"},[t("div",{staticClass:"page_mol_middle_btns"},[e.forces&&0<e.forces.length?t("div",[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择力场 ")]),t("el-select",{attrs:{size:"small",value:e.force,placeholder:"请选择"},on:{change:e.onForceChange}},e._l(e.forces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),e.forces&&0<e.forces.length?t("div",{staticStyle:{"margin-left":"20px"}},[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择备选力场 ")]),t("el-select",{attrs:{size:"small",value:e.backForce,placeholder:"请选择"},on:{change:e.onBackForceChange}},e._l(e.backForces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),e.waterModelForces&&0<e.waterModelForces.length?t("div",{staticStyle:{"margin-left":"20px"}},[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择水模型力场 ")]),t("el-select",{attrs:{size:"small",value:e.waterModel,placeholder:"请选择"},on:{change:e.onWaterModelChange}},e._l(e.waterModelForces,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"20px"}},[t("span",{staticStyle:{color:"#222222"}},[e._v(" 选择CHARGE ")]),t("el-select",{attrs:{size:"small",value:e.charge,placeholder:"请选择"},on:{change:e.onChargeChange}},e._l(e.chargeOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff",color:"#ffffff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()],1)}),[function(){var e=this._self._c;return e("div",{staticStyle:{display:"inline-block","text-align":"center"}},[e("canvas",{staticStyle:{width:"600px",height:"608px"},attrs:{id:"my-sketcher"}})])}],!1,null,"054e6950",null).exports;const Xe=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],et=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];Qe={name:"Second",data:()=>({data:et,columns:Xe,editingKey:"",tableColumn:Xe,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e),this.allHasAtomType=e.every(e=>0<e.length&&e[0].name&&e[0].type),this.hasDU=e.some(e=>e.map(e=>e.name).includes("DU"))})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){let e;return e=""+this.force,new Promise((t,a)=>{N(k.atomType,{data:this.mol2,forcefield:e}).then(e=>{t(e.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){if("accurate"===this.switchValue){let e=[];if(this.atomtypeTableData.forEach((t,a)=>{this.waterModelForces.includes(t.type)||e.push(t.type)}),1<(e=[...new Set(e)]).length)return void this.$message.error("精确模式下水力场外原子间请选择相同的力场")}this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("69fe"),Qe=Object(f.a)(Qe,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div",[e._v(" 原子类型： "),t("a-radio-group",{attrs:{value:e.switchValue,"button-style":"solid"},on:{change:e.onSwitchChange}},[t("a-radio-button",{attrs:{value:"fuzzy"}},[e._v(" 模糊 ")]),t("a-radio-button",{attrs:{value:"accurate"}},[e._v(" 精确 ")])],1)],1),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),e.allHasAtomType&&!e.hasDU?t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步"),t("a-icon",{attrs:{type:"right"}})],1):e._e()],1)])])]),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"39d1bf47",null).exports;const tt=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],at=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],lt={labelCol:{span:4},wrapperCol:{span:8}};var st={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],data:at,columns:tt,editingKey:"",isLoading:!1,data4:null,labelLayer:0,whichLabel:"charge",chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:tt,typeData:at,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:lt,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],activeKeys:["1","2","3","4","5","6"],activeNavId:1,showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){this.initBackForceAtomtypes().then(e=>{e=this.initParams(e),Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:e[6],noEdit:this.waterModelForces&&this.waterModelForces.includes(e[2])}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0,e.lattice)&&0<e.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{})})},methods:{initBackForceAtomtypes(){let e;return e=""+this.backForce,new Promise((t,a)=>{N(k.atomType,{data:this.mol2,forcefield:e}).then(e=>{t(e.data)}).catch(e=>{})})},initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(e){return new Promise((t,a)=>{var l=this.atomtypeOriginData.map((t,a)=>{let l=[],s=this.atomtypeTableData[a];return l.push({name:s.atomtype,type:s.type}),l="fuzzy"===this.switchValue&&(t.forEach((e,t)=>{s.atomtype===e.name&&s.type===e.type||l.push(e)}),e[a])?l.concat(e[a]):l});N(k.atomParam,{data:this.mol2,atomtype:l.filter(e=>e[0]&&"Lp"!==e[0].name),backup:this.backForce,watermodel:this.waterModel}).then(e=>{this.$store.commit("setForceParams",e.data),t(e.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},chooseWhichLabel(e){this.whichLabel=e.target.value,"none"===e.target.value?this.hideAllLabels():"charge"===e.target.value?(this.hideAllLabels(),this.$refs["molecule-third"].showLabels()):"atom"===e.target.value?(this.hideAllLabels(),this.$refs["molecule-third"].showAtomLabels()):"id"===e.target.value&&(this.hideAllLabels(),this.$refs["molecule-third"].showIdLabels())},hideAllLabels(){this.$refs["molecule-third"].hideLabels(),this.$refs["molecule-third"].hideAtomLabels(),this.$refs["molecule-third"].hideIdLabels()},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2),l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]),n=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);return new Promise((t,a)=>{R(k[this.computer],{...this.data4,atoms:n,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e}).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),this.computer+`_${e}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleOk(){this.form.validateFields(e=>{e||(e=this.form.getFieldsValue().resname,this.downloadFile(e))})},handleCancel(){this.visible=!1},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)}}};a("f8fe"),st=Object(f.a)(st,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"20px"}},[e._v("请选择计算软件")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"分子名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["resname",{initialValue:"NUK",rules:[{required:!0,message:"此项为必填项"},{pattern:/^[0-9a-zA-Z]*$/g,message:"只支持字母或数字组合"}]}],expression:"[\n          'resname',\n          {\n            initialValue: 'NUK',\n            rules: [\n              {\n                required: true,\n                message: '此项为必填项',\n              },\n              {\n                pattern: /^[0-9a-zA-Z]*$/g,\n                message: '只支持字母或数字组合',\n              },\n            ],\n          },\n        ]"}],attrs:{maxLength:4,placeholder:"请输入resname"},on:{change:e.handleInputChange}})],1)],1)],1)],1)}),[],!1,null,"7cbe0a36",null).exports;const ot=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:Qe,Third:st,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return ot[this.activeIndex-1]}},methods:{gotoMenu(){this.$router.push("/")}}},a("4c57"),Qe=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"4db62858",null).exports,st={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],currForce:"",activeNav:2,dirOriginData:{20:{Ih:[]},24:{D6d:[]},26:{D3h:[]},28:{D2:[],Td:[]},30:{C1:[1,2,3]},32:{C2:[1,2],D2:[],D3:[],D3d:[],D3h:[]},34:{C2:[1,2,3],C3v:[],Cs:[1,2]},36:{C1:[1,2],C2v:[],C2:[1,2,3,4],Cs:[1,2],D2d:[1,2],D2:[1,2],D3h:[],D6h:[]},38:{C1:[1,2,3,4,5,6,7],C2v:[1,2],C2:[1,2,3,4,5],C3v:[],D3:[],D3h:[]},40:{C1:[1,2,3,4,5,6,7,8],C2v:[1,2],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14],C3:[],C3v:[],Cs:[1,2,3,4,5,6,7],D2h:[],D2:[1,2,3],D5d:[1,2],Td:[]},42:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11],Cs:[1,2,3,4,5,6],D3:[]},44:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],Cs:[1,2,3,4,5,6,7],D2:[1,2,3,4,5,6],D3d:[1,2,3],D3h:[1,2],D3:[1,2],S4:[],T:[]},46:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]},48:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],D2h:[1,2],D2:[1,2,3,4,5],D3:[],D6d:[1,2]},50:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195],C2v:[1,2,3,4,5,6],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],C3v:[],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],D3h:[],D3:[1,2],D5h:[1,2]},52:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78],C3v:[1,2],C3:[1,2,3],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],D2d:[1,2,3,4,5],D2h:[1,2],D2:[1,2,3,4,5,6,7,8,9],T:[]},60:{Ih:[]},70:{D5h:[]},72:{D6d:[]},74:{D3h:[]},76:{D2:[],Td:[]},180:{},240:{},260:{},320:{},500:{},540:{},720:{}},dirKeys:[],dirData:[],treeData:[{label:"一级 1",children:[{label:"二级 1-1",children:[{label:"三级 1-1-1"}]}]},{label:"一级 2",children:[{label:"二级 2-1",children:[{label:"三级 2-1-1"}]},{label:"二级 2-2",children:[{label:"三级 2-2-1"}]}]},{label:"一级 3",children:[{label:"二级 3-1",children:[{label:"三级 3-1-1"}]},{label:"二级 3-2",children:[{label:"三级 3-2-1"}]}]}],treeProps:{children:"children",label:"label"},currNodeKey:"",currNodeIds:[],cascaderValue:[],cascaderOptions:[{value:20,label:20,children:[{value:"Ih",label:"Ih"}]},{value:24,label:24,children:[{value:"D6d",label:"D6d"}]},{value:26,label:26,children:[{value:"D3h",label:"D3h"}]},{value:28,label:28,children:[{value:"D2",label:"D2"},{value:"Td",label:"Td"}]},{value:30,label:30,children:[{value:"C1",label:"C1",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3}]}]},{value:32,label:32,children:[{value:"C2",label:"C2",children:[{value:1,label:1},{value:2,label:2}]},{value:"D2",label:"D2"},{value:"D3",label:"D3"},{value:"D3d",label:"D3d"},{value:"D3h",label:"D3h"}]},{value:34,label:34,children:[{value:"C2",label:"C2",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3}]},{value:"C3v",label:"C3v"},{value:"Cs",label:"Cs",children:[{value:1,label:1},{value:2,label:2}]}]},{value:36,label:36,children:[{value:"C1",label:"C1",children:[{value:1,label:1},{value:2,label:2}]},{value:"C2v",label:"C2v"},{value:"C2",label:"C2",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4}]},{value:"Cs",label:"Cs",children:[{value:1,label:1},{value:2,label:2}]},{value:"D2d",label:"D2d",children:[{value:1,label:1},{value:2,label:2}]},{value:"D2",label:"D2",children:[{value:1,label:1},{value:2,label:2}]},{value:"D3h",label:"D3h"},{value:"D6h",label:"D6h"}]},{value:38,label:38,children:[{value:"C1",label:"C1",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7}]},{value:"C2v",label:"C2v",children:[{value:1,label:1},{value:2,label:2}]},{value:"C2",label:"C2",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5}]},{value:"C3v",label:"C3v"},{value:"D3",label:"D3"},{value:"D3h",label:"D3h"}]},{value:40,label:40,children:[{value:"C1",label:"C1",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7},{value:8,label:8}]},{value:"C2v",label:"C2v",children:[{value:1,label:1},{value:2,label:2}]},{value:"C2",label:"C2",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7},{value:8,label:8},{value:9,label:9},{value:10,label:10},{value:11,label:11},{value:12,label:12},{value:13,label:13},{value:14,label:14}]},{value:"C3",label:"C3"},{value:"C3v",label:"C3v"},{value:"Cs",label:"Cs",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3},{value:4,label:4},{value:5,label:5},{value:6,label:6},{value:7,label:7}]},{value:"D2h",label:"D2h"},{value:"D2",label:"D2",children:[{value:1,label:1},{value:2,label:2},{value:3,label:3}]},{value:"D5d",label:"D5d",children:[{value:1,label:1},{value:2,label:2}]},{value:"Td",label:"Td"}]},{value:42,label:42,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23}]},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6}]},{value:"D3",label:"D3",children:[]}]},{value:44,label:44,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42}]},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7}]},{value:"D2",label:"D2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6}]},{value:"D3d",label:"D3d",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3}]},{value:"D3h",label:"D3h",children:[{label:1,value:1},{label:2,value:2}]},{value:"D3",label:"D3",children:[{label:1,value:1},{label:2,value:2}]},{value:"S4",label:"S4"},{value:"T",label:"T"}]},{value:46,label:46,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52},{label:53,value:53},{label:54,value:54},{label:55,value:55},{label:56,value:56},{label:57,value:57},{label:58,value:58},{label:59,value:59},{label:60,value:60},{label:61,value:61},{label:62,value:62},{label:63,value:63},{label:64,value:64},{label:65,value:65},{label:66,value:66},{label:67,value:67},{label:68,value:68},{label:69,value:69}]},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22}]},{value:"C3",label:"C3",children:[{label:1,value:1},{label:2,value:2}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19}]}]},{value:48,label:48,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52},{label:53,value:53},{label:54,value:54},{label:55,value:55},{label:56,value:56},{label:57,value:57},{label:58,value:58},{label:59,value:59},{label:60,value:60},{label:61,value:61},{label:62,value:62},{label:63,value:63},{label:64,value:64},{label:65,value:65},{label:66,value:66},{label:67,value:67},{label:68,value:68},{label:69,value:69}]},{value:"C2h",label:"C2h"},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16}]},{value:"D2h",label:"D2h",children:[{label:1,value:1},{label:2,value:2}]},{value:"D2",label:"D2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5}]},{value:"D3",label:"D3"},{value:"D6d",label:"D6d",children:[{label:1,value:1},{label:2,value:2}]}]},{value:50,label:50,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52},{label:53,value:53},{label:54,value:54},{label:55,value:55},{label:56,value:56},{label:57,value:57},{label:58,value:58},{label:59,value:59},{label:60,value:60},{label:61,value:61},{label:62,value:62},{label:63,value:63},{label:64,value:64},{label:65,value:65},{label:66,value:66},{label:67,value:67},{label:68,value:68},{label:69,value:69}]},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37}]},{value:"C3v",label:"C3v"},{value:"C3",label:"C3",children:[{label:1,value:1},{label:2,value:2}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25}]},{value:"D3h",label:"D3h"},{value:"D3",label:"D3",children:[{label:1,value:1},{label:2,value:2}]},{value:"D5h",label:"D5h",children:[{label:1,value:1},{label:2,value:2}]}]},{value:52,label:52,children:[{value:"C1",label:"C1",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52},{label:53,value:53},{label:54,value:54},{label:55,value:55},{label:56,value:56},{label:57,value:57},{label:58,value:58},{label:59,value:59},{label:60,value:60},{label:61,value:61},{label:62,value:62},{label:63,value:63},{label:64,value:64},{label:65,value:65},{label:66,value:66},{label:67,value:67},{label:68,value:68},{label:69,value:69}]},{value:"C2h",label:"C2h"},{value:"C2v",label:"C2v",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3}]},{value:"C2",label:"C2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26},{label:27,value:27},{label:28,value:28},{label:29,value:29},{label:30,value:30},{label:31,value:31},{label:32,value:32},{label:33,value:33},{label:34,value:34},{label:35,value:35},{label:36,value:36},{label:37,value:37},{label:38,value:38},{label:39,value:39},{label:40,value:40},{label:41,value:41},{label:42,value:42},{label:43,value:43},{label:44,value:44},{label:45,value:45},{label:46,value:46},{label:47,value:47},{label:48,value:48},{label:49,value:49},{label:50,value:50},{label:51,value:51},{label:52,value:52},{label:53,value:53},{label:54,value:54},{label:55,value:55},{label:56,value:56},{label:57,value:57},{label:58,value:58},{label:59,value:59},{label:60,value:60},{label:61,value:61},{label:62,value:62},{label:63,value:63},{label:64,value:64},{label:65,value:65},{label:66,value:66},{label:67,value:67},{label:68,value:68},{label:69,value:69},{label:70,value:70},{label:71,value:71},{label:72,value:72},{label:73,value:73},{label:74,value:74},{label:75,value:75},{label:76,value:72},{label:77,value:77},{label:78,value:78}]},{value:"C3v",label:"C3v",children:[{label:1,value:1},{label:2,value:2}]},{value:"C3",label:"C3",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3}]},{value:"Cs",label:"Cs",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9},{label:10,value:10},{label:11,value:11},{label:12,value:12},{label:13,value:13},{label:14,value:14},{label:15,value:15},{label:16,value:16},{label:17,value:17},{label:18,value:18},{label:19,value:19},{label:20,value:20},{label:21,value:21},{label:22,value:22},{label:23,value:23},{label:24,value:24},{label:25,value:25},{label:26,value:26}]},{value:"D2d",label:"D2d",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5}]},{value:"D2h",label:"D2h",children:[{label:1,value:1},{label:2,value:2}]},{value:"D2",label:"D2",children:[{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:6,value:6},{label:7,value:7},{label:8,value:8},{label:9,value:9}]},{value:"T",label:"T"}]},{value:60,label:60,children:[{label:"Ih",value:"Ih"}]},{value:70,label:70,children:[{label:"D5h",value:"D5h"}]},{value:72,label:72,children:[{label:"D6d",value:"D6d"}]},{value:74,label:74,children:[{label:"D3h",value:"D3h"}]},{value:76,label:76,children:[{label:"D2",value:"D2"},{label:"Td",value:"Td"}]},{value:180,label:180},{value:240,label:240},{value:260,label:260},{value:320,label:320},{value:500,label:500},{value:540,label:540},{value:720,label:720}],form2:{x:1,y:1,Rcc:1.42,terminal_H:!1},form3:{type:"椅式",circle:6,period:2,Rcc:1.42,terminal_H:!1},form4:{type:"椅式",circle:6,period:2,Rcc:1.42,walls:1,terminal_H:!1}}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","forces","forceOptions","backForce","waterModel","waterModelForces","charge","chargeOptions"])},components:{MoleculeCarbon:C,StepTitle:Oe,MyDrag:Ae,FormatDownload:Ie},created(){this.dirKeys=[],this.dirData=Object.keys(this.dirOriginData)},mounted(){this.getForcesOptions()},methods:{handleNodeClick(e,t,a){if(t.isLeaf){let e=t;for(this.currNodeIds=[],this.currNodeIds.push(e.data.value);e.parent;)e=e.parent,this.currNodeIds.push(e.data.value);this.currNodeIds.reverse(),this.currNodeIds=this.currNodeIds.filter(e=>Boolean(e))}else this.currNodeIds=[]},getMoleculeJson(){var e=this.mySketcher.getMolecule();e=(new ChemDoodle.io.JSONInterpreter).molTo(e);(new ChemDoodle.io.JSONInterpreter).molFrom(e)},getMolFile(){var e=this.mySketcher.getMolecule();ChemDoodle.writeMOL(e)},getMol2(){let e={};switch(this.activeNav){case 1:if(0===this.currNodeIds.length)this.$message.error("未选择节点或选择的节点不是最深层次节点");else{let e="C";e=1===this.currNodeIds.length?"C"+this.currNodeIds[0]:2===this.currNodeIds.length?`C${this.currNodeIds[0]}-`+this.currNodeIds[1]:`C${this.currNodeIds[0]}-${this.currNodeIds[1]}_`+this.currNodeIds[2],M(k.fullerene+"/"+e).then((e={})=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))})}break;case 2:e={...this.form2},N(k.graphene_square,e).then(e=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))});break;case 3:e={...this.form3};var t="椅式"===this.form3.type?k.armchair_nanocube_single_wall:k.zigzag_nanocube_single_wall;N(t,{circle:this.form3.circle,period:this.form3.period,Rcc:this.form3.Rcc,terminal_H:this.form3.terminal_H}).then(e=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))});break;case 4:e={...this.form4},t="椅式"===this.form4.type?k.armchair_nanocube_multi_walls:k.zigzag_nanocube_multi_walls,N(t,{circle:this.form4.circle,period:this.form4.period,Rcc:this.form4.Rcc,walls:this.form4.walls,terminal_H:this.form4.terminal_H}).then(e=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))})}},clickItem(e){0===this.dirKeys.length?(this.dirData=Object.keys(this.dirOriginData[e]),this.dirKeys.push(e)):1===this.dirKeys.length&&(this.dirData=[...this.dirOriginData[this.dirKeys[0]][e]],this.dirKeys.push(e))},backLevel(){2===this.dirKeys.length?(this.dirKeys.pop(),this.dirData=Object.keys(this.dirOriginData[this.dirKeys[0]])):1===this.dirKeys.length&&(this.dirKeys.pop(),this.dirData=Object.keys(this.dirOriginData))},update3D(e){this.$refs.moleculeUltimate.init(e,!0)},setMolecule(){var e=ChemDoodle.readMOL("molFile Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n  9  9  0  0  0  0            999 V2000\n   -2.1651   -1.0000    0.0000 C   0  0  0  0  0  0\n   -1.2990   -0.5000    0.0000 C   0  0  0  0  0  0\n   -0.4330   -1.0000    0.0000 C   0  0  0  0  0  0\n    0.4330   -0.5000    0.0000 C   0  0  0  0  0  0\n    0.4330    0.5000    0.0000 C   0  0  0  0  0  0\n    1.2990    1.0000    0.0000 O   0  0  0  0  0  0\n    2.1651    0.5000    0.0000 N   0  0  0  0  0  0\n    2.1651   -0.5000    0.0000 N   0  0  0  0  0  0\n    1.2990   -1.0000    0.0000 N   0  0  0  0  0  0\n  1  2  1  0  0  0  0\n  2  3  1  0  0  0  0\n  3  4  1  0  0  0  0\n  4  5  1  0  0  0  0\n  5  6  1  0  0  0  0\n  6  7  1  0  0  0  0\n  7  8  1  0  0  0  0\n  8  9  1  0  0  0  0\n  9  4  1  0  0  0  0\nM  END");this.mySketcher.loadMolecule(e)},getForcesOptions(){return new Promise((e,t)=>{M(k.aaForce,{}).then(t=>{this.$store.commit("setForceOptions",t.data),this.$store.commit("setForce",t.data[0]),e(t.data)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i].split(t).map(e=>e.trim()).filter(e=>0!==e.length);r.push({x:n[2],y:n[3],z:n[4],label:"CL"===n[1]?"Cl":n[1],id:n[0]}),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d].split(t).map(e=>e.trim()).filter(e=>0!==e.length);m.push({s:u[1],e:u[2],type:u[3]}),d++}return this.$store.commit("setAtoms",r),{atoms:r,bonds:m}},goSecond(){this.$store.commit("setActiveIndex",this.activeIndex+1)},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")}}},a("248e"),Te=Object(f.a)(st,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol"},[t("step-title",{attrs:{title:"创建分子结构",showUpload:!0},on:{update:e.update3D}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[t("div",{staticClass:"page_mol-content-left-top"},[t("div",{staticClass:"page_mol-content-left-top-nav",style:{"border-right":"1px solid #d8d8d8",color:1===e.activeNav?"#0A55FF":"#3D3D3D"},on:{click:function(t){e.activeNav=1}}},[e._v(" 富勒烯 ")]),t("div",{staticClass:"page_mol-content-left-top-nav",style:{"border-right":"1px solid #d8d8d8",color:2===e.activeNav?"#0A55FF":"#3D3D3D"},on:{click:function(t){e.activeNav=2}}},[e._v(" 石墨烯 ")]),t("div",{staticClass:"page_mol-content-left-top-nav",style:{"border-right":"1px solid #d8d8d8",color:3===e.activeNav?"#0A55FF":"#3D3D3D"},on:{click:function(t){e.activeNav=3}}},[e._v(" 单壁碳纳米管 ")]),t("div",{staticClass:"page_mol-content-left-top-nav",style:{color:4===e.activeNav?"#0A55FF":"#3D3D3D"},on:{click:function(t){e.activeNav=4}}},[e._v(" 多壁碳纳米管 ")])]),t("div",{staticClass:"page_mol-content-left-content"},[t("div",{staticClass:"page_mol-content-left-content-container"},[1===e.activeNav?t("div",{staticStyle:{height:"520px",width:"100%","overflow-x":"hidden","overflow-y":"auto"}},[t("div",{staticStyle:{padding:"10px","font-size":"15px","font-weight":"bold","padding-top":"0"}},[e._v(" 原子数目/分子点群/序号 ")]),t("div",{staticStyle:{padding:"10px","font-size":"13px","padding-top":"0"}},[e._v(" 从下方目录中选取材料，请选取最深层次节点，当前选取节点为："+e._s(0<e.currNodeIds.length?""+e.currNodeIds.join("/"):"--")+" ")]),t("el-tree",{ref:"treeDom",staticClass:"tree",attrs:{"highlight-current":!0,data:e.cascaderOptions,props:e.treeProps,"default-expand-all":!1,"node-key":"id"},on:{"node-click":e.handleNodeClick}})],1):e._e(),2===e.activeNav?t("el-form",{ref:"form2",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"X"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:20,step:1},model:{value:e.form2.x,callback:function(t){e.$set(e.form2,"x",t)},expression:"form2.x"}})],1)]),t("el-form-item",{attrs:{label:"Y"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:20,step:1},model:{value:e.form2.y,callback:function(t){e.$set(e.form2,"y",t)},expression:"form2.y"}})],1)]),t("el-form-item",{attrs:{label:"碳碳键长"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{precision:2,step:.01},model:{value:e.form2.Rcc,callback:function(t){e.$set(e.form2,"Rcc",t)},expression:"form2.Rcc"}})],1)]),t("el-form-item",{attrs:{label:"边缘饱和氢"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px"}},[t("el-switch",{staticStyle:{"margin-left":"auto",width:"130px"},attrs:{"active-color":"#0A55FF","active-text":"TRUE","inactive-text":"FALSE"},model:{value:e.form2.terminal_H,callback:function(t){e.$set(e.form2,"terminal_H",t)},expression:"form2.terminal_H"}})],1)])],1):e._e(),3===e.activeNav?t("el-form",{ref:"form3",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"类别"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px","flex-flow":"row-reverse"}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.form3.type,callback:function(t){e.$set(e.form3,"type",t)},expression:"form3.type"}},[t("el-radio-button",{attrs:{label:"锯齿式"}}),t("el-radio-button",{attrs:{label:"椅式"}})],1)],1)]),t("el-form-item",{attrs:{label:"纳米管管径"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:20,step:1},model:{value:e.form3.circle,callback:function(t){e.$set(e.form3,"circle",t)},expression:"form3.circle"}})],1)]),t("el-form-item",{attrs:{label:"纳米管长度"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:10,step:1},model:{value:e.form3.period,callback:function(t){e.$set(e.form3,"period",t)},expression:"form3.period"}})],1)]),t("el-form-item",{attrs:{label:"碳碳键长"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{precision:2,step:.01},model:{value:e.form3.Rcc,callback:function(t){e.$set(e.form3,"Rcc",t)},expression:"form3.Rcc"}})],1)]),t("el-form-item",{attrs:{label:"边缘饱和氢"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px"}},[t("el-switch",{staticStyle:{"margin-left":"auto",width:"130px"},attrs:{"active-color":"#0A55FF","active-text":"TRUE","inactive-text":"FALSE"},model:{value:e.form3.terminal_H,callback:function(t){e.$set(e.form3,"terminal_H",t)},expression:"form3.terminal_H"}})],1)])],1):e._e(),4===e.activeNav?t("el-form",{ref:"form3",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"类别"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px","flex-flow":"row-reverse"}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.form4.type,callback:function(t){e.$set(e.form4,"type",t)},expression:"form4.type"}},[t("el-radio-button",{attrs:{label:"锯齿式"}}),t("el-radio-button",{attrs:{label:"椅式"}})],1)],1)]),t("el-form-item",{attrs:{label:"纳米管管径"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:20,step:1},model:{value:e.form4.circle,callback:function(t){e.$set(e.form4,"circle",t)},expression:"form4.circle"}})],1)]),t("el-form-item",{attrs:{label:"纳米管长度"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:10,step:1},model:{value:e.form4.period,callback:function(t){e.$set(e.form4,"period",t)},expression:"form4.period"}})],1)]),t("el-form-item",{attrs:{label:"碳碳键长"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{precision:2,step:.01},model:{value:e.form4.Rcc,callback:function(t){e.$set(e.form4,"Rcc",t)},expression:"form4.Rcc"}})],1)]),t("el-form-item",{attrs:{label:"碳纳米管层数"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:3,step:1},model:{value:e.form4.walls,callback:function(t){e.$set(e.form4,"walls",t)},expression:"form4.walls"}})],1)]),t("el-form-item",{attrs:{label:"边缘饱和氢"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px"}},[t("el-switch",{staticStyle:{"margin-left":"auto",width:"130px"},attrs:{"active-color":"#0A55FF","active-text":"TRUE","inactive-text":"FALSE"},model:{value:e.form4.terminal_H,callback:function(t){e.$set(e.form4,"terminal_H",t)},expression:"form4.terminal_H"}})],1)])],1):e._e()],1),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.getMol2}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v("生成3d结构视图")]),t("img",{attrs:{src:a("6a60"),alt:""}})])])]),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-carbon",{ref:"moleculeUltimate",attrs:{atoms:e.atoms,width:900,height:670}})],1),e.mol2?t("div",{staticClass:"page_mol-content-right-btns"},[t("div",{staticClass:"page_mol_middle_btns"},[0<e.forceOptions.length?t("div",[t("span",{staticStyle:{color:"#222222","font-size":"14px"}},[e._v("选择力场：")]),t("el-select",{attrs:{size:"small",value:e.force,placeholder:"请选择"},on:{change:e.onForceChange}},e._l(e.forceOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()])])],1)}),[],!1,null,"4910d17d",null).exports;const it=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],rt=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];st={name:"Second",data:()=>({data:rt,columns:it,editingKey:"",tableColumn:it,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","forces","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e)})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){return new Promise((e,t)=>{N(k.carbon_atomtype,{data:this.mol2,forcefield:this.force}).then(t=>{e(t.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("7500"),st=Object(f.a)(st,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div"),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")])],1)])])]),t("div",{staticStyle:{margin:"20px 0",display:"flex","align-items":"center"}}),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"1c08bb0c",null).exports;const nt=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],ct=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],dt={labelCol:{span:4},wrapperCol:{span:8}};var mt={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:ct,columns:nt,editingKey:"",isLoading:!1,data4:null,whichLable:"charge",chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:nt,typeData:ct,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],labelLayer:0,computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:dt,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",x:"",y:"",z:"",showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){var e=this.initParams();Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:this.atoms[t].charge,noEdit:!0}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0,e.lattice)&&0<e.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(){return new Promise((e,t)=>{var a=this.atomtypeOriginData.map((e,t)=>{let a=[],l=this.atomtypeTableData[t];return a.push({name:l.atomtype,type:l.type}),e.forEach((e,t)=>{l.atomtype===e.name&&l.type===e.type||a.push(e)}),a});N(k.atomParam,{data:this.mol2,atomtype:a}).then(t=>{this.$store.commit("setForceParams",t.data),e(t.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2);var l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]);t=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);let n={...this.data4,atoms:t,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e.resname};var{x:t,y:l,z:s}=e;return this.isCtrstal&&(n.supercell=[t,l,s]),new Promise((t,a)=>{R(k[this.computer],n).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),`${this.computer}_${e.resname}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),this.$message.success("文件已下载")}).catch(()=>{this.$message.error("下载错误")}).finally(()=>{this.visible=!1})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleNumberInputChange(e,t){this.form.setFieldsValue({[e]:t.target.value}),this.$nextTick(()=>{this.form.validateFields(["x"],{force:!0})})},handleOk(){this.$refs.ruleForm.validate(e=>{if(!e)return!1;this.downloadFile(this.ruleForm)})},handleCancel(){this.visible=!1},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)}}};a("9787"),mt=Object(f.a)(mt,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"17px",color:"#222222"}},[e._v("选择计算软件:")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px",height:"36px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px",height:"36px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分子名称",prop:"resname"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.resname,callback:function(t){e.$set(e.ruleForm,"resname",t)},expression:"ruleForm.resname"}})],1),e.isCtrstal?t("el-form-item",{attrs:{label:"X",prop:"x"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.x,callback:function(t){e.$set(e.ruleForm,"x",t)},expression:"ruleForm.x"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Y",prop:"y"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.y,callback:function(t){e.$set(e.ruleForm,"y",t)},expression:"ruleForm.y"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Z",prop:"z"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.z,callback:function(t){e.$set(e.ruleForm,"z",t)},expression:"ruleForm.z"}})],1):e._e()],1)],1)],1)}),[],!1,null,"6df1b923",null).exports;const ut=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:st,Third:mt,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return ut[this.activeIndex-1]}},methods:{}},a("65af"),st=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"55be16ff",null).exports,mt={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],currForce:"",activeNav:2,dirOriginData:{20:{Ih:[]},24:{D6d:[]},26:{D3h:[]},28:{D2:[],Td:[]},30:{C1:[1,2,3]},32:{C2:[1,2],D2:[],D3:[],D3d:[],D3h:[]},34:{C2:[1,2,3],C3v:[],Cs:[1,2]},36:{C1:[1,2],C2v:[],C2:[1,2,3,4],Cs:[1,2],D2d:[1,2],D2:[1,2],D3h:[],D6h:[]},38:{C1:[1,2,3,4,5,6,7],C2v:[1,2],C2:[1,2,3,4,5],C3v:[],D3:[],D3h:[]},40:{C1:[1,2,3,4,5,6,7,8],C2v:[1,2],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14],C3:[],C3v:[],Cs:[1,2,3,4,5,6,7],D2h:[],D2:[1,2,3],D5d:[1,2],Td:[]},42:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11],Cs:[1,2,3,4,5,6],D3:[]},44:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],Cs:[1,2,3,4,5,6,7],D2:[1,2,3,4,5,6],D3d:[1,2,3],D3h:[1,2],D3:[1,2],S4:[],T:[]},46:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]},48:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],D2h:[1,2],D2:[1,2,3,4,5],D3:[],D6d:[1,2]},50:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195],C2v:[1,2,3,4,5,6],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],C3v:[],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],D3h:[],D3:[1,2],D5h:[1,2]},52:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78],C3v:[1,2],C3:[1,2,3],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],D2d:[1,2,3,4,5],D2h:[1,2],D2:[1,2,3,4,5,6,7,8,9],T:[]},60:{Ih:[]},70:{D5h:[]},72:{D6d:[]},74:{D3h:[]},76:{D2:[],Td:[]},180:{},240:{},260:{},320:{},500:{},540:{},720:{}},dirKeys:[],dirData:[],currDir:"",isLoading:!1}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","forces","forceOptions","backForce","waterModel","waterModelForces","charge","chargeOptions"])},components:{MoleculeUltimate:C,StepCrystalTitle:De,MyDrag:Ae,FormatDownload:Ie},created(){this.getCurrentFileList().then(e=>{this.dirKeys=[],this.dirData=[...e]})},mounted(){this.getForcesOptions()},methods:{getForcesOptions(){return new Promise((e,t)=>{M(k.inorganicForcefield,{}).then(t=>{this.$store.commit("setForceOptions",t.data),this.$store.commit("setForce",t.data[0]),e(t.data)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},dbclickDirectory(e){if(e.includes(".cif"))return!1;this.dirKeys.push(e),e=""+this.dirKeys.join("/"),this.getCurrentFileList(e).then(e=>{this.dirData=[...e]})},clickItem(e){this.currDir=e},clickBack(){this.dirKeys.pop();var e=""+this.dirKeys.join("/");this.getCurrentFileList(e).then(e=>{this.dirData=[...e]})},getCurrentFileList(e){const t=k.mineralsDatabase+"/"+(e||"");return new Promise((e,a)=>{M(t).then(t=>{t&&e(t.data)})})},generate(){if(this.currDir&&this.currDir.includes(".cif")){var e=""+this.dirKeys.join("/");let t=""+k.mineralsDatabase;e&&(t=t+"/"+e),this.currDir&&(t+="/"+this.currDir),this.isLoading=!0,M(""+t).then((e={})=>{e&&N(k.cif2mol2,{data:e.data}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0)}).catch(e=>{}).finally(()=>{this.isLoading=!1})})}else this.$message.warning("没有选中的cif文件")},updateUploadedMol2(e){this.$refs.moleculeUltimate.init(e,!0)},goSecond(){this.$store.commit("setActiveIndex",this.activeIndex+1)},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")}}},a("e6e1"),Te=Object(f.a)(mt,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"page_mol"},[t("step-crystal-title",{attrs:{title:"选取晶体文件",showUpload:!0},on:{update:e.updateUploadedMol2}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[t("div",{staticClass:"page_mol-content-left-content"},[t("div",{staticClass:"page_mol-content-left-content-container"},[t("div",[0<e.dirKeys.length?t("div",{staticClass:"page_mol-content-top-btn"},[t("div",{staticClass:"page_mol-content-top-btn-left",on:{click:e.clickBack}},[e._v(" 返回上一级 ")]),t("div",{staticClass:"page_mol-content-top-btn-right"},[e._v(" Tips: 选中.cif文件，生成结构视图 ")])]):e._e(),0<e.dirData.length?t("div",[t("div",{staticClass:"page_mol-content-left-content-container-wrapper"},e._l(e.dirData,(function(l,s){return t("div",{key:s,staticClass:"page_mol-content-left-content-container-item",style:{"background-color":e.currDir===l?"#e8e8e8":"#FFFFFF"},on:{dblclick:function(t){return e.dbclickDirectory(l)},click:function(t){return e.clickItem(l)}}},[l.includes(".cif")?t("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"46px"}}):t("img",{attrs:{src:a("1ada"),width:"125px",height:"100px",alt:""}}),t("div",{staticClass:"page_mol-content-left-text-bottom",attrs:{alt:l}},[e._v(" "+e._s(l||"--")+" ")])])})),0)]):t("div",[t("el-empty",{attrs:{description:"空空如也"}})],1)])]),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.generate}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v(" 生成3d结构视图 ")]),t("img",{attrs:{src:a("6a60"),alt:""}})])])]),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:900,height:670,needExtra:!0,tips:"该工具不会进行相关结构的优化，如上传请上传优化后的结构"}})],1),e.mol2?t("div",{staticClass:"page_mol-content-right-btns"},[t("div",{staticClass:"page_mol_middle_btns"},[0<e.forceOptions.length?t("div",[t("span",{staticStyle:{color:"#222222","font-size":"14px"}},[e._v("选择力场：")]),t("el-select",{attrs:{size:"small",value:e.force,placeholder:"请选择"},on:{change:e.onForceChange}},e._l(e.forceOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()])])],1)])}),[],!1,null,"5618610d",null).exports;const pt=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],ht=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];mt={name:"Second",data:()=>({data:ht,columns:pt,editingKey:"",tableColumn:pt,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","forces","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e),this.allHasAtomType=e.every(e=>0<e.length&&e[0].name&&e[0].type),this.hasDU=e.some(e=>e.map(e=>e.name).includes("DU"))})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){return new Promise((e,t)=>{N(k.atomType,{data:this.mol2,forcefield:this.force}).then(t=>{e(t.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("2499"),mt=Object(f.a)(mt,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div"),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),e.allHasAtomType&&!e.hasDU?t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")]):e._e()],1)])])]),t("div",{staticStyle:{margin:"20px 0",display:"flex","align-items":"center"}}),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"3a113c78",null).exports;const vt=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],bt=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],ft={labelCol:{span:4},wrapperCol:{span:8}};var gt={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:bt,columns:vt,editingKey:"",isLoading:!1,data4:null,labelLayer:0,chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:vt,typeData:bt,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:ft,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",x:1,y:1,z:1,showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){var e=this.initParams();Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:e[6],noEdit:!0}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])}))),this.showMolecule=!0,e.lattice&&0<e.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(){return new Promise((e,t)=>{var a=this.atomtypeOriginData.map((e,t)=>{let a=[],l=this.atomtypeTableData[t];return a.push({name:l.atomtype,type:l.type}),e.forEach((e,t)=>{l.atomtype===e.name&&l.type===e.type||a.push(e)}),a});N(k.atomParam,{data:this.mol2,atomtype:a}).then(t=>{this.$store.commit("setForceParams",t.data),e(t.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)},hideAllLabels(){this.$refs["molecule-third"].hideLabels(),this.$refs["molecule-third"].hideAtomLabels(),this.$refs["molecule-third"].hideIdLabels()},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2);var l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]);t=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);let n={...this.data4,atoms:t,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e.resname};var{x:t,y:l,z:s}=e;return this.isCtrstal&&(n.supercell=[t,l,s]),new Promise((t,a)=>{R(k[this.computer],n).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),`${this.computer}_${e.resname}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),this.$message.success("文件已下载")}).catch(()=>{this.$message.error("下载错误")}).finally(()=>{this.visible=!1})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleNumberInputChange(e,t){this.form.setFieldsValue({[e]:t.target.value}),this.$nextTick(()=>{this.form.validateFields(["x"],{force:!0})})},handleOk(){this.$refs.ruleForm.validate(e=>{if(!e)return!1;this.downloadFile(this.ruleForm)})},handleCancel(){this.visible=!1}}};a("99ec"),gt=Object(f.a)(gt,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"17px",color:"#222222"}},[e._v("选择计算软件:")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px",height:"36px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px",height:"36px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分子名称",prop:"resname"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.resname,callback:function(t){e.$set(e.ruleForm,"resname",t)},expression:"ruleForm.resname"}})],1),e.isCtrstal?t("el-form-item",{attrs:{label:"X",prop:"x"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.x,callback:function(t){e.$set(e.ruleForm,"x",t)},expression:"ruleForm.x"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Y",prop:"y"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.y,callback:function(t){e.$set(e.ruleForm,"y",t)},expression:"ruleForm.y"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Z",prop:"z"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.z,callback:function(t){e.$set(e.ruleForm,"z",t)},expression:"ruleForm.z"}})],1):e._e()],1)],1)],1)}),[],!1,null,"0c6f30d8",null).exports;const yt=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:mt,Third:gt,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return yt[this.activeIndex-1]}},methods:{}},a("c744"),mt=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"bad02978",null).exports,gt={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],currForce:"",activeNav:2,dirOriginData:{20:{Ih:[]},24:{D6d:[]},26:{D3h:[]},28:{D2:[],Td:[]},30:{C1:[1,2,3]},32:{C2:[1,2],D2:[],D3:[],D3d:[],D3h:[]},34:{C2:[1,2,3],C3v:[],Cs:[1,2]},36:{C1:[1,2],C2v:[],C2:[1,2,3,4],Cs:[1,2],D2d:[1,2],D2:[1,2],D3h:[],D6h:[]},38:{C1:[1,2,3,4,5,6,7],C2v:[1,2],C2:[1,2,3,4,5],C3v:[],D3:[],D3h:[]},40:{C1:[1,2,3,4,5,6,7,8],C2v:[1,2],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14],C3:[],C3v:[],Cs:[1,2,3,4,5,6,7],D2h:[],D2:[1,2,3],D5d:[1,2],Td:[]},42:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11],Cs:[1,2,3,4,5,6],D3:[]},44:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],Cs:[1,2,3,4,5,6,7],D2:[1,2,3,4,5,6],D3d:[1,2,3],D3h:[1,2],D3:[1,2],S4:[],T:[]},46:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69],C2v:[1,2,3,4],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]},48:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],D2h:[1,2],D2:[1,2,3,4,5],D3:[],D6d:[1,2]},50:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195],C2v:[1,2,3,4,5,6],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],C3v:[],C3:[1,2],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],D3h:[],D3:[1,2],D5h:[1,2]},52:{C1:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307],C2h:[],C2v:[1,2,3],C2:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78],C3v:[1,2],C3:[1,2,3],Cs:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],D2d:[1,2,3,4,5],D2h:[1,2],D2:[1,2,3,4,5,6,7,8,9],T:[]},60:{Ih:[]},70:{D5h:[]},72:{D6d:[]},74:{D3h:[]},76:{D2:[],Td:[]},180:{},240:{},260:{},320:{},500:{},540:{},720:{}},dirKeys:[],dirData:[],currDir:"",isLoading:!1,forceUrl:k.mofForcefield}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","forces","forceOptions","backForce","waterModel","waterModelForces","charge","chargeOptions"])},components:{MoleculeUltimate:C,StepCrystalTitle:De,MyDrag:Ae,FormatDownload:Ie},created(){this.getCurrentFileList().then(e=>{this.dirKeys=[],this.dirData=[...e]})},mounted(){},methods:{dbclickDirectory(e){if(e.includes(".cif"))return!1;this.dirKeys.push(e),e=""+this.dirKeys.join("/"),this.getCurrentFileList(e).then(e=>{this.dirData=[...e]})},clickItem(e){this.currDir=e},clickBack(){this.dirKeys.pop();var e=""+this.dirKeys.join("/");this.getCurrentFileList(e).then(e=>{this.dirData=[...e]})},getCurrentFileList(e){const t=k.mofsDatabase+"/"+(e||"");return new Promise((e,a)=>{M(t).then(t=>{t&&e(t.data)})})},generate(){if(this.currDir&&this.currDir.includes(".cif")){var e=""+this.dirKeys.join("/");let t=""+k.mofsDatabase;e&&(t=t+"/"+e),this.currDir&&(t+="/"+this.currDir),this.isLoading=!0,M(""+t).then((e={})=>{e&&N(k.cif2mol2,{data:e.data}).then(e=>{this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0)}).catch(e=>{}).finally(()=>{this.isLoading=!1})})}else this.$message.warning("没有选中的cif文件")},updateUploadedMol2(e){this.$refs.moleculeUltimate.init(e,!0)},goSecond(){var e=document.getElementById("dropList");0===(e=Array.from(e.children).map(e=>e.innerText)).length?this.$message.error("请至少选择一个力场"):(this.$store.commit("setForces",e),this.$store.commit("setActiveIndex",this.activeIndex+1))},downloadMol2(){this.mol2?S()(this.mol2,"molecule.mol2"):this.$message.warning("没有要下载的mol2文本")}}},a("e4e7"),Te=Object(f.a)(gt,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"page_mol"},[t("step-crystal-title",{attrs:{title:"选取晶体文件",showUpload:!0},on:{update:e.updateUploadedMol2}}),t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[t("div",{staticClass:"page_mol-content-left-content"},[t("div",{staticClass:"page_mol-content-left-content-container"},[t("div",[0<e.dirKeys.length?t("div",{staticClass:"page_mol-content-top-btn"},[t("div",{staticClass:"page_mol-content-top-btn-left",on:{click:e.clickBack}},[e._v(" 返回上一级 ")]),t("div",{staticClass:"page_mol-content-top-btn-right"},[e._v(" Tips: 选中.cif文件，生成结构视图 ")])]):e._e(),0<e.dirData.length?t("div",[t("div",{staticClass:"page_mol-content-left-content-container-wrapper"},e._l(e.dirData,(function(l,s){return t("div",{key:s,staticClass:"page_mol-content-left-content-container-item",style:{"background-color":e.currDir===l?"#e8e8e8":"#FFFFFF"},on:{dblclick:function(t){return e.dbclickDirectory(l)},click:function(t){return e.clickItem(l)}}},[l.includes(".cif")?t("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"46px"}}):t("img",{attrs:{src:a("1ada"),width:"125px",height:"100px",alt:""}}),t("div",{staticClass:"page_mol-content-left-text-bottom",attrs:{alt:l}},[e._v(" "+e._s(l||"--")+" ")])])})),0)]):t("div",[e._v("无数据")])])]),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.generate}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v(" 生成3d结构视图 ")]),t("img",{attrs:{src:a("6a60"),alt:""}})])]),t("my-drag",{attrs:{url:e.forceUrl}})],1),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:900,height:670,needExtra:!0,tips:"该工具不会进行相关结构的优化，如上传请上传优化后的结构"}})],1),e.mol2?t("div",{staticClass:"page_mol-content-right-btns"},[t("div",{staticClass:"page_mol_middle_btns"},[t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()])])],1)])}),[],!1,null,"3a7b75c4",null).exports;const xt=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],wt=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];De={name:"Second",data:()=>({data:wt,columns:xt,editingKey:"",tableColumn:xt,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","forces","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e),this.allHasAtomType=e.every(e=>0<e.length&&e[0].name&&e[0].type),this.hasDU=e.some(e=>e.map(e=>e.name).includes("DU"))})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){let e=0<this.forces.length?this.forces.join("+"):"";return new Promise((t,a)=>{N(k.atomType,{data:this.mol2,forcefield:e}).then(e=>{t(e.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("2ec9"),gt=Object(f.a)(De,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div"),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),e.allHasAtomType&&!e.hasDU?t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")]):e._e()],1)])])]),t("div",{staticStyle:{margin:"20px 0",display:"flex","align-items":"center"}}),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"2f3b47d9",null).exports;const Ct=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],St=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],kt={labelCol:{span:4},wrapperCol:{span:8}};De={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:St,columns:Ct,editingKey:"",isLoading:!1,data4:null,labelLayer:0,chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:Ct,typeData:St,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:kt,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",x:"",y:"",z:"",showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){var e=this.initParams();Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:this.atoms[t].charge,noEdit:!0}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0,e.lattice)&&0<e.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(){return new Promise((e,t)=>{var a=this.atomtypeOriginData.map((e,t)=>{let a=[],l=this.atomtypeTableData[t];return a.push({name:l.atomtype,type:l.type}),e.forEach((e,t)=>{l.atomtype===e.name&&l.type===e.type||a.push(e)}),a});N(k.atomParam,{data:this.mol2,atomtype:a}).then(t=>{this.$store.commit("setForceParams",t.data),e(t.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)},hideAllLabels(){this.$refs["molecule-third"].hideLabels(),this.$refs["molecule-third"].hideAtomLabels(),this.$refs["molecule-third"].hideIdLabels()},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2);var l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]);t=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);let n={...this.data4,atoms:t,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e.resname};var{x:t,y:l,z:s}=e;return this.isCtrstal&&(n.supercell=[t,l,s]),new Promise((t,a)=>{R(k[this.computer],n).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),`${this.computer}_${e.resname}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),this.$message.success("文件已下载")}).catch(()=>{this.$message.error("下载错误")}).finally(()=>{this.visible=!1})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleNumberInputChange(e,t){this.form.setFieldsValue({[e]:t.target.value}),this.$nextTick(()=>{this.form.validateFields(["x"],{force:!0})})},handleOk(){this.$refs.ruleForm.validate(e=>{if(!e)return!1;this.downloadFile(this.ruleForm).finally(()=>{this.visible=!1})})},handleCancel(){this.visible=!1}}},a("a487"),De=Object(f.a)(De,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"17px",color:"#222222"}},[e._v("选择计算软件:")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px",height:"36px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px",height:"36px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分子名称",prop:"resname"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.resname,callback:function(t){e.$set(e.ruleForm,"resname",t)},expression:"ruleForm.resname"}})],1),e.isCtrstal?t("el-form-item",{attrs:{label:"X",prop:"x"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.x,callback:function(t){e.$set(e.ruleForm,"x",t)},expression:"ruleForm.x"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Y",prop:"y"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.y,callback:function(t){e.$set(e.ruleForm,"y",t)},expression:"ruleForm.y"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Z",prop:"z"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.z,callback:function(t){e.$set(e.ruleForm,"z",t)},expression:"ruleForm.z"}})],1):e._e()],1)],1)],1)}),[],!1,null,"70d6f66c",null).exports;const Dt=["First","Second","Third"];Te={name:"Home",components:{First:Te,Second:gt,Third:De,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return Dt[this.activeIndex-1]}},methods:{}},a("64ba"),gt=Object(f.a)(Te,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"b5889066",null).exports,a("1c46"),De={name:"ElBacktop",props:{btnType:{type:String,default:""},data:{type:Array,default:()=>[]}},data:()=>({visible:!1,originData:[],lang:"中文",groups:[],currGroup:"",momos:[],selectedMomo:"",selectedMomoImg:""}),computed:{styleBottom(){return this.bottom+"px"},styleRight(){return this.right+"px"}},created(){this.currGroup=null,this.selectedMomo="",this.selectedMomoImg="",this.groups=[...this.data],this.originData=[...this.data]},mounted(){},methods:{getMonos:()=>new Promise((e,t)=>{M(k.monomer,{}).then(t=>{e(t.data)}).catch(e=>{t(e)})}),showModal(){this.currGroup=null,this.selectedMomo="",this.selectedMomoImg="",this.groups=[...this.data],this.originData=[...this.data],this.visible=!0},handleGroupChange(e){let t=null;t="中文"===this.lang?this.groups.find(t=>t.zh===e):this.groups.find(t=>t.en===e),this.momos=JSON.parse(JSON.stringify(t.subgroup)),setTimeout(()=>{this.selectedMomo=null},0)},handleMomoChange(e){if(e){this.selectedMomo=e;let t=null;t="中文"===this.lang?this.momos.find(t=>t.zh===e):this.momos.find(t=>t.en===e),this.selectedMomoImg=t["2d-structure"]}},handleLangChange(e){this.currGroup=null,this.selectedMomo="",this.selectedMomoImg=""},onClickCancel(){this.visible=!1},onClickOk(){if(this.selectedMomo){let t="中文"===this.lang?"zh":"en";var e=(e=this.momos.find((e,a)=>e[t]===this.selectedMomo))?{value:e[t],id:e.id}:null;this.$emit("select-memo",e),this.$message.success("已选择单体")}this.visible=!1}},beforeDestroy(){}},a("aaec0"),Te=Object(f.a)(De,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("a-button",{attrs:{type:e.btnType},on:{click:e.showModal}},[e._v("选择单体")]),t("a-modal",{attrs:{closable:!1,title:"请选择单体（注：名词可切换中英文）"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("a-row",{staticClass:"list-row",staticStyle:{"font-size":"14px","margin-bottom":"20px"}},[t("a-col",{attrs:{span:8}},[e._v(" 单体库名 ")]),t("a-col",{attrs:{span:8}},[e._v(" 单体名 ")]),t("a-col",{attrs:{span:8}},[e._v(" 结构图 ")])],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:8}},[t("a-select",{staticStyle:{width:"120px"},on:{change:e.handleGroupChange},model:{value:e.currGroup,callback:function(t){e.currGroup=t},expression:"currGroup"}},e._l(e.groups,(function(a,l){return t("a-select-option",{key:l,attrs:{value:"中文"===e.lang?a.zh:a.en}},[e._v(" "+e._s("中文"===e.lang?a.zh:a.en)+" ")])})),1)],1),t("a-col",{attrs:{span:8}},[e.currGroup?t("a-select",{staticStyle:{width:"120px"},on:{change:e.handleMomoChange},model:{value:e.selectedMomo,callback:function(t){e.selectedMomo=t},expression:"selectedMomo"}},e._l(e.momos,(function(a,l){return t("a-select-option",{key:l,attrs:{value:"中文"===e.lang?a.zh:a.en}},[e._v(" "+e._s("中文"===e.lang?a.zh:a.en)+" ")])})),1):t("span",[e._v(" "+e._s("--")+" ")])],1),t("a-col",{attrs:{span:8}},[e.selectedMomo?t("img",{attrs:{width:"120px",height:"120px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/monomer/"+e.selectedMomoImg,alt:""}}):t("span",[e._v(" "+e._s("--")+" ")])])],1),t("template",{slot:"footer"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("div",[t("a-select",{staticStyle:{width:"90px"},on:{change:e.handleLangChange},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}},[t("a-select-option",{attrs:{value:"中文"}},[e._v(" 中文 ")]),t("a-select-option",{attrs:{value:"English"}},[e._v(" English ")])],1)],1),t("div",[t("a-button",{on:{click:e.onClickCancel}},[e._v(" 取消 ")]),t("a-button",{attrs:{type:"primary"},on:{click:e.onClickOk}},[e._v(" 确定 ")])],1)])])],2)],1)}),[],!1,null,"c9d29d46",null).exports;const It=[{dataIndex:"name",key:"name",slots:{title:"customTitle"},scopedSlots:{customRender:"name"},width:"20px"},{dataIndex:"momo",key:"momo",title:"单体",scopedSlots:{customRender:"momo"},width:"300px"},{key:"num",title:"个数",scopedSlots:{customRender:"num"},width:"120px"},{key:"action",title:"操作",scopedSlots:{customRender:"action"}}],_t=[{key:"1",name:"1",num:1,momo:"",momoId:""},{key:"2",name:"2",num:1,momo:"",momoId:""},{key:"3",name:"3",num:1,momo:"",momoId:""}];De={name:"First",data:()=>({mySketcher:null,mpId:"hp-1",cifContent:"",atoms:[],momoData:[],headEndData:[],tailEndData:[],homoForm:{momo:"",momoId:"",headEnd:"",headEndId:"",tailEnd:"",tailEndId:"",converge:"head",convergeDegree:1,degree:180,hasRandomSeed:!1,randomSeed:1},blockForm:{headEnd:"",headEndId:"",tailEnd:"",tailEndId:"",converge:"head",convergeDegree:1,degree:180,hasRandomSeed:!1,randomSeed:1},tableData:_t,tableColumns:It,currForce:"",activeNav:1,currNodeKey:"",currNodeIds:[],form2:{x:1,y:1,Rcc:1.42,terminal_H:!1},form3:{type:"椅式",circle:6,period:2,Rcc:1.42,terminal_H:!1},form4:{type:"椅式",circle:6,period:2,Rcc:1.42,walls:1,terminal_H:!1}}),computed:{...Object(w.b)(["activeIndex","originMol","originMol2","mol2","moleculeJson","force","forces","forceOptions","backForce","waterModel","waterModelForces","charge","chargeOptions"])},components:{MoleculeUltimate:C,StepTitle:Oe,MyDrag:Ae,MyDrag:Ae,FormatDownload:Ie,ChooseMonomer:Te,ChooseEnd:Fe},created(){var e=this.getMonos(),t=this.getEnds("head"),a=this.getEnds("tail");Promise.all([e,t,a]).then(([e,t,a])=>{this.momoData=e,this.headEndData=t,this.tailEndData=a})},mounted(){this.getForcesOptions()},methods:{getMonos:()=>new Promise((e,t)=>{M(k.monomer,{}).then(t=>{e(t.data)}).catch(e=>{t(e)})}),getEnds:e=>new Promise((t,a)=>{M(k.endgroup,{type:e}).then(e=>{t(e.data)}).catch(e=>{a(e)})}),onSelectMemo(e,t){if(e)switch(this.activeNav){case 1:this.homoForm.momo=e.value,this.homoForm.momoId=e.id;break;case 2:var a=this.tableData.find(e=>e.key===t.key);a.momo=e.value,a.id=e.id}},onHeadSelectEnd(e){switch(this.activeNav){case 1:this.homoForm.headEnd=e.value,this.homoForm.headEndId=e.id;break;case 2:this.blockForm.headEnd=e.value,this.blockForm.headEndId=e.id}},onTailSelectEnd(e){switch(this.activeNav){case 1:this.homoForm.tailEnd=e.value,this.homoForm.tailEndId=e.id;break;case 2:this.blockForm.tailEnd=e.value,this.blockForm.tailEndId=e.id}},onChangeNum(e,t){this.tableData.find(e=>e.key===t.key).num=e},onDeleteRow(e){let t=[];this.tableData.forEach((a,l)=>{a.key!==e.key&&t.push(a)}),t=t.map((e,t)=>({...e,key:(t+1).toString(),name:(t+1).toString()})),this.tableData=t},addTableRow(){var e=this.tableData.length;this.tableData.push({key:(e+1).toString(),name:(e+1).toString(),num:1,momo:"",momoId:""})},getMol2(){let e={};switch(this.activeNav){case 1:break;case 2:e={...this.form2},N(k.graphene_square,e).then(e=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))});break;case 3:e={...this.form3};var t="椅式"===this.form3.type?k.armchair_nanocube_single_wall:k.zigzag_nanocube_single_wall;N(t,{circle:this.form3.circle,period:this.form3.period,Rcc:this.form3.Rcc,terminal_H:this.form3.terminal_H}).then(e=>{e&&(this.$store.commit("setMol2",e.data),this.$store.commit("setOriginMol2",e.data),this.$refs.moleculeUltimate.init(e.data,!0))})}},update3D(e){this.$refs.moleculeUltimate.init(e,!0)},getForcesOptions(){return new Promise((e,t)=>{M(k.aaForce,{}).then(t=>{this.$store.commit("setForceOptions",t.data),this.$store.commit("setForce",t.data[0]),e(t.data)}).catch(e=>{t(e)})})},onForceChange(e){this.$store.commit("setForce",e)},parseMOL2File(e){var t=/\s+/g;let a=e.split("\n");e=(a=a.slice(2))[0].split(t).map(e=>e.trim()).filter(e=>0!==e.length);var l=Number(e[0]),s=Number(e[1]);for(a.shift();0<a.length&&!a.shift().includes("@<TRIPOS>ATOM"););var o=a.slice(0,l);let i=0;for(var r=[];i<l;){var n=o[i].split(t).map(e=>e.trim()).filter(e=>0!==e.length);r.push({x:n[2],y:n[3],z:n[4],label:"CL"===n[1]?"Cl":n[1],id:n[0]}),i++}for(;0<a.length&&!a.shift().includes("@<TRIPOS>BOND"););var c=a.slice(0,s);let d=0;for(var m=[];d<s;){var u=c[d].split(t).map(e=>e.trim()).filter(e=>0!==e.length);m.push({s:u[1],e:u[2],type:u[3]}),d++}return this.$store.commit("setAtoms",r),{atoms:r,bonds:m}},goSecond(){this.$store.commit("setActiveIndex",this.activeIndex+1)}}},a("7220"),Ae=Object(f.a)(De,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page_mol"},[t("div",{staticClass:"page_mol-content"},[t("div",{staticClass:"page_mol-content-left"},[t("div",{staticClass:"page_mol-content-left-top"},[t("div",{staticClass:"page_mol-content-left-top-nav",style:{"border-right":"1px solid #d8d8d8",color:1===e.activeNav?"#0A55FF":"#3D3D3D"},on:{click:function(t){e.activeNav=1}}},[e._v(" 均聚物 ")])]),t("div",{staticClass:"page_mol-content-left-content"},[t("div",{staticClass:"page_mol-content-left-content-container"},[1===e.activeNav?t("div",{staticClass:"homopolymer"},[t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 单体 ")]),t("a-col",{attrs:{span:12}},[t("a-input",{attrs:{disabled:"",value:e.homoForm.momo,placeholder:"请点击右侧按钮选择单体"}})],1),t("a-col",{attrs:{span:6,offset:2}},[0<e.momoData.length?t("choose-monomer",{attrs:{data:e.momoData},on:{"select-memo":e.onSelectMemo}}):e._e()],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 头部端基 ")]),t("a-col",{attrs:{span:12}},[t("a-input",{attrs:{disabled:"",value:e.homoForm.headEnd,placeholder:"请点击右侧按钮选择头部端基"}})],1),t("a-col",{attrs:{span:6,offset:2}},[e.headEndData&&0<e.headEndData.length?t("choose-end",{attrs:{data:e.headEndData,title:"请选择头部端基（注：名词可切换中英文）","btn-text":"选择头部端基"},on:{"select-end":e.onHeadSelectEnd}}):e._e()],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 尾部端基 ")]),t("a-col",{attrs:{span:12}},[t("a-input",{attrs:{disabled:"",value:e.homoForm.tailEnd,placeholder:"请点击右侧按钮选择尾部端基"}})],1),t("a-col",{attrs:{span:6,offset:2}},[e.headEndData&&0<e.headEndData.length?t("choose-end",{attrs:{data:e.tailEndData,"btn-text":"选择尾部端基",title:"请选择尾部端基（注：名词可切换中英文）"},on:{"select-end":e.onTailSelectEnd}}):e._e()],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 聚合方式 ")]),t("a-col",{attrs:{span:12}},[t("a-select",{staticStyle:{width:"120px"},attrs:{"default-value":"head"},model:{value:e.homoForm.converge,callback:function(t){e.$set(e.homoForm,"converge",t)},expression:"homoForm.converge"}},[t("a-select-option",{attrs:{value:"head"}},[e._v(" 首首连接 ")]),t("a-select-option",{attrs:{value:"tail"}},[e._v(" 尾尾连接 ")])],1)],1),t("a-col",{attrs:{span:6,offset:2}})],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 聚合度 ")]),t("a-col",{attrs:{span:12}},[t("a-input-number",{attrs:{min:1,max:1e3},model:{value:e.homoForm.convergeDegree,callback:function(t){e.$set(e.homoForm,"convergeDegree",t)},expression:"homoForm.convergeDegree"}})],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 角度 ")]),t("a-col",{attrs:{span:12}},[t("a-input-number",{attrs:{min:-180,max:180},model:{value:e.homoForm.degree,callback:function(t){e.$set(e.homoForm,"degree",t)},expression:"homoForm.degree"}})],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 随机数种子 ")]),t("a-col",{attrs:{span:4}},[t("a-switch",{model:{value:e.homoForm.hasRandomSeed,callback:function(t){e.$set(e.homoForm,"hasRandomSeed",t)},expression:"homoForm.hasRandomSeed"}})],1),e.homoForm.hasRandomSeed?t("a-col",{attrs:{span:16}},[t("a-input-number",{attrs:{min:1,max:10},model:{value:e.homoForm.randomSeed,callback:function(t){e.$set(e.homoForm,"randomSeed",t)},expression:"homoForm.randomSeed"}})],1):e._e()],1)],1):e._e(),2===e.activeNav?t("div",{staticClass:"blockpolymer"},[t("div",{staticStyle:{padding:"5px",border:"1px solid #eeeeee","margin-bottom":"10px"}},[t("a-row",{staticStyle:{display:"flex","align-items":"center"}},[t("a-col",{staticStyle:{"font-weight":"600"},attrs:{span:4}},[e._v(" 构建重复单元 ")]),t("a-col",{attrs:{span:4,offset:16}},[t("a-button",{attrs:{type:"link"},on:{click:e.addTableRow}},[e._v(" + 新增一行")])],1)],1),t("a-table",{attrs:{pagination:!1,columns:e.tableColumns,"data-source":e.tableData,scroll:{y:120},size:"small"},scopedSlots:e._u([{key:"name",fn:function(a){return t("a",{},[e._v(e._s(a))])}},{key:"momo",fn:function(a,l){return t("span",{},[t("div",{staticStyle:{display:"flex"}},[t("a-input",{attrs:{value:l.momo,disabled:"",placeholder:"点右侧选择单体"}}),0<e.momoData.length?t("choose-monomer",{attrs:{data:e.momoData,"btn-type":"link"},on:{"select-memo":t=>e.onSelectMemo(t,l)}}):e._e()],1)])}},{key:"num",fn:function(a,l){return t("span",{},[t("a-input-number",{attrs:{value:l.num,min:1,max:1e3},on:{change:t=>e.onChangeNum(t,l)}})],1)}},{key:"action",fn:function(a,l){return t("span",{},[t("a-button",{attrs:{shape:"circle",icon:"delete"},on:{click:()=>e.onDeleteRow(l)}})],1)}}],null,!1,355339002)})],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 头部端基 ")]),t("a-col",{attrs:{span:12}},[t("a-input",{attrs:{disabled:"",value:e.blockForm.headEnd,placeholder:"请点击右侧按钮选择头部端基"}})],1),t("a-col",{attrs:{span:6,offset:2}},[e.headEndData&&0<e.headEndData.length?t("choose-end",{attrs:{data:e.headEndData,title:"请选择头部端基（注：名词可切换中英文）","btn-text":"选择头部端基"},on:{"select-end":e.onHeadSelectEnd}}):e._e()],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 尾部端基 ")]),t("a-col",{attrs:{span:12}},[t("a-input",{attrs:{disabled:"",value:e.blockForm.tailEnd,placeholder:"请点击右侧按钮选择尾部端基"}})],1),t("a-col",{attrs:{span:6,offset:2}},[e.headEndData&&0<e.headEndData.length?t("choose-end",{attrs:{data:e.tailEndData,"btn-text":"选择尾部端基",title:"请选择尾部端基（注：名词可切换中英文）"},on:{"select-end":e.onTailSelectEnd}}):e._e()],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 聚合方式 ")]),t("a-col",{attrs:{span:12}},[t("a-select",{staticStyle:{width:"120px"},attrs:{"default-value":"head"},model:{value:e.blockForm.converge,callback:function(t){e.$set(e.blockForm,"converge",t)},expression:"blockForm.converge"}},[t("a-select-option",{attrs:{value:"head"}},[e._v(" 首首连接 ")]),t("a-select-option",{attrs:{value:"tail"}},[e._v(" 尾尾连接 ")])],1)],1),t("a-col",{attrs:{span:6,offset:2}})],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 聚合度 ")]),t("a-col",{attrs:{span:12}},[t("a-input-number",{attrs:{min:1,max:1e3},model:{value:e.blockForm.convergeDegree,callback:function(t){e.$set(e.blockForm,"convergeDegree",t)},expression:"blockForm.convergeDegree"}})],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 角度 ")]),t("a-col",{attrs:{span:12}},[t("a-input-number",{attrs:{min:-180,max:180},model:{value:e.blockForm.degree,callback:function(t){e.$set(e.blockForm,"degree",t)},expression:"blockForm.degree"}})],1)],1),t("a-row",{staticClass:"list-row"},[t("a-col",{attrs:{span:4}},[e._v(" 随机数种子 ")]),t("a-col",{attrs:{span:4}},[t("a-switch",{model:{value:e.blockForm.hasRandomSeed,callback:function(t){e.$set(e.blockForm,"hasRandomSeed",t)},expression:"blockForm.hasRandomSeed"}})],1),e.blockForm.hasRandomSeed?t("a-col",{attrs:{span:16}},[t("a-input-number",{attrs:{min:1,max:10},model:{value:e.blockForm.randomSeed,callback:function(t){e.$set(e.blockForm,"randomSeed",t)},expression:"blockForm.randomSeed"}})],1):e._e()],1)],1):e._e(),3===e.activeNav?t("el-form",{ref:"form3",attrs:{"label-width":"100px"}},[t("el-form-item",{attrs:{label:"类别"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px","flex-flow":"row-reverse"}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.form3.type,callback:function(t){e.$set(e.form3,"type",t)},expression:"form3.type"}},[t("el-radio-button",{attrs:{label:"锯齿式"}}),t("el-radio-button",{attrs:{label:"椅式"}})],1)],1)]),t("el-form-item",{attrs:{label:"纳米管管径"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:20,step:1},model:{value:e.form3.circle,callback:function(t){e.$set(e.form3,"circle",t)},expression:"form3.circle"}})],1)]),t("el-form-item",{attrs:{label:"纳米管长度"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{min:1,max:10,step:1},model:{value:e.form3.period,callback:function(t){e.$set(e.form3,"period",t)},expression:"form3.period"}})],1)]),t("el-form-item",{attrs:{label:"碳碳键长"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input-number",{staticStyle:{"margin-left":"auto",width:"200px"},attrs:{precision:2,step:.01},model:{value:e.form3.Rcc,callback:function(t){e.$set(e.form3,"Rcc",t)},expression:"form3.Rcc"}})],1)]),t("el-form-item",{attrs:{label:"边缘饱和氢"}},[t("div",{staticStyle:{display:"flex","align-items":"center",height:"40px"}},[t("el-switch",{staticStyle:{"margin-left":"auto",width:"130px"},attrs:{"active-color":"#0A55FF","active-text":"TRUE","inactive-text":"FALSE"},model:{value:e.form3.terminal_H,callback:function(t){e.$set(e.form3,"terminal_H",t)},expression:"form3.terminal_H"}})],1)])],1):e._e()],1),t("div",{staticClass:"page_mol-content-left-btn",staticStyle:{display:"flex","align-items":"center","justify-content":"center"},on:{click:e.getMol2}},[t("div",{staticStyle:{"font-size":"12px","margin-right":"3px"}},[e._v("生成3d结构视图")]),t("img",{attrs:{src:a("6a60"),alt:""}})])]),t("my-drag")],1),t("div",{staticClass:"page_mol-content-right"},[t("div",{staticStyle:{width:"900px",height:"670px",position:"relative"}},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{atoms:e.atoms,width:900,height:670}})],1),e.mol2?t("div",{staticClass:"page_mol-content-right-btns"},[t("div",{staticClass:"page_mol_middle_btns"},[0<e.forceOptions.length?t("div",[t("span",{staticStyle:{color:"#222222","font-size":"14px"}},[e._v("选择力场：")]),t("el-select",{attrs:{size:"small",value:e.force,placeholder:"请选择"},on:{change:e.onForceChange}},e._l(e.forceOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:e}})})),1)],1):e._e(),t("div",{staticStyle:{"margin-left":"auto"}},[t("Format-download",{attrs:{mol2:e.originMol2}}),t("a-button",{staticStyle:{width:"100px","background-color":"#0a55ff","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.goSecond}},[e._v(" 下一步 ")])],1)])]):e._e()])])])}),[],!1,null,"163c4cf5",null).exports;const At=[{title:"序号",dataIndex:"id",key:"id"},{title:"元素",dataIndex:"element",key:"element"},{title:"力场类型",dataIndex:"type",key:"type"},{title:"原子类型",dataIndex:"atomtype",key:"atomtype"}],Ft=[{id:"1",key:"1",element:"John Brown",atomtype:32},{id:"2",key:"2",element:"John Brown",atomtype:32}];Ie={name:"Second",data:()=>({data:Ft,columns:At,editingKey:"",tableColumn:At,selectedAtoms:[],typesData:[],modalVisible:!1,currAtom:null,allHasAtomType:!1,hasDU:!1}),components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","force","forces","backForce","waterModel","waterModelForces","forceParams","charge","chargeType","chargeOptions","switchValue","atomtypeTableData","chargeTypeOptions"])},created(){this.initAtomType().then(e=>{this.typesData=e.slice();var t=this.atoms.map((t,a)=>({id:a+1,key:a+1,element:t.label,atomtype:e[a][0].name,type:e[a][0].type}));this.$store.commit("setAtomTypeTableData",t),this.$store.commit("setAtomTypeOriginData",e)})},methods:{updateSelectedAtom(e){if(this.selectedAtoms=e.map(e=>e.name),0<this.selectedAtoms.length){const a=this.selectedAtoms[0];e=this.typesData[Number(a)-1];var t=this.atomtypeTableData.find(e=>e.id.toString()===a);this.currAtom={id:a,atomtype:t.atomtype+"|"+t.type,atomtypeOptions:e},this.$nextTick(()=>{this.modalVisible=!0})}},uniqueArray(e,t){const a=new Map;return e.filter(e=>!a.has(e[t])&&a.set(e[t],1))},onAtomtypeChange(e){this.currAtom.atomtype=e.name+"|"+e.type},handleOk(){var e=JSON.parse(JSON.stringify(this.atomtypeTableData)),t=e.find((e,t)=>e.id===Number(this.currAtom.id));t.atomtype=this.currAtom.atomtype.split("|")[0],t.type=this.currAtom.atomtype.split("|")[1],this.$store.commit("setAtomTypeTableData",e),this.modalVisible=!1},initAtomType(){return new Promise((e,t)=>{N(k.carbon_atomtype,{data:this.mol2,forcefield:this.force}).then(t=>{e(t.data)}).catch(e=>{})})},onSwitchChange(e){this.$store.commit("setSwitchValue",e.target.value)},onChargeTypeChange(e){this.$store.commit("setChargeType",e)},goThird(){this.$store.commit("setActiveIndex",this.activeIndex+1)},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)}}},a("2be1"),Te=Object(f.a)(Ie,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"second-wrapper"},[t("step-title",{attrs:{title:"根据力场选择原子类型",showUpload:!1}}),t("div",{staticClass:"second-wrapper-content"},[t("div",{staticClass:"second-wrapper-molecule-container"},[t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"点击结构视图中原子可进行配置atomtype"},on:{updateSelectedAtom:e.updateSelectedAtom}})],1),t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-table-container"},[t("my-table",{attrs:{columns:e.tableColumn,data:e.atomtypeTableData,selectedAtoms:e.selectedAtoms}})],1),t("div",{staticClass:"list-wrapper-btns"},[t("div"),t("div",{staticStyle:{"margin-left":"10px"}},[t("a-button",{staticStyle:{"margin-right":"auto",width:"80px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"10px","background-color":"#0a55ff",color:"#ffffff"},attrs:{type:"primary"},on:{click:e.goThird}},[e._v(" 下一步 ")])],1)])])]),t("div",{staticStyle:{margin:"20px 0",display:"flex","align-items":"center"}}),t("a-modal",{attrs:{title:"配置该原子的原子类型",width:600},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[e.currAtom?t("div",e._l(e.currAtom.atomtypeOptions,(function(a,l){return t("div",{key:l,style:{display:"flex",height:"65px",lineHeight:"65px",justifyContent:"space-between",alignItems:"center"},attrs:{value:a}},[t("a-radio",{attrs:{checked:e.currAtom.atomtype===a.name+"|"+a.type},on:{click:function(t){return e.onAtomtypeChange(a)}}},[e._v(" "+e._s(a.name)+"  (type:"+e._s(a.type)+") ")]),t("img",{attrs:{height:"65px",src:"https://api-autoff-dev.mp.iresearch.net.cn/static/atomtype/"+a.type.replace("*","_")+"/"+a.name.replace("*","_")+".svg",alt:""}})],1)})),0):e._e()])],1)}),[],!1,null,"092524fd",null).exports;const Tt=[{title:"ID",dataIndex:"id",key:"id"},{title:"ELEMENT",dataIndex:"element",key:"element"},{title:"ATOMTYPE",dataIndex:"atomtype",key:"atomtype"}],Mt=[{id:"1",element:"John Brown",atomtype:32},{id:"2",element:"John Brown",atomtype:32}],Nt={labelCol:{span:4},wrapperCol:{span:8}};Fe={name:"Second",data(){return{activeKeys:["1","2","3","4","5","6"],activeNavId:1,tableNavs:[{id:1,name:"ATOMS"},{id:2,name:"BONDS"},{id:3,name:"ANGLES"},{id:4,name:"DIHEDRALS"},{id:5,name:"IMPROPER"}],data:Mt,columns:Tt,editingKey:"",isLoading:!1,data4:null,whichLable:"charge",chargeColumn:[{title:"序号",dataIndex:"id",width:"7%",scopedSlots:{customRender:"id"}},{title:"基团",dataIndex:"atom",width:"7%",scopedSlots:{customRender:"atom"}},{title:"电荷",dataIndex:"charge",scopedSlots:{customRender:"charge"}},{title:"质量",dataIndex:"mass",scopedSlots:{customRender:"mass"}},{title:"范德华半径 (nm)",dataIndex:"alpha",scopedSlots:{customRender:"alpha"}},{title:"势阱深度 (kJ·mol-1)",dataIndex:"beta",scopedSlots:{customRender:"beta"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],typeColumn:Tt,typeData:Mt,anglesColumns:[],anglesDatas:[],anglesColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"原子3",dataIndex:"atom3",width:"8%",scopedSlots:{customRender:"atom3"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键角(°)",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·rad-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],anglesData:[],bondsColumns:[],bondsDatas:[],bondsColumn:[{title:"原子1",dataIndex:"atom1",width:"8%",scopedSlots:{customRender:"atom1"}},{title:"原子2",dataIndex:"atom2",width:"8%",scopedSlots:{customRender:"atom2"}},{title:"函数类型",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"键长(nm）",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"力常数(kJ·mol-1·nm-2)",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],bondsData:[],dihedralsColumns:[],dihedralsDatas:[],dihedralsColumn:[{title:"原子1",width:"6%",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{title:"原子2",width:"6%",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{title:"原子3",width:"6%",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{title:"原子4",width:"6%",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"参数4",dataIndex:"pos4",scopedSlots:{customRender:"pos4"}},{title:"参数5",dataIndex:"pos5",scopedSlots:{customRender:"pos5"}},{title:"参数6",dataIndex:"pos6",scopedSlots:{customRender:"pos6"}},{title:"参数7",dataIndex:"pos7",scopedSlots:{customRender:"pos7"}},{title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}],dihedralsData:[],impropersColumns:[],impropersDatas:[],improperColumn:[{width:"8%",title:"原子1",dataIndex:"atom1",scopedSlots:{customRender:"atom1"}},{width:"8%",title:"原子2",dataIndex:"atom2",scopedSlots:{customRender:"atom2"}},{width:"8%",title:"原子3",dataIndex:"atom3",scopedSlots:{customRender:"atom3"}},{width:"8%",title:"原子4",dataIndex:"atom4",scopedSlots:{customRender:"atom4"}},{title:"参数1",dataIndex:"pos1",scopedSlots:{customRender:"pos1"}},{title:"参数2",dataIndex:"pos2",scopedSlots:{customRender:"pos2"}},{title:"参数3",dataIndex:"pos3",scopedSlots:{customRender:"pos3"}},{title:"操作",width:"12%",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],improperData:[],pairsColumns:[{title:"原子1",dataIndex:"first"},{title:"原子4",dataIndex:"second"},{title:"函数类型",dataIndex:"third"}],pairsData:[],selectedAtoms:[],labelLayer:0,computer:"gromacs",visible:!1,checkNick:!1,formItemLayout:Nt,form:this.$form.createForm(this,{name:"resname_form"}),resname:"",x:"",y:"",z:"",showMolecule:!1,isCtrstal:!1,ruleForm:{resname:"NUK",x:1,y:1,z:1},rules:{resname:[{required:!0,message:"请输入resname",trigger:"change"}],x:[{required:!0,message:"请输入x方向扩展",trigger:"change"}],y:[{required:!0,message:"请输入y方向扩展",trigger:"change"}],z:[{required:!0,message:"请输入z方向扩展",trigger:"change"}]}}},components:{MoleculeUltimate:C,EditTable:Ne,MyTable:Re,EditTableWithNoEdit:ze,StepTitle:Oe},computed:{...Object(w.b)(["activeIndex","mol2","atoms","chargeResult","force","backForce","waterModel","charge","chargeType","forceParams","atomtypeTableData","atomtypeOriginData","switchValue","waterModelForces"])},created(){var e=this.initParams();Promise.all([e]).then(([e])=>{var t=e.atoms.map((e,t)=>({key:t.toString(),id:(t+1).toString(),atom:this.atoms[t].label,mass:e[7],alpha:e[8],beta:e[9],charge:this.atoms[t].charge,noEdit:!0}));this.$store.commit("setChargeResult",t),e&&e.angles&&e.bonds&&e.dihedrals&&e.impropers&&e.pairs&&(this.data4=e,this.formatTableData(2,e.bonds,"bondsColumns","bondsDatas"),this.formatTableData(3,e.angles,"anglesColumns","anglesDatas"),this.formatTableData(4,e.dihedrals,"dihedralsColumns","dihedralsDatas"),this.formatTableData(4,e.impropers,"impropersColumns","impropersDatas"),this.pairsData=e.pairs.map((e,t)=>({key:t.toString(),id:(t+1).toString(),first:e[0],second:e[1],third:parseInt(e[2])})),this.showMolecule=!0,e.lattice)&&0<e.lattice.length&&(this.isCtrstal=!0)}).finally(()=>{})},methods:{initChargeTable1(){return new Promise((e,t)=>{N(k.atom,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initChargeTable2(){return new Promise((e,t)=>{N(k.lj,{atomtype:this.atomtypeTableData.map(e=>({name:e.atomtype,type:e.type}))}).then(t=>{e(t.data)})})},initParams(){return new Promise((e,t)=>{var a=this.atomtypeOriginData.map((e,t)=>{let a=[],l=this.atomtypeTableData[t];return a.push({name:l.atomtype,type:l.type}),e.forEach((e,t)=>{l.atomtype===e.name&&l.type===e.type||a.push(e)}),a});N(k.atomParam,{data:this.mol2,atomtype:a}).then(t=>{this.$store.commit("setForceParams",t.data),e(t.data)})})},initChargeParams(){let e=k.resp;switch(this.chargeType){case"resp":e=k.resp;break;case"cm5":e=k.cm5;break;case"1.2xcm5":e=k.cm5_2;break;case"qeq":e=k.qeq;break;case"am1bcc":e=k.am1bcc;break;case"mmff94":e=k.mmff94;break;case"oplsaa":e=k.oplsaa;break;case"cm1a":e=k.cm1a;break;case"1.14xcm1a":e=k.cm1a_2;break;case"--":e=""}return new Promise(e?(t,a)=>{N(e,{data:this.mol2,charge:this.charge}).then(e=>{t(e.data)}).catch(e=>{})}:(e,t)=>{e("")})},updateSelectedAtom(e){this.selectedAtoms=e.map(e=>e.name)},handleComputerChange(e){this.computer=e},goBack(){this.$store.commit("setActiveIndex",this.activeIndex-1)},formatTableData(e,t,a,l){const s=this.classifyTable(e,t);Object.keys(s).sort(Number).forEach((t,o)=>{var i=s[t];let r=0===i.length?0:i[0].length;if(!t)switch(a){case"anglesColumns":r=r+1+6;break;case"bondsColumns":r=r+1+3;break;case"dihedralsColumns":case"impropersColumns":r=r+1+6}var n=[];for(let t=0;t<e;t++)n.push({title:"原子"+(t+1),dataIndex:"atom"+(t+1),width:"8%",scopedSlots:{customRender:"atom"+(t+1)}});for(let t=e;t<r;t++)n.push({title:t===e?"函数类型":"参数"+(t-e),dataIndex:"pos"+(t-e+1),scopedSlots:{customRender:"pos"+(t-e+1)}});n.push({title:"操作",dataIndex:"operation",width:"12%",scopedSlots:{customRender:"operation"}}),this[a].push(n),t=i.map((t,a)=>{var l={key:a.toString()};for(let a=0;a<e;a++)l["atom"+(a+1)]=t[a];for(let a=e;a<r;a++)void 0===t[a]||null===t[a]?l["pos"+(a-e+1)]="":l["pos"+(a-e+1)]=a===e?t[a]:Number(t[a]).toFixed(3);return l}),this[l].push(t)})},classifyTable(e,t){const a={};return t.forEach((t,l)=>{a[t[e]]||(a[t[e]]=[]),a[t[e]].push(t.slice())}),a},generateParams(e,t,a){let l=[];return this[e].forEach((e,s)=>{let o=this.$refs[t][s].data;if(0!==o.length){var i=(s=Object.keys(o[0]).length)-a-1;let e=[];for(let t=0;t<a;t++)e.push("atom"+(t+1));for(let t=0;t<i;t++)e.push("pos"+(t+1));o=o.map((t,a)=>e.map(e=>isNaN(Number(t[e]))?t[e]:Number(t[e])))}l=l.concat(o)}),l},downloadFile(e){var t=this.$refs.chargeTable.data;const a=this.$refs.moleculeUltimate.parseMOL2File(this.mol2);var l=this.generateParams("bondsColumns","bondsGroup",2),s=this.generateParams("anglesColumns","anglesGroup",3),o=this.generateParams("dihedralsColumns","dihedralsGroup",4),i=this.generateParams("impropersColumns","impropersGroup",4),r=this.$refs.pairsGroup.data.map((e,t)=>[e.first,e.second,e.third]);t=t.map((e,t)=>[e.atom,this.atomtypeTableData[t].atomtype,this.atomtypeTableData[t].type,Number(a.atoms[t].x),Number(a.atoms[t].y),Number(a.atoms[t].z),Number(e.charge),Number(e.mass),Number(e.alpha),Number(e.beta)]);let n={...this.data4,atoms:t,bonds:l,angles:s,dihedrals:o,impropers:i,pairs:r,resname:e.resname};var{x:t,y:l,z:s}=e;return this.isCtrstal&&(n.supercell=[t,l,s]),new Promise((t,a)=>{R(k[this.computer],n).then(t=>{t=new Blob([t],{type:"application/octet-stream"});var a=document.createElement("a"),l=(t=window.URL.createObjectURL(t),`${this.computer}_${e.resname}.zip`);a.style.display="none",a.href=t,a.download=l,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),this.$message.success("文件已下载")}).catch(()=>{this.$message.error("下载错误")}).finally(()=>{this.visible=!1})})},openModal(){this.form.resetFields(),this.visible=!0},handleInputChange(e){this.form.setFieldsValue({resname:e.target.value}),this.$nextTick(()=>{this.form.validateFields(["resname"],{force:!0})})},handleNumberInputChange(e,t){this.form.setFieldsValue({[e]:t.target.value}),this.$nextTick(()=>{this.form.validateFields(["x"],{force:!0})})},handleOk(){this.$refs.ruleForm.validate(e=>{if(!e)return!1;this.downloadFile(this.ruleForm)})},handleCancel(){this.visible=!1},switchLabel(e){this.$refs.moleculeUltimate.switchLabel(e.target.value)}}},a("cbef"),De=Object(f.a)(Fe,(function(){var e=this,t=e._self._c;return t("a-spin",{attrs:{tip:"Loading...",spinning:e.isLoading}},[t("div",{staticClass:"third-wrapper"},[t("step-title",{attrs:{title:"生成拓扑文件",showUpload:!1}}),t("div",{staticClass:"third-wrapper-content"},[t("div",[t("div",{staticClass:"third-wrapper-molecule-container"},[e.showMolecule?t("molecule-ultimate",{ref:"moleculeUltimate",attrs:{width:600,height:600,needExtra:!0,tips:"可通过下方按钮切换显示标签"}}):e._e()],1),t("div",{staticClass:"third-wrapper-tags"},[e._v(" 显示标签: "),t("a-radio-group",{staticStyle:{"margin-top":"10px","margin-left":"14px"},attrs:{"button-style":"solid"},on:{change:e.switchLabel},model:{value:e.labelLayer,callback:function(t){e.labelLayer=t},expression:"labelLayer"}},[t("a-radio-button",{attrs:{value:0}},[e._v(" 无 ")]),t("a-radio-button",{attrs:{value:1}},[e._v(" atom ")]),t("a-radio-button",{attrs:{value:2}},[e._v(" id ")]),t("a-radio-button",{attrs:{value:3}},[e._v(" charge ")])],1)],1)]),t("div",{staticStyle:{display:"flex",flex:"1","flex-flow":"column","margin-left":"24px"}},[t("div",{staticClass:"list-wrapper"},[t("div",{staticClass:"list-wrapper-navs"},e._l(e.tableNavs,(function(a){return t("div",{key:a.id,style:{width:"128px",height:"36px",borderRadius:"3px",background:e.activeNavId===a.id?"#0a55ff":"#E1E4F0",color:"#ffffff","text-align":"center","line-height":"36px",display:"inline-block",marginRight:"4px",cursor:"pointer"},on:{click:function(t){e.activeNavId=a.id}}},[e._v(" "+e._s(a.name)+" ")])})),0),t("div",{staticClass:"list-wrapper-tables"},[t("edit-table-with-no-edit",{directives:[{name:"show",rawName:"v-show",value:1===e.activeNavId,expression:"activeNavId === 1"}],ref:"chargeTable",attrs:{columns:e.chargeColumn,originData:e.chargeResult,selectedAtoms:e.selectedAtoms}}),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.activeNavId,expression:"activeNavId === 2"}]},e._l(e.bondsColumns,(function(a,l){return t("edit-table",{key:l,ref:"bondsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.bondsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:3===e.activeNavId,expression:"activeNavId === 3"}]},e._l(e.anglesColumns,(function(a,l){return t("edit-table",{key:l,ref:"anglesGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.anglesDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.activeNavId,expression:"activeNavId === 4"}]},e._l(e.dihedralsColumns,(function(a,l){return t("edit-table",{key:l,ref:"dihedralsGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.dihedralsDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.activeNavId,expression:"activeNavId === 5"}]},e._l(e.impropersColumns,(function(a,l){return t("edit-table",{key:l,ref:"impropersGroup",refInFor:!0,staticStyle:{"margin-bottom":"5px"},attrs:{columns:a,originData:e.impropersDatas[l],selectedAtoms:e.selectedAtoms}})})),1),t("div",{directives:[{name:"show",rawName:"v-show",value:7===e.activeNavId,expression:"activeNavId === 7"}]},[t("edit-table",{ref:"pairsGroup",attrs:{columns:e.pairsColumns,originData:e.pairsData,selectedAtoms:e.selectedAtoms}})],1)],1)]),t("div",{staticClass:"list-wrapper-btns"},[t("div",{staticStyle:{"margin-right":"17px",color:"#222222"}},[e._v("选择计算软件:")]),t("el-select",{ref:"select",staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",value:e.computer,placeholder:"请选择"},on:{change:e.handleComputerChange}},[t("el-option",{attrs:{value:"gromacs"}},[e._v("gromacs")]),t("el-option",{attrs:{value:"lammps"}},[e._v("lammps")]),t("el-option",{attrs:{value:"amber"}},[e._v("amber")]),t("el-option",{attrs:{value:"moltemplate"}},[e._v("moltemplate")]),t("el-option",{attrs:{value:"openmm"}},[e._v("openmm")]),t("el-option",{attrs:{value:"tinker"}},[e._v("tinker")]),t("el-option",{attrs:{value:"charmm"}},[e._v("charmm")])],1),t("a-button",{staticStyle:{"margin-left":"auto",width:"100px",height:"36px","border-color":"#0a55ff",color:"#0a55ff"},on:{click:e.goBack}},[e._v(" 上一步 ")]),t("a-button",{staticStyle:{"margin-left":"9px",width:"100px",height:"36px","border-color":"#0a55ff",color:"#ffffff","background-color":"#0a55ff"},attrs:{type:"primary"},on:{click:e.openModal}},[e._v(" 下载 ")])],1)])])],1),t("a-modal",{attrs:{title:"请输入分子名称后生成文件下载",width:600},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分子名称",prop:"resname"}},[t("el-input",{staticStyle:{width:"200px"},model:{value:e.ruleForm.resname,callback:function(t){e.$set(e.ruleForm,"resname",t)},expression:"ruleForm.resname"}})],1),e.isCtrstal?t("el-form-item",{attrs:{label:"X",prop:"x"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.x,callback:function(t){e.$set(e.ruleForm,"x",t)},expression:"ruleForm.x"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Y",prop:"y"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.y,callback:function(t){e.$set(e.ruleForm,"y",t)},expression:"ruleForm.y"}})],1):e._e(),e.isCtrstal?t("el-form-item",{attrs:{label:"Z",prop:"z"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:1,max:10,step:1,precision:0},model:{value:e.ruleForm.z,callback:function(t){e.$set(e.ruleForm,"z",t)},expression:"ruleForm.z"}})],1):e._e()],1)],1)],1)}),[],!1,null,"1f1d23d6",null).exports;const Rt=["First","Second","Third"];Ie={name:"Home",components:{First:Ae,Second:Te,Third:De,SelfBackTop:Ve},data:()=>({}),created(){},computed:{...Object(w.b)(["mol2","activeIndex"]),activeComp(){return Rt[this.activeIndex-1]}},methods:{}},a("9ff0"),C=Object(f.a)(Ie,(function(){var e=this._self._c;return e("div",{staticClass:"home"},[e(this.activeComp,{tag:"component"}),e("self-back-top",{attrs:{right:-4,bottom:80}})],1)}),[],!1,null,"1f1169b0",null).exports,b.default.use(y.a),Ne=[{path:"/",name:"Atom",component:x},{path:"/all-atom",name:"WholeMolecule",component:Ee},{path:"/united-atom",name:"UnitedMolecule",component:Ge},{path:"/ion-liquid",component:Qe},{path:"/carbon-material",name:"CarbonMaterial",component:st},{path:"/mof-cof",name:"MofCof",component:gt},{path:"/inorganic-crystals",name:"InorganicCrystals",component:mt},{path:"/polymers",name:"polymers",component:C}],Re=new y.a({routes:Ne}),b.default.use(w.a),ze=new w.a.Store({state:{originFileName:"",originFileContent:"",activeIndex:1,fileList:[],originMol2:"",originMol:"",mol2:"",moleculeJson:"",atoms:null,force:"GAFF",forces:[],forceOptions:[],backForce:"OPLS-AA/L",backForces:[],waterModel:"SPCE",waterModelForces:[],charge:0,chargeOptions:[],chargeType:null,chargeTypeOptions:[],chargeResult:[],switchValue:"fuzzy",atomtypeOriginData:[],atomtypeTableData:null,forceParams:null,mol2Charge:[],isCrystalMaterial:!1},mutations:{setOriginFileName(e,t){e.originFileName=t},setOriginFileContent(e,t){e.originFileContent=t},setActiveIndex(e,t){e.activeIndex=t},setFileList(e,t){e.fileList=t},setMol2(e,t){e.mol2=t},setOriginMol2(e,t){e.originMol2=t},setOriginMol(e,t){e.originMol=t},setMoleculeJson(e,t){e.moleculeJson=t},setAtoms(e,t){e.atoms=t},setForce(e,t){e.force=t},setForces(e,t){e.forces=t},setForceOptions(e,t){e.forceOptions=t},setBackForce(e,t){e.backForce=t},setBackForces(e,t){e.backForces=t},setWaterModel(e,t){e.waterModel=t},setWaterModelForces(e,t){e.waterModelForces=t},setCharge(e,t){e.charge=t},setChargeOptions(e,t){e.chargeOptions=t},setChargeType(e,t){e.chargeType=t},setChargeTypeOptions(e,t){e.chargeTypeOptions=t},setChargeResult(e,t){e.chargeResult=t},setSwitchValue(e,t){e.switchValue=t},setAtomTypeOriginData(e,t){e.atomtypeOriginData=t},setAtomTypeTableData(e,t){e.atomtypeTableData=t},setForceParams(e,t){e.forceParams=t},reset(e,t){Object.keys(t).forEach((a,l)=>{e[a]=t[a]})},setIsCrystalMaterial(e,t){e.isCrystalMaterial=t}},actions:{},modules:{}}),Oe=a("f23d"),a("202f"),b.default.config.productionTip=!1,b.default.component(v.a.name,v.a),b.default.component(h.a.name,h.a),b.default.component(p.a.name,p.a),b.default.use(u.a),b.default.use(m.a),b.default.use(d.a),b.default.use(c.a),b.default.use(n.a),b.default.use(r.a),b.default.use(i.a),b.default.use(o.a),b.default.use(s.a),b.default.use(l.a),b.default.use(t.a),b.default.use(Oe.a),new b.default({router:Re,store:ze,render:e=>e(g)}).$mount("#app")},"57da":function(e,t,a){e.exports=a.p+"img/nav-5.326be9be.png"},5874:function(e,t,a){},"58aa":function(e,t,a){},"5a10":function(e,t,a){},"5c14":function(e,t,a){},"601c":function(e,t,a){"use strict";a("b8b5")},6184:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAACnSURBVDiNY+QK/f+fgQLARIlmggZwsFJgADcHA8OWWgaGqlAyDODmYGDYWMXAoCTBwLDmGIkGIGv2aGRguPWUBANI1czAwMDACItGmGZLDQaGYzcYGO69wK1pwT4GhuM3cHiBVMCInJBQvNDAwHDrGWEDUFzw9QcDg38bxPk7GhgY1KRINIAcQ7CGAbIhodb4DWDEl5k4WBkYfvwmwwUwQEgzQQOIAQBabDememDjNgAAAABJRU5ErkJggg=="},"623b":function(e,t,a){e.exports=a.p+"img/nav-7.dd778a19.png"},"63fe":function(e,t,a){},"644b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAWgSURBVEiJdZVtUJRVFMf/5z7PLrusIggqiGIJviIIOiY6Jis6KkZ9cCZq1F6sbETCZkxH8yVxDC1TVExNJ82aIUubJsu3cdRxKN9QUSsQ30kCEVnZhV122ed57unDarq4ni/PzJ3///zOvefc5xKeEV/Vjx4Lps/KPAnpFd64swaMhdeHbjz7LP02Hm4y6s3vM5QFe5sHR9frnX5SdLlYDSXe3DgiFjpKGejFzGBGpiCl1H56/QS7b3pTKA/XzZgsyLNWMiySAQK/ZajCCAmg9rAsCNkzaI3F8wP1kUfMTG2hPO2ujB5hkccsTziIgNyQAKjcDEkcTGVNI/9JZjg6ygUAUrzDAPQAQI8R3PwUgJlpx+07qmFaKyEuCoAIgMFSHq4SFXN2ZGX6OnpKDt0wt7vGrjSFV4+F0iweQnxS0hoCAJ4yJdbTbB53q6Kr89LvK1UtJnI7FMdljVZUVruGzz2rtay6Sw3ra9I3OANFQOBacorR6khrc3qubRHXJkuoH5k7l2/uFFs24uT9voMqUFNgSXfsI544cSxUtbTNZep580KMdI0ayP8UTT9uJMRN1/XW/q0O45jbadiXjo8pBwDeAwWpqfMALJeeRqvhapJn6EM+xfNXh/vcq2wD44se3PNN8Pj0MYXjursFVPVzAL0AFgCrEaer1YS87ZV11Y393U1IbvMq4kajbUh2CWdkl3DG9503TQXREhBsYAgBXc3ARuRhwMGC7CS/lB3aCSA9uAkgV1J8AQmR52nxi1v3rGENTZYtIEgAuOIaKiTILPB4BoTUFatoGQSgPNQABF0eBoyoK3dWCz/ZrZ3NcxJ7G+09Y3yzNYFMTSBzQMTfrxOxMygLwQsdlzsmDwCEWADgJpMiQaJdAL/ZqmrXL5wcUx4Zo1ZZrVL2i/NXHsunc8fy6dyM8jm/EstlTNQMUhkgFwMrTCefAaD9+8tr+qdOOJE39+al+bm73d0ipqVjlzOUGACoEBK7/9paId5754DY6j/N82epTSimQshQegEAB2fNa6odNqKtLivdMbq22AcEpiVN3977OT4hMrgongsD2keQS+Ld+hrKlKfEolrKhQEAyM21JJ0vi44782d45sc7YoBAk58KZghcTZ2XJr9ZksINZqBxpxyDZVyIrc+qlO32SHg8uzK/+3LyjQvRJq9TPXrZNHN66F/FteQUAMsBaSM2wMxRrNDKE2MW1K0+uqQOANrc+mAA4o7DMnhSCcubfxTkJLpv5YClgsCsJkLQmtAAKGkgtgZVCBF5Twz7gaFJAGhvFcJsVcIaneYtApDVXQepie5bSnAeGikQIjRzRDVDNYKkLFtiufwNSXqWJD0rzKbOIUHt3bv4P2BDH9+v5fomBjjYg4oAoFugRgAouQFzKR946ZJ4GwxVAyABeBhclOko/nnpuNgzS8fFngkL50oAMj7KXZmRdv/6kdzZQ2r6JOsAGQRIgOsgsEjZxsNN5Dyc40TTqyeMGlOnMB7YVY2bew8pa4bw3sXkvX9Sat5VpjL8QvmBBq9vtkeqdPrNWr3Jfly50Npb65fHpqjUO31SZrxw/kCpo8FyyOuSi9P1bytpW92ofIZY26DbLD86kzkcXeQE68vr4inik4KkJP//2334Lf431xKOut0QlHOhLVYp8yRwnNZXH+N+ZepKe8IBouB3RJUQCwiwPOwkudEiqrSLI/rbphXtvO1F6wM/vC4NRQ8Nsstr0YjdkM3gRw2levW22BNdYnxK64IfKQAqAdEd1siMsEFg7goiEAFMj3fAhiUc1OH+EIgNGRVqYFQC72HQzCdOwXddryrw2SYdxn2g2QKg5bHBGnE0BsxHQUh84vjuqmb1eEgAzMpS8htgplwADmZ8YdId+/K7d9dCGQC4v7774jRNGl+AMJKILhqGsfBqcnFDKPF/eviHGDpVvbQAAAAASUVORK5CYII="},"64ba":function(e,t,a){"use strict";a("4e04")},6592:function(e,t,a){e.exports=a.p+"img/nav-1.c3b453ae.png"},"65af":function(e,t,a){"use strict";a("bac29")},6893:function(e,t,a){"use strict";a("7db9")},"69fe":function(e,t,a){"use strict";a("58aa")},"6a60":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAB4SURBVBiVlZGxDcJAEATniE3+JVAEgSmB+qADCqAAIzlxbjpwAyYeEixZDyeZDXdnVycdVFIb9a4e62xXGx/tgZt6SPKv9Yc6bS0UdVwXQm0Bk04BrsAMnELNwFrDspypAJdl+a+bM7BR+61g9wvMnvICzhHxXJtvw+llbaSapM0AAAAASUVORK5CYII="},"6a61":function(e,t,a){e.exports=a.p+"img/nav-11.55285e93.png"},7220:function(e,t,a){"use strict";a("5c14")},7500:function(e,t,a){"use strict";a("44a7")},"77a5":function(e,t,a){},"7db9":function(e,t,a){},"7e9d":function(e,t,a){"use strict";a("8951")},"7ee9":function(e,t,a){"use strict";a("246f")},"7f3c":function(e,t,a){e.exports=a.p+"img/nav-12.46484547.png"},"81a4":function(e,t,a){},"86bb":function(e,t,a){},"875b":function(e,t,a){"use strict";a("8d75")},8951:function(e,t,a){},"8d75":function(e,t,a){},"8fb2":function(e,t,a){"use strict";a("24df")},"90fe":function(module,exports,__webpack_require__){"use strict";function deepClone(e){return JSON.parse(JSON.stringify(e))}function cross(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function norm(e){return Math.sqrt(e.reduce((function(e,t){return e+t*t}),0))}function unit(e){var t=norm(e);return e.map((function(e){return e/t}))}function mod1(e){return e.map((function(e){return 0<=(e%=1)?e:e+1}))}__webpack_require__("13d5"),__webpack_require__("14d9"),module.exports.deepClone=deepClone,module.exports.cross=cross,module.exports.norm=norm,module.exports.unit=unit,module.exports.mod1=mod1;var _deg2rad=Math.PI/180;function degToRad(e){return e*_deg2rad}function radToDeg(e){return e/_deg2rad}function includesAll(e,t){for(var a=!0,l=0;l<t.length;++l)a=a&&e.includes(t[l]);return a}function shortestPeriodicLength(e){for(var t=norm(e),a=-1;a<2;++a)for(var l=-1;l<2;++l)for(var s,o=-1;o<2;++o)0==a&&0==l&&0==o||(s=[e[0]+a,e[1]+l,e[2]+o],t=Math.min(t,norm(s)));return t}function classify(e,t){let a=[],l=[];return e.forEach(e=>{a.includes(e[t])||(a.push(e[t]),l.push([]));var s=a.indexOf(e[t]);l[s].push(e)}),{kind:a,newArr:l}}function convertUnitcell(e=[[18,0,0],[-9,15.58845727,0],[6,3.46410162,9.79795897]]){var t=e[0],a=e[1];t={o:[0,0,0],x:t,y:a,z:e=e[2],xy:[t[0]+a[0],t[1]+a[1],t[2]+a[2]],xz:[t[0]+e[0],t[1]+e[1],t[2]+e[2]],yz:[a[0]+e[0],a[1]+e[1],a[2]+e[2]],xyz:[t[0]+a[0]+e[0],t[1]+a[1]+e[1],t[2]+a[2]+e[2]]};let l=[],s=[];function o(e,t,a,o){l.push(e[0],e[1],e[2]),l.push(t[0],t[1],t[2]),l.push(a[0],a[1],a[2]),l.push(o[0],o[1],o[2]);for(let e=0;e<4;e++)s.push(0,0,0)}o(t.o,t.x,t.xy,t.y),o(t.o,t.y,t.yz,t.z),o(t.o,t.z,t.xz,t.x),o(t.yz,t.y,t.xy,t.xyz),o(t.xyz,t.xz,t.z,t.yz),o(t.xy,t.x,t.xz,t.xyz);var i=[];for(let e=0;e<6;e++){var r=4*e;i.push(r,1+r,1+r,2+r,2+r,3+r,3+r,r)}return{unitCellParameters:t,positionData:l,normalData:s,indexData:i}}function chunk(e,t){var a=[];for(let l=0;l<e.length;l+=t)a.push(e.slice(l,l+t));return a}function download(e,t="",a){var l=(new Date).getTime(),s=document.createElement("a");t=t+"_"+l.toString()+a;s.download=t,s.href=e,document.body.appendChild(s),s.click(),s.remove()}function downloadFileByBlob(e,t=""){e=new Blob([e],{type:"text/cif;charset=UTF-8"}),download(e=window.URL.createObjectURL(e),t,".cif"),window.URL.revokeObjectURL(e)}function downloadFileByLink(e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","demo.cif"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function getUrlParams(e,t){return t=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),null!==(e=e.substr(1).match(t))?unescape(e[2]):null}function formatDate(e,t){var a,l={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),l)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?l[a]:("00"+l[a]).substr((""+l[a]).length)));return t}function resetURLParam(key,value){let oUrl=window.location.href.toString(),re=eval("/("+key+"=)([^&]*)/gi"),nUrl=oUrl.replace(re,key+"="+value);window.history.replaceState(null,null,nUrl)}module.exports.degToRad=degToRad,module.exports.radToDeg=radToDeg,module.exports.includesAll=includesAll,module.exports.shortestPeriodicLength=shortestPeriodicLength,module.exports.classify=classify,module.exports.convertUnitcell=convertUnitcell,module.exports.chunk=chunk,module.exports.downloadFileByBlob=downloadFileByBlob,module.exports.downloadFileByLink=downloadFileByLink,module.exports.getUrlParams=getUrlParams,module.exports.formatDate=formatDate,module.exports.resetURLParam=resetURLParam},"95d0":function(e,t,a){e.exports=a.p+"img/nav-3.5843741e.png"},9787:function(e,t,a){"use strict";a("f83c")},"97f2":function(e,t,a){e.exports=a.p+"img/nav-2.b7782831.png"},"97f7":function(e,t,a){},"99ec":function(e,t,a){"use strict";a("77a5")},"9db5":function(e,t,a){},"9df5":function(e,t,a){"use strict";a("d50d")},"9ff0":function(e,t,a){"use strict";a("c74b")},a104:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAACfSURBVDiNY+QK/f+fgQLARIlmogzgYKXAgOpQBoYttQwM3BxkGrD6GAODkgQDw8Yq3IbgNeDWUwYGj0b8hhAMA0KGMMKi0VKDgSHBCbdBShIMDFYaDAzHbzAw+LcxMHz9QaQL4DbhEicmIalJMzDsqGdguPcC1XaiXIBPM0EDCGkmaECoFX7NDAxEhAEHKwPDj9+45QmGAT7NRBlACAAABRE3phS0QxUAAAAASUVORK5CYII="},a2ed:function(e,t,a){e.exports=a.p+"img/nav-10.ab5f6b95.png"},a487:function(e,t,a){"use strict";a("81a4")},a5cb:function(e,t,a){e.exports=a.p+"img/nav-9.1fd712da.png"},aaec0:function(e,t,a){"use strict";a("97f7")},ae59:function(e,t,a){"use strict";a("63fe")},b0df:function(e,t,a){},b68d:function(e,t,a){},b8b5:function(e,t,a){},bac29:function(e,t,a){},bc7b:function(e,t,a){},beba:function(e,t,a){},c1a8:function(e,t,a){e.exports=a.p+"img/nav-4.745c2c90.png"},c730:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAABzSURBVDiNY2AYuYAr9P98rtD/8wmpYyGk4D8DgwIxFjIRo2hoGsSIzOEK/T///3/UMGFkZDBgYGBg+P+f4QKa+INvqxkTYXzUwP7PwIhqNC4roWpJAZyh//dzhv7fT0jd4AtsqhlEMGUz/md4SC3LhigAAOL7F05WQ85uAAAAAElFTkSuQmCC"},c744:function(e,t,a){"use strict";a("efff")},c74b:function(e,t,a){},c7d0:function(e,t,a){},cbef:function(e,t,a){"use strict";a("86bb")},cc99:function(e,t,a){"use strict";a("c7d0")},ceb5:function(e,t,a){},d042:function(e,t,a){},d40d:function(e,t,a){var l={"./nav-1.png":"6592","./nav-10.png":"a2ed","./nav-11.png":"6a61","./nav-12.png":"7f3c","./nav-2.png":"97f2","./nav-3.png":"95d0","./nav-4.png":"c1a8","./nav-5.png":"57da","./nav-6.png":"de7c","./nav-7.png":"623b","./nav-8.png":"14aa","./nav-9.png":"a5cb"};function s(e){return e=o(e),a(e)}function o(e){if(a.o(l,e))return l[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}s.keys=function(){return Object.keys(l)},s.resolve=o,(e.exports=s).id="d40d"},d432:function(e,t,a){"use strict";a("bc7b")},d50d:function(e,t,a){},d73c:function(e,t,a){"use strict";a("d042")},d7ae:function(e,t,a){},d955:function(e,t,a){"use strict";a("ea88")},d9f5:function(e,t,a){"use strict";a("547e")},de7c:function(e,t,a){e.exports=a.p+"img/nav-6.b5257226.png"},e053:function(e,t,a){},e4e7:function(e,t,a){"use strict";a("1ec0")},e6e1:function(e,t,a){"use strict";a("e053")},ea88:function(e,t,a){},efff:function(e,t,a){},f3a8:function(e,t,a){},f83c:function(e,t,a){},f8fe:function(e,t,a){"use strict";a("465a")},fecf:function(e,t,a){"use strict";a("d7ae")}},[[14,"runtime","npm.ant-design-vue~e95d028b","npm.ant-design-vue~5ea6e0dc","npm.ant-design-vue~ac50015d","npm.ant-design-vue~13aea4f0","npm.ant-design-vue~0e24d1a3","npm.ant-design-vue~64a379b4","npm.ant-design-vue~3f03297a","npm.ant-design-vue~1a7f21e9","npm.lodash~2930ad93","npm.moment~2ee72088","npm.core-js~987e6011","npm.babel-runtime~7da828cd","npm.element-ui~793f9119","npm.axios~49f23cfd","npm.browserify-sign~41d44f25","npm.browserify-aes~048adfc0","npm.elliptic~6216c3af","npm.hash-base~bd772472","npm.asn1.js~b51e15da","npm.readable-stream~2b6d3a99","npm.three~52589227","npm.three~70166b35","npm.hash.js~29746ebe","npm.public-encrypt~2f944d6a","npm.ant-design~3b38e777","npm.diffie-hellman~008b4089","npm.create-ecdh~a68c23f7","npm.miller-rabin~c8d9a093","npm.async-validator~544a4ec4","npm.bn.js~62ab5815","npm.buffer~7e5e8261","npm.dom-align~0cf8aeef","npm.resize-observer-polyfill~7370204d","npm.sortablejs~f811d8fd","npm.tinycolor2~c2f06f41","npm.vue-router~b1f96ece","npm.vue~d2305125","app~748942c6"]]]);